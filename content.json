{"meta":{"title":"Secret Garden","subtitle":"","description":"","author":"tsunamiGG","url":"https://tsunamiGG.github.io","root":"/"},"pages":[{"title":"æ‰€æœ‰åˆ†ç±»","date":"2020-05-17T13:00:41.486Z","updated":"2020-05-17T13:00:41.486Z","comments":true,"path":"categories/index.html","permalink":"https://tsunamigg.github.io/categories/index.html","excerpt":"","text":"javascript"},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2020-05-17T13:01:21.307Z","updated":"2020-05-17T13:01:21.307Z","comments":true,"path":"tags/index.html","permalink":"https://tsunamigg.github.io/tags/index.html","excerpt":"","text":""},{"title":"å…³äº","date":"2020-06-09T13:44:13.214Z","updated":"2020-06-09T13:44:13.213Z","comments":true,"path":"about/index.html","permalink":"https://tsunamigg.github.io/about/index.html","excerpt":"","text":"å ä¸ªä½å­"}],"posts":[{"title":"chromeè°ƒè¯•éªšæ“ä½œ","slug":"Chrome-debugging-ways","date":"2020-05-28T14:26:20.000Z","updated":"2020-05-28T14:29:19.762Z","comments":true,"path":"2020/05/28/Chrome-debugging-ways/","link":"","permalink":"https://tsunamigg.github.io/2020/05/28/Chrome-debugging-ways/","excerpt":"è§£é”chromeè°ƒè¯•é»‘ç§‘æŠ€","text":"è§£é”chromeè°ƒè¯•é»‘ç§‘æŠ€ chromeè°ƒè¯•éªšæ“ä½œ é€šç”¨ç¯‡(Windows) åˆ‡æ¢DevToolsçª—å£çš„å¸ƒå±€ï¼ˆä¸‹å³ï¼‰ Ctrl + Shift + D åˆ‡æ¢DevToolsé€‰é¡¹å¡ (Element-NetWork-Audits) Ctrl + [ æˆ– ]ï¼š å‘å·¦å’Œå‘å³ Ctrl + 1 åˆ° 9ï¼šDevTools&gt;Settings&gt;Preferences&gt;Appearanceä¸­æ‰“å¼€ (å¼€å¯ä¹‹åï¼Œæµè§ˆå™¨ç½‘é¡µé€‰é¡¹å¡ä¹Ÿå¯ä»¥åˆ‡æ¢) Stylesæ•°å€¼è°ƒæ•´ Alt +ä¸Šä¸‹ç®­å¤´ 0.1 ä¸Šä¸‹ç®­å¤´ 1 Shfit+ä¸Šä¸‹ç®­å¤´ 10 Ctrl +ä¸Šä¸‹ç®­å¤´ 100 elementsï¼Œlogsï¼Œ sources &amp; network çš†å¯ä½¿ç”¨ Ctrl+F Elementä¸­çš„HTMLå¯ä»¥ç›´æ¥Ctrl+Cä¿å­˜ copy(å…¨å±€å¯¹è±¡æˆ–è€…DOM or ä¸€äº›å¤ªé•¿çš„å¯¹è±¡)ï¼Œå¯ç›´æ¥å¤åˆ¶åˆ°ç¼–è¾‘å™¨ä¸­æŸ¥çœ‹ã€‚ 12345678&#x2F;&#x2F; consoleæ¿å—window ....blabllablacopy(window)Ctrl+V debugger è¶Šè¿‡ä¸‹ä¸€ä¸ªå‡½æ•°è°ƒç”¨ : F10ã€Ctrl + â€˜ ; è¿›å…¥ä¸‹ä¸€ä¸ªå‡½æ•°è°ƒç”¨ : F11ã€Ctrl + ; è·³å‡ºå½“å‰å‡½æ•° : Shift + F11ã€Ctrl + Shift + ; åˆ‡æ¢æ–­ç‚¹æ¡ä»¶: ç‚¹å‡»è¡Œå·ã€Ctrl + B; åªåˆ—ä¸¾å‡ºæ¥æˆ‘è®¤ä¸ºå¾ˆå¸¸ç”¨çš„ï¼Œè¯¦è§ï¼š https://developers.google.com/web/tools/chrome-devtools/shortcuts Commandç¯‡ æ‰“å¼€devtools, [Ctrl] + [Shift] + [P] (Macï¼š [âŒ˜] + [Shift]+ [P] ) ,ä¼šè¿›å…¥è¿™æ ·çš„ç•Œé¢ã€‚ æˆªå±æ–¹å¼ æ²¡é”™ï¼Œæœ‰å¥½å‡ ç§æˆªå±çš„æ–¹å¼ï¼Œä½†å¾®ä¿¡æˆªå›¾ä»–ä¸é¦™å—ï¼Ÿ ä¸ä¸ä¸ï¼Œç¬¬ä¸‰æ–¹å·¥å…·åªèƒ½æˆªæ»¡ä½ çš„å±å¹•å°ºå¯¸å¤§å°ï¼Œæ¯”å¦‚ï¼šwebé•¿åº¦å¤§äº1080ï¼Œè€Œä½ è¦çœ‹åˆ°æ‰€æœ‰çš„element? é€‰æ‹©ä¸Šå›¾ä¸­çš„ï¼š full size å³å¯ã€‚ é•¿å›¾ç¤ºä¾‹é¢„è­¦: åˆ‡æ¢ä¸»é¢˜ å½“ä½ åœ¨æ™šä¸Šå·¥ä½œï¼Œè®¨åŒç™½é—ªé—ªçš„devtools,Commondè¾“å…¥ï¼š themeã€‚ é‡Œé¢è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šåŠŸèƒ½~ æ¨¡å—å¦‚ä¸‹ï¼š Snippets ä½äºSourcesæ¨¡å—çš„ï¼Œå¾ˆå¸¸ç”¨çš„é™¤äº†pageæ¥çœ‹ä¸€äº›errå’Œæºç ã€‚è¿˜æœ‰ä¸€ä¸ªsnippetsä¹Ÿå¾ˆå®ç”¨ã€‚ 1.æ–°å»ºä»£ç å— 2.æ‰§è¡Œ(!+ä»£ç å—åºå·) è¿™æ ·å°±å¯ä»¥è¾“å‡ºå¯¹åº”ä»£ç å—çš„ç»“æœå•¦ã€‚ å¯ä»¥ç†è§£ä¸ºç»™ä½ å¼€äº†ä¸ªæ²™ç®±ï¼Œæ‰€ä»¥ä½ å¯ä»¥å¼•å…¥å…¶ä»–æ¥æºä»£ç å—æ¥æ‰§è¡Œã€‚ æµ‹è¯•è¯æ˜ï¼Œæ¸…cookie ï¼Œæ¸…ç¼“å­˜ï¼Œå…³é—­æµè§ˆå™¨éƒ½ä¸ä¼šå¯¼è‡´snippetsä¸¢å¤±ï¼Œè€Œä¸”æ˜¯è·¨åŸŸåå…¨å±€å¯ç”¨ï¼Œåº”è¯¥æ˜¯å¼ºå­˜å‚¨äºæµè§ˆå™¨ä¸Šçš„ ã€‚æœ‰ç‚¹ç¡¬~ Date: 2020/2/28 Consoleæ¨¡å—ç¯‡ $ç¬¦å· 1.è°ƒè¯•çš„è¿‡ç¨‹ä¸­ï¼Œä½ ç»å¸¸ä¼šé€šè¿‡æ‰“å°æŸ¥çœ‹ä¸€äº›å˜é‡çš„å€¼ï¼Œä½†å¦‚æœä½ æƒ³çœ‹ä¸€ä¸‹ä¸Šæ¬¡æ‰§è¡Œçš„ç»“æœå‘¢ï¼Ÿå†è¾“ä¸€éè¡¨è¾¾å¼å—ï¼Ÿ è¿™æ—¶å€™ $_ å°±æ´¾ä¸Šäº†ç”¨åœºï¼Œ$_ æ˜¯å¯¹ä¸Šæ¬¡æ‰§è¡Œçš„ç»“æœçš„ å¼•ç”¨ ï¼š $ å˜é‡åœ¨ console ä¸­å°±æ˜¯å¯¹è¿™ä¸€å¤§ä¸²å‡½æ•° document.querySelector çš„åˆ«åã€‚ $$å˜é‡æ‰§è¡Œ document.QuerySelectorAll å¹¶ä¸”å®ƒè¿”å›çš„æ˜¯ï¼šä¸€ä¸ªèŠ‚ç‚¹çš„ æ•°ç»„ ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª Node list ä¾‹å¦‚ï¼šArray.from(document.querySelectorAll(&#39;div&#39;)) === $$(&#39;div&#39;) ã€‚ æŸ¥æ‰¾Nodeå¯æ¯”å¯¹ç€Elementçœ‹å¼ºå¤ªå¤šå•¦ï¼ ç»“åˆèµ·æ¥å°±æœ‰ä¸€ä¸ªå¾ˆå¦™çš„cssè°ƒè¯•æ³•~ 12// Consoleè¾“å…¥ï¼$$('*').forEach(item=&gt;&#123;item.style.outline='1px solid red'&#125;) æ•ˆæœå¦‚ä¸‹ï¼š custom formatter è‡ªå®šä¹‰æ ¼å¼è½¬æ¢å™¨ æˆ‘ä»¬ä¹ æƒ¯ä½¿ç”¨ DevTools çš„ console é»˜è®¤å¯¹ object çš„è½¬æ¢(ä¾‹å¦‚ä¸Šå›¾)ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬æƒ³ç”¨ä¸ä¼—ä¸åŒçš„æ–¹å¼æ¥å¤„ç†ã€‚ é‚£æˆ‘ä»¬å°±å¯ä»¥è‡ªå®šä¹‰è¾“å‡ºå¯¹è±¡çš„å‡½æ•° custom formatter~ å…·ä½“çš„å®˜ç½‘ä»‹ç»åœ¨è¿™é‡Œï¼š https://docs.google.com/document/d/1FTascZXT9cxfetuPRT2eXPQKXui4nWFivUnS_335T3U/preview å¼€å¯æ–¹æ³•ï¼šæ‰“å¼€devtools,æŒ‰ä¸‹F1ã€‚å‹¾é€‰å¦‚ä¸‹~ formatterï¼š å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸‰ä¸ªæ–¹æ³•ï¼š header : å¤„ç†å¦‚ä½•å±•ç¤ºåœ¨ console çš„æ—¥å¿—ä¸­çš„ä¸»è¦éƒ¨åˆ†ã€‚ hasbody : å¦‚æœä½ æƒ³æ˜¾ç¤ºä¸€ä¸ªç”¨æ¥å±•å¼€å¯¹è±¡çš„ â–¶ ç®­å¤´ï¼Œè¿”å› true body : å®šä¹‰å°†ä¼šè¢«æ˜¾ç¤ºåœ¨å±•å¼€éƒ¨åˆ†çš„å†…å®¹ä¸­ã€‚ 12345678window.devtoolsFormatters = [&#123; header: function(obj)&#123; return [\"div\", &#123;&#125;, obj.toString()] &#125;, hasBody: function()&#123; return false; &#125;&#125;] å…¶ä¸­header æ–¹æ³•è¿”å›äº†ä¸€ä¸ª JsonML (æ³¨ï¼š JsonML : JSON Markup Language - JSON æ ‡è®°è¯­è¨€) æ•°ç»„ï¼Œç”±è¿™äº›ç»„æˆï¼š æ ‡ç­¾å å±æ€§å¯¹è±¡ å†…å®¹ (æ–‡æœ¬å€¼æˆ–è€…å…¶ä»–å…ƒç´ ) è®©æˆ‘ä»¬çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š amazing ç°æœ‰å¥½å‡ ç§ custom formatter å¯ä¾›é€‰æ‹©ï¼Œä¾‹å¦‚ï¼šä½ å¯ä»¥åœ¨è¿™ä¸ª immutable-devtools ä»“åº“ä¸­æ‰¾åˆ°å¯¹äº Immutable.js ç»“æ„çš„å®Œç¾å±•ç¤ºã€‚ä½†ä½ åŒæ ·å¯ä»¥è‡ªå·±é€ ä¸€ä¸ªã€‚ å¦‚æœä½ é‡åˆ°ç»“æ„ä¸å¯»å¸¸çš„å¯¹è±¡æ—¶ï¼Œæˆ–å¤§é‡çš„æ—¥å¿—(æœ€å¥½é¿å…è¿™æ ·çš„æƒ…å†µï¼Œä½†æ˜¯æœ‰æ—¶å€™å¾ˆæœ‰ç”¨)è€Œä½ æƒ³ä»ä¸­åšåŒºåˆ†æ—¶ï¼Œä½ å¯ä»¥é‡‡ç”¨ custom formatter æ¥å¤„ç†ã€‚ ä¸€ä¸ªå¾ˆå®ç”¨çš„çªé—¨ï¼šç›´æ¥å°†ä½ ä¸å…³å¿ƒï¼Œä¸éœ€è¦åŒºåˆ«å¯¹å¾…çš„å¯¹è±¡è¿‡æ»¤å‡ºæ¥ï¼Œç›´æ¥åœ¨ header æ–¹æ³•é‡Œé¢ return nullã€‚è®© DevTools ä½¿ç”¨é»˜è®¤çš„æ ¼å¼åŒ–æ–¹å¼æ¥å¤„ç†è¿™äº›å€¼ã€‚ è®©æˆ‘ä»¬æ¥æ‰¾ç‚¹ä¹å­ï¼Œè®©å¼€è®©å¼€ï¼Œæˆ‘è¦è£…é€¼å•¦ï¼ 12345678910111213141516171819202122232425262728293031window.devtoolsFormatters = [&#123; header: function(obj)&#123; if (!obj.__clown) &#123; return null; &#125; delete obj.__clown; const style = ` color: red; border: dotted 2px gray; border-radius: 4px; padding: 5px; `; const content = `ğŸ¤¡ $&#123;JSON.stringify(obj, null, 2)&#125;`; try &#123; return ['div', &#123;style&#125;, content] &#125; catch (err) &#123; // for circular structures return null; // use the default formatter &#125; &#125;, hasBody: function()&#123; return false; &#125;&#125;]console.clown = function (obj) &#123; console.log(&#123;...obj, __clown: true&#125;);&#125;console.log(&#123;message: 'hello!'&#125;); // normal logconsole.clown(&#123;message: 'hello!'&#125;); // a silly log å¯ä»¥åœ¨massageé‡Œé¢åŠ å…¥ä¸€ä¸ªemojiè¡¨æƒ…ã€‚å½“ç„¶ï¼Œ**ä»–çš„å®é™…ä½œç”¨æ˜¯tagï¼Œå¯ä»¥é€šè¿‡ä¸åŒçš„tagæ¥è¡¨ç¤ºä¸åŒçš„é¡¹ç›®ï¼Œä¾¿äºåŒºåˆ†~","categories":[],"tags":[{"name":"browser","slug":"browser","permalink":"https://tsunamigg.github.io/tags/browser/"}]},{"title":"èµ°å¥½ä¸‹ä¸€æ­¥","slug":"reload","date":"2020-05-23T14:48:07.000Z","updated":"2020-05-23T14:52:29.238Z","comments":true,"path":"2020/05/23/reload/","link":"","permalink":"https://tsunamigg.github.io/2020/05/23/reload/","excerpt":"æŠ›ä¸‹è¿‡å»ï¼Œèµ°å‘æœªæ¥ï¼Œæˆå°±è‡ªå·±","text":"æŠ›ä¸‹è¿‡å»ï¼Œèµ°å‘æœªæ¥ï¼Œæˆå°±è‡ªå·± å‰è¨€å¤§ä¸‰ä¸‹å­¦æœŸï¼Œè§‰å¾—è‡ªå·±ä¸èƒ½å°±æ­¤æ²‰æ²¦ã€‚æƒ³ç€è‡ªå·±å¥½æ­¹ç®—ä¸ªè®¡ç®—æœºæ²¾è¾¹çš„ä¸“ä¸šï¼Œå»æ‰¾ä¸€ä»½ç¼–ç¨‹ç›¸å…³çš„å·¥ä½œï¼Œåº”è¯¥è¿˜æ˜¯æœ‰æå¤´çš„ã€‚ åœ¨å›¾ä¹¦é¦†çœ‹åˆ°ä¸€æœ¬ã€Šwebå·¥ç¨‹å¸ˆçš„è‡ªæˆ‘ä¿®å…»ã€‹ï¼Œå¿ƒé‡Œæ³¢æ¾œèµ·ä¼ã€‚äºæ˜¯ï¼Œå°±åœ¨å‰ç«¯çš„è·¯ä¸Šä¸€å»ä¸å¤è¿”~ æŠ˜æˆŸå®ä¹ å»äº†ä¸€å®¶é«˜æ­ŒçŒ›è¿›ï¼Œç–¯ç‹‚å¢é•¿çš„ç°å·²ä¸Šå¸‚çš„åœ¨çº¿æ•™è‚²å…¬å¸ï¼Œå½“æˆ‘æ»¡æ€€æ†§æ†¬ï¼Œå‡†å¤‡å¤§å¹²ä¸€åœºï¼Œç°å®å´ç»™æˆ‘æ¥äº†ä¸€è®°ç‹ ç‹ çš„patchã€‚ å¯¹äºæ²¡æœ‰ä»»ä½•é¡¹ç›®ç»éªŒï¼Œåªå­¦äº†ä¿©ä¸ªæœˆåŸºç¡€çš„æˆ‘æ¥è¯´ï¼›æ¯å¤©é†é†çŒé¡¶ï¼Œå¾ˆå¤šäº‹æƒ…å¹¶æ²¡æœ‰åšåˆ°è‡ªå·±èƒ½åšåˆ°çš„æœ€å¥½ï¼Œæ›´å¤šçš„å¤±è¯¯ï¼Œè„‘å­çŠ¯æµ‘ï¼Œç»™å†³å®šæˆ‘å®ä¹ æ˜¯å¦é€šè¿‡çš„å¸ˆå‚…ç•™ä¸‹äº†èƒ½åŠ›ä¸è¶³çš„å°è±¡ã€‚ ä»æœªæƒ³è¿‡ä¼šæœ‰è¿™æ ·çš„ç»“æœï¼Œæ¯å¤©ç¡ä¸ç€ï¼Œå¾ˆå¤šå°±æ¥åˆ°å·¥ä½å­¦ä¹ çŸ¥é“æ™šä¸Š9ç‚¹ï¼Œä¸å¤§å®¶ä¸€èµ·å¼€æ—©ä¼šï¼Œå®Œæˆå‡ ä¸ªç®€å•çš„ä»»åŠ¡ï¼Œä¸€èµ·æä¹æ±¤å›¢å»ºï¼Œå‚åŠ å¹´ä¼šâ€¦. å¯¹æˆ‘çš„æ‰“å‡»æ˜¯å·¨å¤§çš„ï¼Œå¬ç€HRBPå®‰æ…°çš„è¯­éŸ³ï¼Œæ€ç»ªç¿»æ¶Œã€‚æˆ‘ç”šè‡³å¼€å§‹æ€€ç–‘è‡ªå·±çœŸæ­£æ˜¯å¦èƒ½å¤Ÿèƒœä»»è¿™ä»½å·¥ä½œï¼Œæˆ‘æ˜¯ä¸æ˜¯åº”è¯¥å¬çˆ¸å¦ˆçš„è¯ï¼Œå›å»å°å¿åŸå»è€ƒå…¬åŠ¡å‘˜â€¦.å„ç§æ€€ç–‘ï¼Œä¸è‡ªä¿¡çš„è´Ÿé¢æƒ…ç»ªå°±åƒæ½®æ±ä¸€èˆ¬ï¼Œæƒ³è¦æ¨å¾—è¶Šè¿œï¼Œå´å¼¹å›æ¥è¶Šè¿œã€‚æˆ‘çŸ¥é“ï¼Œæˆ‘å¤±å»äº†è¿™è¾ˆå­æœ€é‡è¦çš„ç¬¬äºŒæ¬¡æœºä¼šã€‚ é‡å¯ï¼Ÿæ”¹å˜ï¼Ÿåœ¨é¢“åºŸ2ä¸ªæœˆåï¼Œæˆ¿ç§Ÿï¼Œç”µè´¹ï¼Œç‡ƒæ°”è´¹ï¼Œä¸€æ¡æ¡çŸ­ä¿¡æé†’ç€æˆ‘ï¼Œä¸èƒ½å†è¿™æ ·ä¸‹å»äº†ã€‚ äºæ˜¯é™ä½è‡ªå·±çš„è¦æ±‚ï¼Œåœ¨æ­¦æ±‰è¿™æ ·ä¸€ä¸ªå¤§ç¯å¢ƒéƒ½æ˜¯å¤–åŒ…çš„æ¡ä»¶ä¸‹ï¼ŒåŒ†åŒ†å°±ç­¾äº†ä¸€ä¸ª40äººï¼Œåªæœ‰1ä¸ªå‰ç«¯çš„ç§‘æŠ€å…¬å¸â€¦. å—¯ï¼Œæ˜¯çš„ï¼Œå¯¹äºç°çŠ¶éå¸¸ä¸æ»¡æ„ã€‚æ¯å¤©å†™ç€ä¸å¤ªæ„Ÿå…´è¶£çš„ä¸šåŠ¡ï¼Œæ”¹ç€ç¨€çƒ‚çš„ä»£ç ã€‚ å¦‚æœéè¦è¯´è¿›æ­¥ï¼Œé‚£å¤§æ¦‚æ˜¯ç£¨å¹³äº†æ£±è§’ï¼Œåˆ·æ–°äº†å¯¹å®¢æˆ·çš„è®¤çŸ¥ï¼Œç†Ÿæ‚‰äº†å¾®ä¿¡è¿™æ ·ç¨€çƒ‚çš„å¼€å‘ç¯å¢ƒâ€¦ æˆ‘ä»ç„¶æ²¡æœ‰æ”¾å¼ƒï¼ŒåŠªåŠ›åœ¨å·¥ä½œç©ºä½™æ—¶é—´ï¼Œå»çœ‹ç‚¹ä¸œè¥¿ï¼Œä½†å°±åƒä¸€åªæ— å¤´è‹è‡ä¸€èˆ¬ï¼Œä¹±æ’ã€‚ ç€å­¦ä¹ çš„äº‹æƒ…ä¸èƒ½ä¸€è¹´è€Œå°±ï¼Œå¾—æŒä¹‹ä»¥æ’ï¼Œç³»ç»Ÿçš„å­¦ã€‚å°±ä»çº¢å®ä¹¦å¼€å§‹ï¼Œé‡å­¦åŸºç¡€ï¼Œç„¶åå°±å»è‚¯Vueæºç ã€‚ç°åœ¨å¯¹Vue2.xçš„åŒå‘ç»‘å®šï¼Œè™šæ‹ŸDOMï¼Œæ¨¡æ¿ç¼–è¯‘éƒ½æœ‰ä¸€å®šç†è§£ï¼Œæºç ä¸­æ²¡æœ‰ç§˜å¯†ã€‚ å¦‚æœè¿·èŒ«äº†å°±å¼€å§‹åˆ¶å®šè®¡åˆ’å§è¿·èŒ«æ¥è‡ªäºä¸‹æ—¶ä»£5Gçš„æµªæ½®ï¼Œæ¯æ¬¡é€šä¿¡é©å‘½éƒ½è®©äººä»¬çš„ç”Ÿæ´»å‘ç”Ÿç¿»å¤©è¦†åœ°çš„å˜åŒ–..è¿™æ¬¡ä¹Ÿæ¯«ä¸ä¾‹å¤–ã€‚æ˜¯ç»§ç»­åœ¨æœ¬å°±è¿‡é¥±å’Œçš„äº’è”ç½‘ç»§ç»­æŒ£æ‰è¿˜æ˜¯å»æŠŠæ¡ä½æ–°çš„é£å£æœºä¼šï¼Ÿä½†ç›¸ä¿¡è‡ªå·±çš„æ¡ä»¶ï¼Œå¹¶æ²¡æœ‰æœºä¼šå»æŠ“ä½æ–°é£å£ï¼Œåªèƒ½ç»§ç»­å‰è¿›ï¼Œä½†ç´§è·Ÿå˜åŒ–å‘å±•ï¼Œå‘æŒ¥è‡ªå·±çš„æ´å¯ŸåŠ›ï¼Œæ‰¾åˆ°åˆé€‚çš„æœºä¼šï¼ åˆšæ¯•ä¸šå¿«ä¸€å¹´ï¼Œæƒ³ç€ç»™è‡ªå·±å®šä¸€ä¸ªç›®æ ‡ã€‚ æ¯•ä¸š3å¹´å†…ï¼Œåœ¨æ­¦æ±‰å·¥èµ„è¿‡ä¸‡æˆ–è€…è¿›å…¥ä¸€å®¶å¿ƒé‡Œæ»¡æ„çš„å…¬å¸ã€‚å¯¹å‰ç«¯çš„æŠ€èƒ½å¾ˆç†Ÿç»ƒï¼Œå¯ä»¥ç‹¬è‡ªè§£å†³ä¸šåŠ¡éš¾ç‚¹ï¼Œå…»æˆè‰¯å¥½ç¼–ç ä¹ æƒ¯ã€‚ç†Ÿç»ƒVueä¸reactï¼Œå•ƒå®ŒVue2.x,3.xæºç ï¼›æ·±å…¥ä½¿ç”¨canvasæˆ–è€…è¿›å‡»æ•°æ®å¯è§†åŒ–ç­‰ç­‰æœ‰æ·±åº¦çš„é¢†åŸŸã€‚ èƒ½å¤Ÿå†™pyæˆ–è€…å…¶ä»–åç«¯è¯­è¨€ï¼Œå»æ¡èµ·SQLï¼Œç¢°ç¢°æœåŠ¡ç«¯çš„æ•°æ®åº“ï¼ŒæœåŠ¡å™¨ç­‰ç­‰ã€‚ ä»Šå¹´ï¼Œä¸€å®šè¦è·³æ§½ï¼ å†²é¸­ï¼","categories":[],"tags":[{"name":"diary","slug":"diary","permalink":"https://tsunamigg.github.io/tags/diary/"}]},{"title":"Vue-source-learn1","slug":"Vue-source-learn1","date":"2020-05-22T02:37:35.963Z","updated":"2020-06-02T14:36:37.729Z","comments":true,"path":"2020/05/22/Vue-source-learn1/","link":"","permalink":"https://tsunamigg.github.io/2020/05/22/Vue-source-learn1/","excerpt":"title: vueæºç å­¦ä¹ ï¼ˆå¼€ç¯‡ï¼‰date: 2020-04-10 10:37:35tags: notes åº”è¯¥å¦‚ä½•å­¦ä¹ æºç ï¼Ÿ æˆ‘è§‰å¾—æœ€å¼€å§‹æœ‰ä¸ªå…¨å±€è§‚ï¼Œç„¶ååˆ‡å…¥ç»†èŠ‚çš„æ¨¡å—ï¼Œå¸¦ç€é—®é¢˜å»è¯»ã€‚","text":"title: vueæºç å­¦ä¹ ï¼ˆå¼€ç¯‡ï¼‰date: 2020-04-10 10:37:35tags: notes åº”è¯¥å¦‚ä½•å­¦ä¹ æºç ï¼Ÿ æˆ‘è§‰å¾—æœ€å¼€å§‹æœ‰ä¸ªå…¨å±€è§‚ï¼Œç„¶ååˆ‡å…¥ç»†èŠ‚çš„æ¨¡å—ï¼Œå¸¦ç€é—®é¢˜å»è¯»ã€‚ vueæºç å­¦ä¹ ç¬”è®° æœ¬ç¯‡ç»“åˆäº†é˜…è¯» https://nlrx-wjc.github.io/Learn-Vue-Source-Code/ çš„ç¬”è®°ï¼Œæ„Ÿè°¢wjc199366(wx)å¼€æºã€‚ ç°åœ¨åº”è¯¥çœ‹ä¸äº†äº†ï¼Œå› ä¸ºå‘ç”Ÿäº†ä¸€äº›äº‹æƒ…ï¼Œå¤§æ¦‚æ˜¯äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾ä»¥å½±å“æ——ä¸‹ã€Šæ·±å…¥æµ…å‡ºVue.jsã€‹é”€é‡ä¸ºç”±ï¼Œè”ç³»å¾®è½¯ï¼Œå°†ç”µå­ä¹¦çš„ä»“åº“ç»™å…³äº†â€¦.. ä¸è¿‡å¥½åœ¨å…³é—­ä¹‹å‰ï¼Œç•™äº†ä¸€ä»½åœ¨æœ¬åœ°ï¼Œéœ€è¦çš„åŠ æˆ‘å¾®ä¿¡å–ï¼štangtang1996918 é˜…è¯»æºç ä¹‹å‰ï¼Œå»ºè®®å»çœ‹çœ‹HcySunYangå¤§ä½¬å¯¹vue2/3ä¸­ä¸€äº›é‡è¦æ¦‚å¿µçš„è§£è¯»ï¼š http://hcysun.me/vue-design/zh/essence-of-comp.html ä¾‹å¦‚ï¼šç»„ä»¶ä¼ å‡ºçš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼ŸVnodeæ˜¯å¦‚ä½•è®¾è®¡çš„ï¼ŸVnodeæ˜¯å¦‚ä½•æŒ‚è½½ä¸ºçœŸå®DOMçš„ï¼Ÿ å¯¹é˜…è¯»æºç ï¼Œç†æ¸…æ€è·¯æ˜¯éå¸¸æœ‰å¸®åŠ©çš„~ æºç ä¹‹ä¸­æ²¡æœ‰ç§˜å¯†~ 1.è·¯çº¿ å˜åŒ–ä¾¦æµ‹ç¯‡ å­¦ä¹ Vueä¸­å¦‚ä½•å®ç°æ•°æ®çš„å“åº”å¼ç³»ç»Ÿï¼Œä»è€Œè¾¾åˆ°æ•°æ®é©±åŠ¨è§†å›¾ã€‚ è™šæ‹ŸDOMç¯‡ å­¦ä¹ ä»€ä¹ˆæ˜¯è™šæ‹ŸDOMï¼Œä»¥åŠVueä¸­çš„DOM-DiffåŸç† æ¨¡æ¿ç¼–è¯‘ç¯‡ å­¦ä¹ Vueå†…éƒ¨æ˜¯æ€ä¹ˆæŠŠtemplateæ¨¡æ¿ç¼–è¯‘æˆè™šæ‹ŸDOM,ä»è€Œæ¸²æŸ“å‡ºçœŸå®DOM ç”Ÿå‘½å‘¨æœŸç¯‡ å­¦ä¹ Vueä¸­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå®ç°åŸç† å®ä¾‹æ–¹æ³•ç¯‡ å­¦ä¹ Vueä¸­æ‰€æœ‰å®ä¾‹æ–¹æ³•(å³æ‰€æœ‰ä»¥$å¼€å¤´çš„æ–¹æ³•)çš„å®ç°åŸç† å…¨å±€APIç¯‡ å­¦ä¹ Vueä¸­æ‰€æœ‰å…¨å±€APIçš„å®ç°åŸç† æŒ‡ä»¤ç¯‡ å­¦ä¹ Vueä¸­æ‰€æœ‰æŒ‡ä»¤çš„å®ç°åŸç† è¿‡æ»¤å™¨ç¯‡ å­¦ä¹ Vueä¸­æ‰€æœ‰è¿‡æ»¤å™¨çš„å®ç°åŸç† å†…ç½®ç»„ä»¶ç¯‡ å­¦ä¹ Vueä¸­å†…ç½®ç»„ä»¶çš„å®ç°åŸç† 2.æ–¹æ³•é¢å¯¹ç¹å¤çš„æºç ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå»è¯»ï¼Ÿ è¯´ä¸‹é€‚åˆæˆ‘è‡ªå·±çš„è¯»æºç æ–¹æ³•ï¼ŒæŠ›ç –å¼•ç‰ã€‚ ä¸€æœ¬æ­£ç»çš„ä¸€è¡Œè¡Œçš„çœ‹æºç ï¼Œæˆ‘åªèƒ½è¯´å…„å¼Ÿï¼Œä½ ä»–å¨˜çš„çœŸæ˜¯ä¸ªå¤©æ‰ 1.ä¸€èˆ¬æˆ‘å…ˆæ‰«ä¸€çœ¼importå¼•å…¥çš„éƒ½æ˜¯é‚£äº›æ¨¡å—çš„jsæ–‡ä»¶ï¼Œä¸€èˆ¬æºç çš„ç›®å½•ç»“æ„éƒ½æ¸…æ™°ã€‚æ ¹æ®å¼•å…¥çš„jsæ–‡ä»¶å¤§æ¦‚éƒ½çœ‹å‡ºè¯¥jsæ–‡ä»¶çš„ä¾èµ–æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¾èµ–é¡¹çš„å¤šå°‘æ¥åˆ¤æ–­å¤æ‚ç¨‹åº¦ï¼Œæœ‰ä¸ªå¿ƒç†é¢„æœŸã€‚ 2.ç„¶åå»çœ‹jsæ–‡ä»¶ä¸»å‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºï¼Œå³ä¼ å‚å’Œè¿”å›éƒ½æ˜¯ä»€ä¹ˆï¼Œå…ˆææ¸…æ¥šå…¶ä¸»è¦åŠŸèƒ½ã€‚ å¯¹ã€‚ä¸æ˜¯ä¸€ä¸Šæ¥å°±ä¸€è¡Œè¡Œçš„çœ‹é€»è¾‘ä»£ç ï¼Œé™¤éä½ æœ‰è¶…å¼ºçš„ç†è§£èƒ½åŠ›ï¼Œä¸€èˆ¬æ˜¯å¾ˆåƒåŠ›çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å…ˆå‡è£…è‡ªå·±æ˜¯ä¸ªdebugå·¥å…·ï¼Œå…ˆè®¾ç½®è·³è¿‡å…¨éƒ¨å‡½æ•°å†…éƒ¨ç»†èŠ‚ï¼Œåªè§‚å¯Ÿä¸»å‡½æ•°å’Œå„ä¸ªå†…éƒ¨å­å‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºã€‚(è¿™æœŸé—´è‚¯å®šå°‘ä¸äº†å»æŸ¥çœ‹ä¸Šä¸€éƒ¨å¼•å…¥çš„å‡½æ•°åŠŸèƒ½)ã€‚å¦‚æœç»“åˆæ³¨é‡Šçœ‹äº†å¾ˆå¤šè¾“å…¥è¾“å‡ºè¿˜æ˜¯ä¸æ˜ç™½å…¶ä½œç”¨ï¼Œé‚£ä¹Ÿå¾ˆæ­£å¸¸ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¤åˆ¶ä¸€ä¸‹ä»£ç ç‰‡æ®µï¼Œåšä¸€äº›æµ‹è¯•æ¥è¯å®éƒ¨åˆ†æˆ‘ä»¬å¯¹æŸäº›å‡½æ•°åŠŸèƒ½çš„çŒœæƒ³ã€‚æœ‰äº†è¿™äº›ï¼Œæˆ‘ä»¬è„‘ä¸­å¤§å¤šéƒ½èƒ½æœ‰ä¸ªæ¡†æ¶ã€‚ å…¶å®è¿™è·Ÿè¯æ˜æ•°å­¦é¢˜çš„æ€è·¯ååˆ†ç±»ä¼¼ï¼Œå…ˆæå‡ºå‡è®¾ï¼Œç„¶åç”¨å„ç§å…¬ç†ï¼Œå®šç†æ¥æ…¢æ…¢æ¨å¯¼è¯æ˜ã€‚ 3.æ·±å…¥æ¯ä¸ªå‡½æ•°å†…éƒ¨çš„ç»†èŠ‚ã€‚è¿™ä¸ªå°±å…«ä»™è¿‡æµ·å„æ˜¾ç¥é€šäº†ã€‚ä¸è¿‡æˆ‘è§‰å¾—è¿˜å¯ä»¥å…ˆåšå‡æ³•ï¼Œå³æ ¹æ®æ³¨é‡Šè§£å†³å…¼å®¹æ€§å’Œä¸€äº›åˆ¤æ–­ç¯å¢ƒçš„hackå…ˆç»™å±è”½æ‰ï¼Œå…³æ³¨æ¯ä¸ªå‡½æ•°ä¸»è¦çš„é€»è¾‘ï¼Œç­‰æŠŠæ•´ä¸ªæ¨¡å—çš„è„‰ç»œå¼„æ¸…æ¥šåï¼Œæœ‰ç©ºå†å»çœ‹çœ‹å“ªäº›hackã€‚ç»†èŠ‚ä¸æ¸…æ¥šçš„åŒæ ·æµ‹è¯•ï¼Œç”¨ç»“æœå»é€†æ¨è¿‡ç¨‹ã€‚ 4.åšç¬”è®°ï¼Œè‡ªå·±å†™ä¸€éæ¢³ç†æ¸…æ¥šï¼ŒæŠŠä½ è§‰å¾—ä¸€äº›å¾ˆç²¾å¦™çš„æ€è·¯ï¼Œæœ‰è¶£çš„ç±»æ¯”è”æƒ³ï¼Œæ–¹æ³•æ€»ç»“ï¼Œéƒ½å¯ä»¥è®°å½•ä¸‹æ¥ å¤æ‚çš„ä¸œè¥¿éƒ½æ˜¯ç”±ç®€å•çš„ä¸œè¥¿æ„æˆï¼Œäººä»¬æ“…é•¿å°†ä¸œè¥¿å˜å¤æ‚ï¼Œå´ä¸æ“…é•¿å°†ä¸œè¥¿å˜ç®€å•ã€‚ 3.ç›®å½•ç»“æ„å¼ºçƒˆå»ºè®®æµè§ˆä¸€éï¼Œæºç ä¸­å¾ˆå¤šéƒ½æ˜¯å¤ç”¨çš„ï¼Œçºµè§‚å…¨å±€ï¼Œå†æŸäº›åˆ¤æ–­ä¸Šæ˜¯èƒ½å¤Ÿå¸®ä¸Šå¿™çš„~ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120srcâ”œâ”€ compilerâ”‚ â”œâ”€ codeframe.jsâ”‚ â”œâ”€ codegenâ”‚ â”‚ â”œâ”€ events.jsâ”‚ â”‚ â””â”€ index.jsâ”‚ â”œâ”€ create-compiler.jsâ”‚ â”œâ”€ directivesâ”‚ â”‚ â”œâ”€ bind.jsâ”‚ â”‚ â”œâ”€ index.jsâ”‚ â”‚ â”œâ”€ model.jsâ”‚ â”‚ â””â”€ on.jsâ”‚ â”œâ”€ error-detector.jsâ”‚ â”œâ”€ helpers.jsâ”‚ â”œâ”€ index.jsâ”‚ â”œâ”€ optimizer.jsâ”‚ â”œâ”€ parserâ”‚ â”‚ â”œâ”€ entity-decoder.jsâ”‚ â”‚ â”œâ”€ filter-parser.jsâ”‚ â”‚ â”œâ”€ html-parser.jsâ”‚ â”‚ â”œâ”€ index.jsâ”‚ â”‚ â””â”€ text-parser.jsâ”‚ â””â”€ to-function.jsâ”œâ”€ coreâ”‚ â”œâ”€ componentsâ”‚ â”‚ â”œâ”€ index.jsâ”‚ â”‚ â””â”€ keep-alive.jsâ”‚ â”œâ”€ config.jsâ”‚ â”œâ”€ global-apiâ”‚ â”‚ â”œâ”€ assets.jsâ”‚ â”‚ â”œâ”€ extend.jsâ”‚ â”‚ â”œâ”€ index.jsâ”‚ â”‚ â”œâ”€ mixin.jsâ”‚ â”‚ â””â”€ use.jsâ”‚ â”œâ”€ index.jsâ”‚ â”œâ”€ instanceâ”‚ â”‚ â”œâ”€ events.jsâ”‚ â”‚ â”œâ”€ index.jsâ”‚ â”‚ â”œâ”€ init.jsâ”‚ â”‚ â”œâ”€ inject.jsâ”‚ â”‚ â”œâ”€ lifecycle.jsâ”‚ â”‚ â”œâ”€ proxy.jsâ”‚ â”‚ â”œâ”€ render-helpersâ”‚ â”‚ â”œâ”€ render.jsâ”‚ â”‚ â””â”€ state.jsâ”‚ â”œâ”€ observerâ”‚ â”‚ â”œâ”€ array.jsâ”‚ â”‚ â”œâ”€ dep.jsâ”‚ â”‚ â”œâ”€ index.jsâ”‚ â”‚ â”œâ”€ scheduler.jsâ”‚ â”‚ â”œâ”€ traverse.jsâ”‚ â”‚ â””â”€ watcher.jsâ”‚ â”œâ”€ utilâ”‚ â”‚ â”œâ”€ debug.jsâ”‚ â”‚ â”œâ”€ env.jsâ”‚ â”‚ â”œâ”€ error.jsâ”‚ â”‚ â”œâ”€ index.jsâ”‚ â”‚ â”œâ”€ lang.jsâ”‚ â”‚ â”œâ”€ next-tick.jsâ”‚ â”‚ â”œâ”€ options.jsâ”‚ â”‚ â”œâ”€ perf.jsâ”‚ â”‚ â””â”€ props.jsâ”‚ â””â”€ vdomâ”‚ â”œâ”€ create-component.jsâ”‚ â”œâ”€ create-element.jsâ”‚ â”œâ”€ create-functional-component.jsâ”‚ â”œâ”€ helpersâ”‚ â”œâ”€ modulesâ”‚ â”œâ”€ patch.jsâ”‚ â””â”€ vnode.jsâ”œâ”€ platformsâ”‚ â”œâ”€ webâ”‚ â”‚ â”œâ”€ compilerâ”‚ â”‚ â”œâ”€ entry-compiler.jsâ”‚ â”‚ â”œâ”€ entry-runtime-with-compiler.jsâ”‚ â”‚ â”œâ”€ entry-runtime.jsâ”‚ â”‚ â”œâ”€ entry-server-basic-renderer.jsâ”‚ â”‚ â”œâ”€ entry-server-renderer.jsâ”‚ â”‚ â”œâ”€ runtimeâ”‚ â”‚ â”œâ”€ serverâ”‚ â”‚ â””â”€ utilâ”‚ â””â”€ weexâ”‚ â”œâ”€ compilerâ”‚ â”œâ”€ entry-compiler.jsâ”‚ â”œâ”€ entry-framework.jsâ”‚ â”œâ”€ entry-runtime-factory.jsâ”‚ â”œâ”€ runtimeâ”‚ â””â”€ utilâ”œâ”€ serverâ”‚ â”œâ”€ bundle-rendererâ”‚ â”‚ â”œâ”€ create-bundle-renderer.jsâ”‚ â”‚ â”œâ”€ create-bundle-runner.jsâ”‚ â”‚ â””â”€ source-map-support.jsâ”‚ â”œâ”€ create-basic-renderer.jsâ”‚ â”œâ”€ create-renderer.jsâ”‚ â”œâ”€ optimizing-compilerâ”‚ â”‚ â”œâ”€ codegen.jsâ”‚ â”‚ â”œâ”€ index.jsâ”‚ â”‚ â”œâ”€ modules.jsâ”‚ â”‚ â”œâ”€ optimizer.jsâ”‚ â”‚ â””â”€ runtime-helpers.jsâ”‚ â”œâ”€ render-context.jsâ”‚ â”œâ”€ render-stream.jsâ”‚ â”œâ”€ render.jsâ”‚ â”œâ”€ template-rendererâ”‚ â”‚ â”œâ”€ create-async-file-mapper.jsâ”‚ â”‚ â”œâ”€ index.jsâ”‚ â”‚ â”œâ”€ parse-template.jsâ”‚ â”‚ â””â”€ template-stream.jsâ”‚ â”œâ”€ util.jsâ”‚ â”œâ”€ webpack-pluginâ”‚ â”‚ â”œâ”€ client.jsâ”‚ â”‚ â”œâ”€ server.jsâ”‚ â”‚ â””â”€ util.jsâ”‚ â””â”€ write.jsâ”œâ”€ sfcâ”‚ â””â”€ parser.jsâ””â”€ shared â”œâ”€ constants.js â””â”€ util.js","categories":[],"tags":[]},{"title":"Vueçš„å˜åŒ–ä¾¦æµ‹","slug":"Vue-source-learn2","date":"2020-05-22T00:40:28.000Z","updated":"2020-05-28T14:18:34.374Z","comments":true,"path":"2020/05/22/Vue-source-learn2/","link":"","permalink":"https://tsunamigg.github.io/2020/05/22/Vue-source-learn2/","excerpt":"Vueçš„å“åº”å¼æ•°æ®æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Ÿ","text":"Vueçš„å“åº”å¼æ•°æ®æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Ÿ å˜åŒ–ä¾¦æµ‹ å˜åŒ–ä¾¦æµ‹ = æ•°æ®è§‚æµ‹+ä¾èµ–æ”¶é›†+ä¾èµ–æ›´æ–° ä½¿ç”¨Object.definePropertyæ¥ä½¿å¾—æ•°æ®å˜å¾—å¯â€œè§‚æµ‹â€ ä¾èµ–æ”¶é›†(Observer)ï¼šæ˜¯æŒ‡æ”¶é›†è§†å›¾é‡Œçš„éƒ¨åˆ†ä¸æ•°æ®ç»‘å®šçš„å…³ç³» åœ¨getterä¸­æ”¶é›†ä¾èµ–ï¼Œåœ¨setterä¸­é€šçŸ¥æ›´æ–°ä¾èµ– å…¸å‹çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼,ä¸ºäº†è§£è€¦ï¼Œæ–°å¢äº†ä¸€ä¸ªç®¡ç†å¯¹è±¡ dep(æ”¶é›†æŸä¸ªæ•°æ®ç›¸å…³çš„æ‰€æœ‰ä¾èµ–)ï¼Œwatcher(è¢«depé€šçŸ¥ï¼Œæ›´æ–°ä¾èµ–) 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950// observer.js// æ”¶é›†ä¾èµ–const Dep = require('./dep');export class Observer &#123; constructor(value) &#123; this.value = value; def(value, \"__ob__\", this); if (Array.isArray(value)) &#123; console.log(\"array\"); &#125; else &#123; this.walk(value); &#125; &#125; walk(obj) &#123; const keys = Object.keys(obj); for (let i = 0; i &lt; keys.length; i++) &#123; defineReactive(obj,keys[i]); &#125; &#125;&#125;function defineReactive(obj, key, val) &#123; if (arguments.length === 2) &#123; val = obj[key]; &#125; if (typeof val === 'object') &#123; new Observer(val); &#125; const dep = new Dep(); Object.defineProperty(obj, key, &#123; enumerable: true, configurable: true, get() &#123; dep.depend(); return val; &#125;, set(newval) &#123; if (val === newval) return; val = newval; dep.notify(); &#125; &#125;)&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142// dep.js// ä¾èµ–ç®¡ç†å™¨ï¼š 1æ•°æ® ï¼šnä¾èµ– çš„ä¸€å¯¹å¤šå…³ç³»è¿›è¡Œä¾èµ–ç®¡ç†ï¼Œæ”¶é›†æŸä¸ªæ•°æ®ç›¸å…³çš„æ‰€æœ‰ä¾èµ–export default class Dep &#123; constructor() &#123; this.subs = []; &#125; addSub(sub) &#123; this.subs.push(sub); &#125; removeSub(sub) &#123; remove(this.subs, sub); &#125; depend() &#123; window.target &amp;&amp; this.addSub(window.target); &#125; notify() &#123; const subs = this.subs.slice(); for (let i = 0; i &lt; subs.length; i++) &#123; subs[i].update(); &#125; &#125;&#125;export function remove(arr, item) &#123; if (arr.length &gt; 1) &#123; const itemIndex = arr.indexOf(item); if (itemIndex &gt; 1) &#123; return arr.splice(itemIndex, 1); &#125; &#125; &#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354// watcher.js// watcherè¡¨ç¤ºä¾èµ–å…³ç³»ï¼Œé€šçŸ¥è§†å›¾æ›´æ–°// window.targetæ˜¯ä¸ºäº†æ‹·è´ä¸€ä»½ watcher,æ·»åŠ åˆ°Depçš„ä¾èµ–æ•°ç»„ä¸­export default class Watcher &#123; constructor(vm, expOrFn, cb) &#123; this.vm = vm; this.cb = cb; this.getter = parsePath(expOrFn); this.value = this.get(); &#125; get() &#123; window.target = this; const vm = this.vm; let value = this.getter.call(vm, vm); window.target = undefined; return value; &#125; update() &#123; const oldValue = this.value; this.value = this.get(); this.cb.call(this.vm, this.value, oldValue); &#125;&#125;/** * æŠŠä¸€ä¸ªå½¢å¦‚'data.a.b.c'çš„å­—ç¬¦ä¸²è·¯å¾„æ‰€è¡¨ç¤ºçš„å€¼ï¼Œä»çœŸå®çš„dataå¯¹è±¡ä¸­å–å‡ºæ¥ * ä¾‹å¦‚ï¼š * data = &#123;a:&#123;b:&#123;c:2&#125;&#125;&#125; * parsePath('a.b.c')(data) // 2 */const bailRE = /[^\\w.$]/;export function parsePath(path) &#123; if (bailRE.test(path)) return; const segements = path.split('.'); return function (obj) &#123; for (let i = 0; i &lt; segements.length; i++) &#123; if (!obj) return; obj = obj[segements[i]]; &#125; return obj; &#125;&#125; ä¾¦æµ‹æµç¨‹ vueè¿™å¥—å˜åŒ–ä¾¦æµ‹çš„ç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼Œå› ä¸ºåˆ©ç”¨definePropertyæ¥è¿›è¡Œæ”¶é›†ï¼Œåªé™äºè¯»å’Œå†™å·²æœ‰å€¼ï¼Œå½“æˆ‘ä»¬å¯¹objè¿›è¡Œæ–°å¢æˆ–è€…åˆ é™¤å±æ€§å€¼æ—¶ï¼Œå®ƒæ˜¯ç›‘å¬ä¸åˆ°çš„ã€‚æ‰€ä»¥åœ¨å®˜ç½‘æ–‡æ¡£ä¸Šçš„å™è¿°ä¸Šè¯´æ˜è¿‡ï¼Œå¯¹æ•°ç»„æˆ–å¯¹è±¡çš„ç›´æ¥å¢åŠ æˆ–è€…åˆ é™¤ä¼šäº§ç”Ÿä¸æœŸæœ›çš„ç»“æœï¼Œ ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œç‰¹åœ°å¢åŠ äº†Vue.setå’ŒVue.deleteä¸¤ä¸ªå…¨å±€API ã€‚ æ•°ç»„æ€ä¹ˆåŠ? çœ‹åˆ°è¿™é‡Œï¼Œå¯¹åŸå‹ç†Ÿæ‚‰çš„äººå¯èƒ½ä¼šé—®äº†ï¼Œè¿™ç§æ–¹æ³•åªé’ˆå¯¹äºObjç±»å‹ï¼Œé‚£å‰©ä¸‹çš„å¸¸ç”¨çš„Arrç±»å‹æˆ–è€…å…¶ä»–ç±»å‹å‘¢ï¼ŸdefinePropertyæ•°ç»„æ˜¯ä¸å¯èƒ½ä½¿ç”¨çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå¯¹æ•°ç»„è¿›è¡Œä¾èµ–æ”¶é›†å’Œé€šçŸ¥æ›´æ–°ï¼Ÿ è¿˜æ˜¯å»¶ç»­ä¸Šé¢çš„æ€æƒ³ï¼šæ‹¦æˆªï¼Œvueå°†æ‰€æœ‰æ•°ç»„çš„å¼‚å˜æ–¹æ³•(èƒ½æ”¹å˜åŸæœ‰æ•°ç»„)æ‹¦æˆªä¸€æ³¢ï¼Œå°±èƒ½çŸ¥é“arrå•¥æ—¶å€™è¢«setteräº†ã€‚ ç»å¸¸é¢è¯•è¢«é—®åˆ°åŸå‹ï¼ŒåŸå‹é“¾çš„what,why,é‚£ä¹ˆhow???? æˆ‘è§‰å¾—è¿™å°±æ˜¯ä¸ªå¾ˆå·§å¦™çš„å®è·µ~ æ‹¦æˆªæ•°ç»„åŸå‹ä¸Šçš„å¼‚å˜æ–¹æ³•(ä¼šæ”¹å˜åŸæœ‰å®¿ä¸»çš„æ–¹æ³•)çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748//ä»£ç ä½ç½® vue/src/core/observer/array.js/* * not type checking this file because flow doesn't play well with * dynamically accessing methods on Array prototype */import &#123; def &#125; from '../util/index'const arrayProto = Array.prototypeexport const arrayMethods = Object.create(arrayProto)const methodsToPatch = [ 'push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse']/** * Intercept mutating methods and emit events */methodsToPatch.forEach(function (method) &#123; // cache original method const original = arrayProto[method] def(arrayMethods, method, function mutator (...args) &#123; const result = original.apply(this, args) const ob = this.__ob__ let inserted switch (method) &#123; case 'push': case 'unshift': inserted = args break case 'splice': inserted = args.slice(2) break &#125; if (inserted) ob.observeArray(inserted) // notify change ob.dep.notify() return result &#125;)&#125;) æ•°ç»„ä¾èµ–æ”¶é›† æ— è®ºæ€æ ·,å…ˆå¾—ç”¨walkè®©å…ƒç´ æ³¨å…¥observerä¾èµ–ï¼Œä½¿å¾—åœ¨getterä¸­å®ä¾‹åŒ–Depæ”¶é›†ä¾èµ–å¹¶å°†æ•°ç»„æ–¹æ³•æ‹¦æˆªæ‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102// æºç ä½ç½®ï¼š/src/core/observer/index.jsconst Dep = require(\"./dep\");const &#123; arrayKeys, arrayMethods &#125; = require(\"./array\");// æºç ä½ç½®ï¼šsrc/core/observer/index.js// ä½¿ç”¨ defineProperty è®©æ•°æ®å¯è§‚æµ‹export class Observer &#123; constructor(value) &#123; this.value = value; this.dep = new Dep(); def(value, \"__ob__\", this); if (Array.isArray(value)) &#123; const agument = hasProto ? protoAugment : copyAugument; [agument](value, arrayMethods, arrayKeys); this.observerArray(value); &#125; else &#123; this.walk(value); &#125; &#125; walk(obj) &#123; const keys = Object.keys(obj); for (let i = 0; i &lt; keys.length; i++) &#123; defineReactive(obj, keys[i]); &#125; &#125; observerArray(ietms) &#123; for (let i = 0; i &lt; ietms.length; i++) &#123; observe(ietms[i]); &#125; &#125;&#125;export const hasProto = \"__proto__\" in &#123;&#125;;/* å¤åˆ¶åŸå‹å±æ€§ï¼Œæ·»åŠ æ‹¦æˆª*/function protoAugment(target, src, keys) &#123; target.__proto__ = src;&#125;function copyAugument(target, src, keys) &#123; for (let i = 0; i &lt; keys.length; i++) &#123; const key = key[i]; def(target, key, src[key]); &#125;&#125;/* * å°è¯•ä¸ºvalueåˆ›å»ºä¸€ä¸ª0bserverå®ä¾‹ï¼Œå¦‚æœåˆ›å»ºæˆåŠŸï¼Œç›´æ¥è¿”å›æ–°åˆ›å»ºçš„Observerå®ä¾‹ã€‚ * å¦‚æœ Value å·²ç»å­˜åœ¨ä¸€ä¸ªObserverå®ä¾‹ï¼Œåˆ™ç›´æ¥è¿”å›å®ƒ */function observe(value) &#123; if (!isObject(value) || value instanceof VNode) &#123; return; &#125; let ob; if (hasOwn(value, '__ob__') &amp;&amp; value.__ob__ instanceof Observer) &#123; ob = value.__ob__; &#125; else &#123; ob = new Observer(value); &#125; return ob;&#125;function defineReactive(obj, key, val) &#123; let childOb = observe(val); if (arguments.length === 2) &#123; val = obj[key]; &#125; if (typeof val === \"object\") &#123; new Observer(val); &#125; const dep = new Dep(); Object.defineProperty(obj, key, &#123; enumerable: true, configurable: true, get() &#123; if (childOb) &#123; childOb.dep.depend(); &#125; return val; &#125;, set(newval) &#123; if (val === newval) return; val = newval; dep.notify(); &#125; &#125;);&#125; é€šçŸ¥æ›´æ–° ä¸»è¦æ˜¯è¿˜è¦å¯¹æ•°ç»„è¿›è¡Œæ·±åº¦ç›‘æµ‹å’Œæ–°å¢å…ƒç´ ä¾¦æµ‹ï¼Œåœ¨æ‹¦æˆªçš„åŸå‹ä¸Šè¿›è¡Œä¾èµ–æ›´æ–°ã€‚ __ob__æ˜¯åœ¨è¿›è¡Œåˆå§‹åŒ–observerçš„æ—¶å€™ï¼Œåœ¨è¢«ç›‘å¬è€…ä¸Šé¢æŒ‚è½½äº†è‡ªå·±çš„å®ä¾‹ï¼Œä»¥ä¾¿è®¿é—®åè¿›è¡Œä¾èµ–æ›´æ–°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748// æºç ä½ç½®ï¼švue/src/core/observer/array.js/* * not type checking this file because flow doesn't play well with * dynamically accessing methods on Array prototype */import &#123; def &#125; from '../util/index'const arrayProto = Array.prototypeexport const arrayMethods = Object.create(arrayProto)const methodsToPatch = [ 'push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse']/** * Intercept mutating methods and emit events */methodsToPatch.forEach(function (method) &#123; // cache original method const original = arrayProto[method] def(arrayMethods, method, function mutator (...args) &#123; const result = original.apply(this, args) const ob = this.__ob__ let inserted switch (method) &#123; case 'push': case 'unshift': inserted = args break case 'splice': inserted = args.slice(2) break &#125; if (inserted) ob.observeArray(inserted) // notify change ob.dep.notify() return result &#125;)&#125;) æ€»ç»“ï¼š vueçš„å˜åŒ–ä¾¦æµ‹ä¸Reactå¯¹æ¯”Vdomå’ŒAngularçš„è„å€¼æ£€æµ‹éƒ½ä¸ä¸€æ ·ã€‚æ ¸å¿ƒæ˜¯åˆ©ç”¨definePropertyçš„èƒ½åŠ›ï¼Œæ‹¦æˆªæ‰€æœ‰ç»‘å®šçš„å“åº”å¼æ•°æ®(dataä¸­),åœ¨æ‹¦æˆªä¸­æ·»åŠ ä¾èµ–ç®¡ç†å™¨Depæ¥æ”¶é›†ç®¡ç†ä¾èµ–,ç”¨Watcherè¡¨ç¤ºä¾èµ–å…³ç³»æœ¬èº«ï¼Œè¿›è¡Œé€šçŸ¥ä¾èµ–æ›´æ–°ã€‚ å…¶ä¸­ï¼Œå¯¹äºæ•°ç»„çš„ä¾¦æµ‹çš„æ€è·¯æ˜¯ï¼Œè¦†ç›–æ‰€æœ‰æ•°ç»„åŸå‹çš„çš„å¼‚å˜æ–¹æ³•ï¼Œåœ¨è¦†ç›–åæ¤å…¥ä¾èµ–é€»è¾‘ã€‚è¿™å¥—ç¼ºç‚¹å°±æ˜¯å¯¹æ•°ç»„è¿›è¡Œä¸‹æ ‡èµ‹å€¼æ“ä½œæ—¶ï¼Œvueæ˜¯ä¾¦æµ‹ä¸åˆ°çš„ï¼Œå®˜ç½‘æ–‡æ¡£ä¸Šå¤šå¤„å¯¹æ­¤æœ‰è¯´æ˜ã€‚ ç›¸ä¿¡ä¸‹æ¬¡ï¼Œé¢è¯•å®˜é—®ï¼šä¸ºä»€ä¹ˆåœ¨vueä¸­å¯¹æ•°ç»„ä¸‹æ ‡è¿›è¡Œèµ‹å€¼æ“ä½œä¼šå¯¼è‡´ä¸æ­£ç¡®çš„å“åº”å¼æ•°æ®ç»“æœã€‚è¿™ç§ç±»ä¼¼çš„é—®é¢˜ï¼Œä½ ä¸€å®šèƒ¸æœ‰æˆç«¹ã€‚","categories":[],"tags":[{"name":"Vue-2.6X-source-learn notes","slug":"Vue-2-6X-source-learn-notes","permalink":"https://tsunamigg.github.io/tags/Vue-2-6X-source-learn-notes/"}]},{"title":"fabric notes","slug":"fabric-notes","date":"2020-04-21T01:17:56.000Z","updated":"2020-05-28T14:41:44.183Z","comments":true,"path":"2020/04/21/fabric-notes/","link":"","permalink":"https://tsunamigg.github.io/2020/04/21/fabric-notes/","excerpt":"ä¸€æ¬¡ fabric + customiseControls åˆ¶ä½œæ¶‚é¸¦canvasç”»æ¿å®è·µ","text":"ä¸€æ¬¡ fabric + customiseControls åˆ¶ä½œæ¶‚é¸¦canvasç”»æ¿å®è·µ åˆ¶ä½œå›¾ç‰‡æ¶‚é¸¦ç”»æ¿(å¾®ä¿¡æµè§ˆå™¨) fabric+customiseControlsç®€ä»‹ fabricæ˜¯ä¸€ä¸ªcanvasåº“ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯å°†canvasAPIè½¬æ¢ä¸ºå¯¹è±¡æ¨¡å‹ï¼Œè®©æˆ‘ä»¬æ›´åŠ ä¾¿æ·çš„ä½¿ç”¨ã€‚ customiseControlsåˆ™æ˜¯åŸºäºfabricçš„æ’ä»¶ï¼Œå¯ä¸ºæ–°å»ºçš„fabricå¯¹è±¡è®¾ç½®è§’æ ‡ï¼Œå¹¶ä¸ºå…¶æä¾›ä¸€ç³»åˆ—äº‹ä»¶ï¼šdragï¼Œ scaleï¼Œrotateï¼Œremoveï¼Œæˆ–è€…è‡ªå®šä¹‰äº‹ä»¶ã€‚ fabric:https://github.com/fabricjs/fabric.js customiseControlsï¼šhttps://github.com/pixolith/fabricjs-customise-controls-extension æ•ˆæœè¯´æ˜(æ¨¡ç³Šçš„å›¾ç‰‡æ˜¯æ•…æ„çš„) ç”¨æˆ·æ¶‚é¸¦ç¯èŠ‚ï¼š æ¶‚é¸¦çš„æ„æˆ = 1.åŸå¸‚èƒŒæ™¯å›¾ + è´´çº¸å›¾ç‰‡ç´ æ + æ–‡å­—å›¾ç‰‡ç´ æ 1ç‚¹å‡»ç¼©ç•¥å›¾åˆ‡æ¢ï¼Œåˆ‡æ¢æ—¶2ï¼Œ3ä¸å˜åŒ–ã€‚ 2ï¼Œ3æ˜¯å¯é€‰ä¸­åå¯æ‹–æ‹½ï¼Œæ‹–æ‹½æ—¶ä¸å½±å“å…¶ä»–å›¾ç‰‡ç´ æï¼Œé€‰ä¸­ä¹‹åå‡ºç°å››ä¸ªè§’çš„è§’æ ‡ï¼Œè§’æ ‡çš„äº‹ä»¶ä¸ºæ”¾å¤§ï¼Œç¼©å°ï¼Œæ—‹è½¬ï¼Œç§»é™¤ã€‚ ç”Ÿæˆç¯èŠ‚ æ ¹æ®ç”¨æˆ·æ¶‚é¸¦çš„ç»“æœï¼Œç”Ÿæˆä¸€å¼ å¸¦æœ‰å…¶ä»–ä¿¡æ¯çš„æµ·æŠ¥(é•¿æŒ‰ä¿å­˜åˆ°æ‰‹æœºç›¸å†Œ)ï¼Œæ¯”å¦‚ï¼š ç”¨æˆ·åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œå½“å‰å‚ä¸äººæ•°ï¼ŒäºŒç»´ç ï¼Œæ˜µç§°ï¼Œå¤´åƒç­‰ç­‰ å¼€æ’¸ å¼€æ’¸ä¹‹å‰è¿˜æ˜¯æ¢³ç†ä¸€ä¸‹é‡ç‚¹å’Œä¼˜åŒ–ç‚¹ï¼š A.æ¶‚é¸¦ç”»æ¿çš„äº¤äº’(é‡ç‚¹) B.ç²¾å‡†ç”Ÿæˆæµ·æŠ¥(é‡ç‚¹)å’Œæµ·æŠ¥çš„æ¸…æ™°åº¦(ä¼˜åŒ–ç‚¹) Aéƒ¨åˆ†ï¼š ç”¨æˆ·é€‰æ‹©å¯¹åº”èƒŒæ™¯æˆ–è€…æ¶‚é¸¦ç´ æåæœ‰æ­£ç¡®ç›¸åº”ï¼Œè®¾ç½®è¾¹ç•Œå€¼ 1.åˆå§‹åŒ–fabricæ’ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768// è®¾ç½®éƒ¨åˆ†è§’æ ‡ä¸å¯è§fabric.Object.prototype.setControlsVisibility(&#123; ml: false, mr: false, mtr: false, mt: false, mb: false&#125;);// è§’æ ‡äº‹ä»¶è®¾ç½®fabric.Canvas.prototype.customiseControls(&#123; br: &#123; action: \"rotate\" &#125;, bl: &#123; action: 'scale' &#125;, tl: &#123; action: function action(e, target) &#123; var canvas = target.canvas; canvas.remove(target).renderAll(); &#125; &#125;, tr: &#123; action: 'scale' &#125;&#125;);// ç¦ç”¨é€‰æ¡†fabric.Object.prototype.transparentCorners = false;// è§’æ ‡åŸºç¡€è®¾ç½®fabric.Object.prototype.customiseCornerIcons(&#123; settings: &#123; borderColor: '#fff', cornerSize: 20, cornerBackgroundColor: 'transparent', cornerPadding: 5 &#125;, br: &#123; action: \"rotate\", icon: './imgs/icons/rotate.svg' &#125;, bl: &#123; action: 'scale', icon: './imgs/icons/resize.svg' &#125;, tl: &#123; icon: './imgs/icons/remove.svg', action: function action(e, target) &#123; var canvas = target.canvas; canvas.remove(target).renderAll(); &#125; &#125;, tr: &#123; action: 'scale', icon: './imgs/icons/resize.svg' &#125;&#125;, function () &#123; board.renderAll();&#125;);var ww = $(window).width();var wh = $(window).height();var board = new fabric.Canvas('drawBoard', &#123; backgroundColor: 'transparent', width: (ww * 0.92 height: (wh * 0.67&#125;); 2.æ·»åŠ ç”¨æˆ·ç‚¹å‡»äº¤äº’(click -&gt; æ–°å¢å¯¹åº”ç´ æè‡³ç”»æ¿ æˆ–è€…åˆ‡æ¢åŸå¸‚èƒŒæ™¯) 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162var fabricItemList = [];// è®¾ç½®å›¾ç‰‡èƒŒæ™¯function setImagebg(imgSrc) &#123; fabric.Image.fromURL(imgSrc, function (img) &#123; img.set(&#123; scaleX: board.width / img.width, scaleY: board.height / img.height &#125;); board.setBackgroundImage(img, board.renderAll.bind(board)); board.requestRenderAll(); &#125;, &#123; crossOrigin: 'anonymous' &#125;);&#125;// è®¾ç½®è‡ªå®šä¹‰å›¾ç‰‡function setPicture(obj) &#123; obj.customiseCornerIcons(function () &#123; board.renderAll(); &#125;); fabricItemList.push(obj); board.add(obj); board.setActiveObject(obj);&#125;// ç”Ÿæˆæ–‡å­—å¯¹è±¡function addText(ctext) &#123; var color = arguments.length &gt; 1 &amp;&amp; arguments[1] !== undefined ? arguments[1] : \"#fff\"; var textObj = new fabric.Text(ctext, &#123; fontFamily: \"PingFang SC, Verdana, Helvetica Neue, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif\", fontSize: 30, top: 150, left: 150, originX: 'center', originY: 'center', fill: color &#125;); setPicture(textObj);&#125;// ç”Ÿæˆå›¾ç‰‡å¯¹è±¡function featImg(imgSrc, scale) &#123; fabric.Image.fromURL(imgSrc, function (img) &#123; img.set(&#123; scaleX: scale, scaleY: scale, angle: 0, left: Math.random() &lt; 0.5 ? Math.random() * 50 + 110 : -Math.random() * 50 + 110, top: Math.random() &lt; 0.5 ? Math.random() * 50 + 120 : -Math.random() * 50 + 120, hasControls: true, borderColor: '#fff' &#125;); setPicture(img); &#125;, &#123; crossOrigin: 'anonymous' &#125;);&#125; 3.ç”Ÿæˆç”»æ¿å›¾ 1234567let drawImg = board.toDataURL(); // ç”Ÿæˆåå¤åŸfabricå¯¹è±¡fabricItemList.forEach(function (item) &#123; return board.remove(item);&#125;);fabricItemList = []; Béƒ¨åˆ†ï¼š å¦‚ä½•æ ¹æ®è®¾è®¡ç¨¿ç²¾å‡†ç»˜åˆ¶æµ·æŠ¥ï¼ˆé‡ç‚¹ï¼‰ï¼Ÿ 1.ä½¿ç”¨ç°æœ‰æˆç†Ÿçš„æ–¹æ¡ˆï¼š canvas2Image + html2canvas(é«˜è´¨é‡å‰ç«¯å¿«ç…§æ–¹æ¡ˆï¼šæ¥è‡ªé¡µé¢çš„ã€Œè‡ªæ‹ã€) è¯¦è§ç½‘æ˜“äº‘éŸ³ä¹å›¢é˜Ÿçš„æ–‡ç« ï¼šhttps://juejin.im/post/5df2e8ab6fb9a0163770816d#heading-15 2.è‡ªå·±çæŠ˜è…¾ æœ€ç»ˆé€‰æ‹©ï¼š*è‡ªå·±çæŠ˜è…¾ * å¿ƒè·¯å†ç¨‹ï¼š ï¼Ÿï¼Ÿï¼Ÿï¼Ÿä½œè€…æ˜¯ä¸æ˜¯è„‘å­æœ‰ç—…(å°å£°BB)â€¦ ä¸ºä»€ä¹ˆæˆ‘è¦åšè´¹åŠ›ä¸è®¨å¥½çš„äº‹æƒ…ï¼Ÿ ç°æˆçš„åº“ä»–ä¸é¦™å—ï¼Ÿ åŸå› åœ¨äºiosæ‰‹æœºåœ¨æˆæƒåçš„ï¼šå¾®ä¿¡æµè§ˆå™¨çš„ç™½æ¡é—®é¢˜ ç™½æ¡ä¼šä½¿å¾—æ•´ä¸ªå¯è§†åŒºçš„DOMè¢«å‘ä¸Šé¡¶ä¸€éƒ¨åˆ†è·ç¦»â€¦ æ•´ä¸ªç½‘ä¸Šçš„æ–¹æ¡ˆéƒ½åœ¨ç°æœ‰èµ„æºä¸‹éƒ½ä¸èƒ½å¥½å¥½è§£å†³ï¼Œhttps://developers.weixin.qq.com/community/develop/doc/0000a09f840910386ee69390251c00 ç™½æ¡é—®é¢˜ä½¿å¾—åœ¨ä½¿ç”¨å‰é¢çš„ã€Œè‡ªæ‹ã€æ–¹æ¡ˆæ—¶ï¼Œç”Ÿæˆçš„æµ·æŠ¥ä¼šé”™ä½â€¦ç»“æœæƒ¨ä¸å¿ç¹ï¼ html2canvasæ˜¯æ ¹æ®éå†DOMæ ·å¼ä¿¡æ¯æ¥ç”Ÿæˆçš„ï¼Œè€Œä¸”åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šé‡æ–°åŠ è½½æ‰€æœ‰èµ„æº(åœ¨networkè‡ªå·±çœ‹)ï¼Œå¦‚æœé‡åˆ°è´¨é‡è¾ƒé«˜æˆ–è€…åƒè¿™æ ·çš„æ•°é‡çš„å›¾ç‰‡ï¼Œä¼šå‡ºç°ç»˜åˆ¶ç©ºç™½çš„å¯èƒ½ã€‚ è‡ªå·±çæŠ˜è…¾çš„ç»“æœï¼š æ ¹æ®canvasçš„drawimageå†™äº†ä¸ªç”Ÿæˆå›¾çš„jsï¼Œå†™çš„åƒåœ¾ï¼Œå¤§ä½¬å‹¿å–·â€¦https://github.com/tsunamiGG/utils/blob/master/makePoster.jsã€‚ å¤§æ¦‚æ€è·¯ï¼š canvaså›¾å±‚å †å æ˜¯æœ‰é¡ºåºçš„ï¼Œæ‰€ä»¥æŒ‰ç…§å›¾å±‚é¡ºåºè¿›è¡Œä¼ å‚ã€‚ ä¸ºä¿è¯ç”Ÿæˆèµ„æºçš„å®Œæ•´æ€§ï¼Œå¿…é¡»å…ˆç¡®ä¿onloadä¹‹åè¿›å…¥åˆæˆè¿‡ç¨‹ã€‚ ä»¥å·¦ä¸Šè§’ä¸ºåŸç‚¹ï¼Œç„¶åä½¿ç”¨æ€§èƒ½ä¸é”™çš„drawimage(x,y,w,h)ç¦»å±æ¸²æŸ“ç”Ÿæˆï¼Œä»è€Œé¿å¼€äº†ç”Ÿæˆå›¾è¢«ç™½æ¡å½±å“ã€‚ béƒ¨åˆ†ï¼šæµ·æŠ¥çš„æ¸…æ™°åº¦(ä¼˜åŒ–ç‚¹) å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„æ•ˆæœå›¾æ¸…æ™°åº¦æ˜¯éå¸¸ä¸ç†æƒ³çš„ï¼Œéœ€è¦ä¼˜åŒ–ã€‚ ä¸ºä»€ä¹ˆæˆ‘ä»¬çš„canvasç»˜åˆ¶çš„ä¸œè¥¿çœ‹ä¸Šå»æ€»æ˜¯æ¯”ç”¨DOMåˆæˆçš„ä¸œè¥¿ç³Šä¸€äº›ï¼Ÿ çœŸå®ç‰©ç†è®¾å¤‡çš„åƒç´ å’Œcssçš„åƒç´ æ˜¯æœ‰å·®è·çš„ï¼Œwindow.devicePixelRatioçš„å€¼å°±ååº”äº†å…¶æ¯”ä¾‹ã€‚å®ƒå‘Šè¯‰æµè§ˆå™¨åº”ä½¿ç”¨å¤šå°‘å±å¹•å®é™…åƒç´ æ¥ç»˜åˆ¶å•ä¸ªCSSåƒç´ ã€‚ åŒä¸€ä¸ªä¸œè¥¿ï¼Œä½ ä½¿ç”¨ä¸€ä¸ªcssåƒç´ æ¥è¡¨ç¤ºï¼Œå‡è®¾åœ¨ä¸åŒæ‰‹æœºä¸Šåˆ†åˆ«æµè§ˆå™¨æœ¬éœ€è¦4ä¸ªç‰©ç†åƒç´ æˆ–8ä¸ªç‰©ç†åƒç´ ã€‚è€Œcanvasåªç”¨ä¸€ä¸ªä½å›¾åƒç´ æ¥å¡«å……4ä¸ªç‰©ç†åƒç´ æˆ–8ä¸ªç‰©ç†åƒç´ ï¼Œä¸ç³Šæ‰æ€ªå‘¢.. å¦‚æœæƒ³æ·±å…¥äº†è§£ï¼Œå‚è€ƒï¼šhttps://juejin.im/post/5cbdda7bf265da036504fb46 1.jsè®¾ç½®æ”¾å¤§devicePixelRatioå€æ•°å®½é«˜çš„canvasï¼Œcssè®¾ç½®ç¼©å°devicePixelRatioå€æ•°çš„canvasã€‚æ‰©å¤§å®é™…åƒç´ æ•°é‡ï¼Œè§†è§‰ä¸Šä¿æŒè·ŸåŸæœ‰å°ºå¯¸ä¸€è‡´ï¼Œåœ¨APIç”Ÿæˆå›¾ç‰‡åä¼šæ¸…æ™°å¾ˆå¤šã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨cssç¼©å°è§†è§‰ç”»å¸ƒæ—¶ï¼Œç”±äºfabircä¼šåœ¨htmlä¸Šç”Ÿæˆä¸¤ä¸ªcanvasç”»å¸ƒï¼Œåˆ†åˆ«æ˜¯outerå’Œinnerï¼Œä½ éœ€è¦æŠŠä¸¤ä¸ªç”»å¸ƒçš„csséƒ½ç¼©å°ã€‚ 2.å…³é—­canvasæŠ—é”¯é½¿ 123456789101112const canvas = document.createElement(\"canvas\");const scale = window.devicePixelRatio;canvas.width = width * scale;canvas.height = height * scale;const context = canvas.getContext(\"2d\").scale(scale, scale)// å…³é—­æŠ—é”¯é½¿context.mozImageSmoothingEnabled = false;context.webkitImageSmoothingEnabled = false;context.msImageSmoothingEnabled = false;context.imageSmoothingEnabled = false; ä¼˜åŒ–åæ•ˆæœå¦‚ä¸‹ï¼Œæ‰‹æœºä¿å­˜å›¾å®é™…è´¨é‡æ¯”è¿™ä¸ªé«˜ï¼š 4.æ€»ç»“å¯¹ååˆ†é™Œç”Ÿçš„canvasç¨å¾®æœ‰äº†ä¸€äº›è®¤è¯†ï¼Œç”¨canvasåšåŠ¨ç”»çš„åº“éå¸¸å¤šï¼Œä½†æœ‰ä¸ªè‡´å‘½çš„ç¼ºç‚¹å°±æ˜¯æ²¡åŠæ³•è¿›è¡Œè°ƒè¯•â€¦ å…¶ä¸­è¿˜æœ‰å¾ˆå¤šå¾®ä¿¡æµè§ˆå™¨çš„å¾ˆå¤šç„å­¦é—®é¢˜å°±ä¸å±•å¼€äº†ï¼Œç™½æ¡é—®é¢˜ç¡®å®æ˜¯å¾ˆå¤´ç–¼çš„ã€‚fabricå¯ä»¥æ•´å‡ºå¾ˆå¤šæƒŠè‰³çš„æ•ˆæœï¼Œä½†å…¶ä¹±ä¸ƒå…«ç³Ÿçš„æ–‡æ¡£å’Œç³Ÿç³•çš„ç¤ºä¾‹ä¼šå¸¦æ¥å¾ˆå¤šéº»çƒ¦ï¼Œå½±å“å‘æŒ¥â€¦","categories":[],"tags":[{"name":"fabric canvas notes","slug":"fabric-canvas-notes","permalink":"https://tsunamigg.github.io/tags/fabric-canvas-notes/"}]},{"title":"åˆ›å»ºå¯¹è±¡çš„å‡ ç§æ–¹å¼","slug":"object-create","date":"2019-08-25T11:45:38.000Z","updated":"2020-05-28T14:21:24.705Z","comments":true,"path":"2019/08/25/object-create/","link":"","permalink":"https://tsunamigg.github.io/2019/08/25/object-create/","excerpt":"åœ¨nativeä¸­ï¼Œåˆ›å»ºå¯¹è±¡çš„æ–¹å¼åƒå·®ä¸‡åˆ«ï¼Œè®¾è®¡æ¨¡å¼ä¸­çš„åˆ›å»ºå‹åˆ™åŸºäºè¿™äº›ä¸åŒçš„æ–¹å¼","text":"åœ¨nativeä¸­ï¼Œåˆ›å»ºå¯¹è±¡çš„æ–¹å¼åƒå·®ä¸‡åˆ«ï¼Œè®¾è®¡æ¨¡å¼ä¸­çš„åˆ›å»ºå‹åˆ™åŸºäºè¿™äº›ä¸åŒçš„æ–¹å¼ 1.ç®€å•å·¥å‚æ¨¡å¼ï¼šSimple Factoryå·¥å‚æ¨¡å¼ä»€ä¹ˆæ„æ€ï¼Ÿ å¦‚æœæŠŠæˆ‘ä»¬ç¼–å†™ä¸šåŠ¡ä»£ç çš„è¿‡ç¨‹ï¼Œæ¯”ä½œé€ ä¸€å°ç”µè§†æœºï¼Œé‚£ä¹ˆå·¥å‚æ¨¡å¼å°±æ˜¯å…ˆæ‰“é€ å¥½ç”Ÿäº§ç”µè§†æœºçš„æµæ°´çº¿ã€‚å¦‚ä½•æ‰“é€ ç”Ÿäº§çº¿ï¼Ÿï¼Ÿï¼Ÿ æˆ‘ä»¬å°†éœ€è¦å·¥å‚åˆ¶é€ çš„äº§ç‰©çš„ç‰¹æ€§æŠ½è±¡å‡ºæ¥ï¼Œåœ¨ä»£ç ä¸Šè¡¨ç°ä¸ºæˆ‘ä»¬è§„å®šå…¶å±æ€§åç§°ï¼Œä½†å…¶å±æ€§å€¼åˆå‚æ•°æ¥å†³å®šã€‚ 1234567function createBook(name, pages, author) &#123; let newBook = &#123;&#125;; newBook.name = name; newBook.pages = pages; newBook.author = author; return newBook;&#125; è¿™æ˜¯ä¸€ç§å·¥å‚æ¨¡å¼ï¼Œå…¶å®ç°æ–¹å¼ä¸ä¹‹å‰å­¦åŸºç¡€çš„å¯„ç”Ÿç»§æ‰¿æœ‰ç‚¹ç›¸ä¼¼ï¼Œä¹Ÿæ˜¯åœ¨ä¸€ä¸ªæ–°çš„å˜é‡ä¸Šå»æ·»åŠ å±æ€§ï¼Œä½¿ç”¨å­—é¢é‡æ–¹å¼åˆ›å»ºå¯¹è±¡ä¼šæ¯”ä½¿ç”¨newé«˜æ•ˆçš„å¤šã€‚ è¿˜æœ‰ä¸€ç§å°±æ˜¯å…ˆå°†ä¸åŒå‹å·çš„ç”µè§†æœºé€ å‡ºæ¥ï¼Œç„¶åé€šè¿‡å·¥å‚æ¥è¾“é€åˆ°ä¸åŒçš„äº§å“åŒºã€‚ è¿™é‡Œçš„å·¥å‚ä¸åœ¨åˆ¶é€ ï¼Œè€Œæ˜¯å……å½“deliverçš„è§’è‰²ã€‚ 123456789101112131415161718192021222324function fictionBook() &#123; this.name = 'ä¹å·ç¼¥ç¼ˆå½•'; this.story = 'é“ç”²ä¾ç„¶åœ¨'; this.tellStory = function()&#123; console.log(this.story) &#125;&#125;function classicBook() &#123; this.name = 'å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜'; this.author = 'æµ·ä¼¦å‡¯å‹’'; this.bookauthor = function () &#123; console.log(this.author) &#125;&#125;function createBook(type) &#123; switch (type) &#123; case 'fiction': return new fictionBook(); case 'classic': return new classicBook(); &#125;&#125; ä¸¤ç§æ–¹å¼ä¼˜ç¼ºç‚¹ååˆ†æ˜æ˜¾ï¼Œ ç¬¬ä¸€ç§å¸¸è§æ–¹å¼éœ€è¦æˆ‘ä»¬å›ºå®šæŸäº›å‚æ•°ç±»å‹ï¼Œé™åˆ¶äº†å…¶å¤šæ ·æ€§ï¼Œä½†ç›¸æ¯”ç¬¬äºŒç§çœäº‹å¤šäº†ã€‚ç¬¬äºŒç§åˆ™ç›¸åï¼Œæ¯åˆ›é€ ä¸€ç§ä¸åŒå‹å·çš„ç”µè§†æœºå°±éœ€è¦æˆ‘ä»¬å»åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å¹¶å‘åˆ†å‘ç±»æ·»åŠ è¯¥é€‰é¡¹ã€‚ 2.å·¥å‚æ–¹æ³•æ¨¡å¼: Factory Method12345678910111213141516//å®‰å…¨æ¨¡å¼ const Factory = function (type, content) &#123; if (this instanceof Factory) &#123; return new this[type](content); &#125; else &#123; return new Factory(type, content); &#125; &#125;Factory.prototype = &#123; show: function(content) &#123; this.content = content; console.log(content); &#125;&#125;const test = new Factory('show', '2'); å®‰å…¨æ¨¡å¼çš„å¥½å¤„åœ¨äºï¼Œåœ¨ç®€å•å·¥å‚æ¨¡å¼ä¸ŠåŠ äº†ä¸€å±‚é™åˆ¶ï¼Œå¦‚æœæ²¡æœ‰åˆ›å»ºå·¥å‚ç±»ï¼Œå°±ç›´æ¥æ‰§è¡Œè¯¥å‡½æ•°è€Œä¸æ˜¯è¿”å›å·¥å‚å¯¹è±¡ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940//æŠ½è±¡æ¨¡å¼const abstractFactory = function (superType, subType) &#123; if (typeof abstractFactory[superType] === 'function' ) &#123; function F() &#123;&#125;; F.prototype = new abstractFactory[superType](); subType.constructor = subType; subType.prototype = new F(); &#125; else &#123; throw new Error('æœªåˆ›å»ºè¯¥æŠ½è±¡ç±»') &#125;&#125;abstractFactory.desk = function() &#123; this.type = 'desk';&#125;abstractFactory.desk.prototype = &#123; getDeskSize: function () &#123; return new Error('æŠ½è±¡æ–¹æ³•ä¸èƒ½è°ƒç”¨') &#125;, getDeskMaterial: function() &#123; return new Error('æŠ½è±¡æ–¹æ³•ä¸èƒ½è°ƒç”¨') &#125;&#125;//å®ä¾‹åŒ–æŠ½è±¡deskç±»// 1.å­ç±»æ„é€ æ–¹æ³•let machilusDesk = function(size, material) &#123; this.size = size; this.material = material;&#125;// 2. å°†å­ç±»æ„é€ æ–¹æ³•é€å…¥å·¥å‚ï¼Œç»§æ‰¿å·¥å‚æŠ½è±¡æ–¹æ³•abstractFactory('desk', machilusDesk);// 3. è¦†ç›–æŠ½è±¡æ–¹æ³•machilusDesk.prototype.getDeskSize = function() &#123; return this.size;&#125;machilusDesk.prototype.getDeskMaterial = function() &#123; return this.material;&#125; åœ¨JSä¸­ï¼Œabstractæ˜¯ä¸€ä¸ªä¿ç•™å…³é”®å­—ï¼Œæ‰€ä»¥æƒ³è¦å®ç°æŠ½è±¡ç±»ï¼Œæ˜¯ä¸å¯èƒ½åƒä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€é‚£ä¹ˆæ–¹ä¾¿ï¼Œä½†ç”±äºå…¶çµæ´»æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿå‡ºæŠ½è±¡ç±»çš„ä¸»è¦è¡Œä¸ºã€‚ æŠ½è±¡æ–¹æ³•æ—¶ä¸å¯è°ƒç”¨çš„ï¼Œä¼šæŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¨¡æ‹Ÿå‡ºå…¶è¿™ä¸ªè¡Œä¸ºï¼Œå¹¶ä¸”é‡‡ç”¨å¯„ç”Ÿç»§æ‰¿æ¥ç»§æ‰¿çˆ¶ç±»ã€‚å½“å·¥å‚ç”Ÿæˆå­ç±»åï¼Œè¦†ç›–æŠ½è±¡æ–¹æ³•ï¼Œå°±ä¸ä¼šæŠ¥é”™äº†ã€‚ æŠ½è±¡æ¨¡å¼æ˜¯æå‰å®šä¹‰äº†ç±»çš„ç»“æ„ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ›å»ºç±»ã€‚å°±åƒå»ºæˆ¿å­å…ˆç”»å¥½æˆ¿å­çš„å›¾çº¸ä¸€æ ·ï¼Œå…ˆæè¿°å‡ºå…¶è½®å»“~ ä½†JSä¸­ä¸æ”¯æŒæŠ½è±¡åŒ–åˆ›å»ºå’Œè™šæ‹Ÿæ–¹æ³•ï¼Œæ‰€ä»¥å…¶å¼•ç”¨å¹¶ä¸å¹¿æ³›ï¼Œä½†ä¹Ÿæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­å¾ˆç»å…¸å¸¸è§çš„ä¸€ç§æ¨¡å¼ã€‚ 3.å»ºé€ è€…æ¨¡å¼ï¼š Builderå¦‚æœè¯´å·¥å‚æ¨¡å¼çš„ä¾§é‡ç‚¹åœ¨åˆ›å»ºçš„ç»“æœï¼Œé‚£ä¹ˆå»ºé€ è€…å°±æ˜¯æ³¨é‡åˆ›å»ºè¿‡ç¨‹çš„ä¸€ç§æ¨¡å¼ã€‚ å»ºé€ è€…ä¼šæ³¨æ„åˆ›å»ºè¿‡ç¨‹çš„æ¯ä¸ªç»†èŠ‚ï¼Œå°±åƒæˆ‘ä»¬ææ©¡çš®äººæ—¶ï¼Œä¸å…‰è¦æ³¨æ„èº«ä½“çš„è½®å»“ï¼Œè¿˜è¦æ³¨æ„å¤´æœ‰å¤šå¤§ï¼Œå››è‚¢æœ‰å¤šé•¿â€¦.ç†æ‰€å½“ç„¶çš„åˆ›å»ºè¿‡ç¨‹ä¼šå¤æ‚å¾ˆå¤šã€‚ å…¶è¿‡ç¨‹å°±æ˜¯å°†å„ç§ç‰¹æ€§éƒ½å°è£…æˆç±»ï¼Œç„¶ååœ¨ä¸»ç±»é‡Œé¢æ ¹æ®ä¸åŒå‚æ•°ï¼Œå®ä¾‹åŒ–ä¸åŒçš„ç‰¹æ€§ï¼Œç»„æˆæ–°çš„å­ç±»ï¼Œæˆ–è€…å«å…¶å¤åˆå¯¹è±¡ã€‚ 123456789101112131415161718192021222324252627function House(parmas) &#123; this.material = parmas &amp;&amp; parmas.material || '**'; this.area = parmas &amp;&amp; parmas.area || '**';&#125;House.prototype = &#123; getMaterial: function() &#123; return this.material; &#125;, getArea: function() &#123; return this.area; &#125;&#125;function material(material) &#123; this.material = material;&#125;function area(m) &#123; this.area = m * m;&#125;function newHouse(material, m) &#123; let _house = new House(); _house.material = new material(material); _house.area = new area(area); return _house;&#125; å°±åƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œå…ˆæŠŠå„å—ç§¯æœ¨çš„å½¢çŠ¶æ‰¾å¥½ï¼Œç„¶åç»„åˆåœ¨ä¸€èµ·ã€‚æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœè¦åœ¨ä¸€ä¸ªç½‘é¡µä¸Šå‘ˆç°å¡ç‰‡å †ç Œçš„æ•ˆæœï¼Œä½ ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ ä¸ªäººç†è§£ï¼Œè¿™ä¸ªæ¨¡å¼æ˜¯æˆ‘ä»¬ç»å¸¸è§£å†³ç”Ÿæ´»ä¸­é—®é¢˜çš„ä¸€ç§æ–¹æ³•çš„æŠ½è±¡ï¼Œå¤æ‚çš„é—®é¢˜ç®€å•åŒ–ï¼Œå°±æ˜¯å°†ä¸€ä¸ªå¤æ‚çš„äº‹ç‰©æ‹†åˆ†æˆå¤šä¸ªç®€å•çš„äº‹ç‰©ï¼Œå†ä»¥æŸç§æ–¹å¼ç»„åˆèµ·æ¥ï¼Œæ¥è§£å†³é—®é¢˜çš„ä¸€ç§æ–¹æ³•ã€‚ 4.åŸå‹æ¨¡å¼ï¼šprototypeå…¶è¢«ç§°ä¸ºè¯­è¨€ä¹‹é­‚ï¼Œå®ƒå°†åŸå‹å¯¹è±¡æŒ‡å‘åˆ›å»ºå¯¹è±¡çš„ç±»ï¼Œä½¿è¿™äº›ç±»å…±äº«åŸå‹å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§ã€‚ å­˜åœ¨å³åˆç†ï¼Œé‚£ä¹ˆå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿåœ¨å¾ˆå¤šå¤æ‚çš„åŠŸèƒ½ä¸‹ï¼Œæˆ‘ä»¬çš„å­ç±»éœ€è¦ç»§æ‰¿çˆ¶ç±»çš„ä¸€äº›å±æ€§ä¸æ–¹æ³•ï¼Œä½†æ˜¯å¹¶éæ‰€æœ‰å­ç±»éœ€æ±‚çš„å±æ€§å’Œæ–¹æ³•éƒ½æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥å­ç±»ä¼šä»çˆ¶ç±»ç»§æ‰¿ä¸€äº›ä¸å¿…è¦çš„ï¼Œå¢åŠ é¢å¤–å¼€é”€çš„å±æ€§å’Œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè½¦çš„çˆ¶ç±»ï¼Œå­ç±»å¯èƒ½æ˜¯è·‘è½¦ï¼Œè½¿è½¦ï¼ŒSUVï¼Œè¶Šé‡ï¼Œè·‘è½¦éœ€è¦æ•´ä¸ªè½¦ä½“ç»“æ„å’Œè½¿è½¦ä¸ä¸€æ ·ï¼Œä½†çˆ¶ç±»å› ä¸ºè€ƒè™‘æ•´ä½“æ€§ä¸ä¼šæœ‰ç‰¹æ®Šçš„è½¦ä½“ç»“æ„ï¼Œè€Œæ˜¯é€šç”¨çš„è½¿è½¦ç»“æ„ï¼Œé‚£ä¹ˆå­ç±»å°±ä»çˆ¶ç±»ç»§æ‰¿äº†ä¸€äº›é¢å¤–çš„è´Ÿæ‹…æ€§è´¨çš„å±æ€§å’Œæ–¹æ³•ã€‚è€Œå­ç±»æ¯æ¬¡å®ä¾‹åŒ–éƒ½ä¼šé€ æˆå¾ˆå¤šä¸å¯é¿å…çš„é¢å¤–å¼€é”€ã€‚ åŸå‹æ¦‚å¿µå°±æ­¤è€Œå‡ºï¼Œå®ƒå°†æŸäº›å¯å¤ç”¨ï¼Œå¯å…±äº«çš„ï¼Œå¼€é”€å¤§çš„å±æ€§å’Œæ–¹æ³•ä»çˆ¶ç±»æå–å‡ºæ¥æ”¾åœ¨åŸå‹ä¹‹ä¸­ï¼Œå­ç±»é€šè¿‡å‰æ–‡çš„æŸäº›ç»§æ‰¿æ–¹å¼æ¥ç»§æ‰¿ï¼Œç›´æ¥è·å¾—è¿™äº›å±æ€§å’Œæ–¹æ³•è€Œä¸æ˜¯æ¯æ¬¡å®ä¾‹åŒ–é‡æ–°åˆ›å»ºè¿™äº›å±æ€§å’Œæ–¹æ³•ï¼ŒèŠ‚çœäº†å¾ˆå¤šä¸å¿…è¦çš„å¼€é”€ã€‚ jsåœ¨åŸå‹æ¨¡å¼ä¸‹å®ç°çš„åŸå‹é“¾ï¼Œè®©æ‰€æœ‰å†…ç½®çš„å±æ€§å’Œæ–¹æ³•éƒ½äº«å—åˆ°è¯¥æ¨¡å¼çš„å¥½å¤„ã€‚ å…¶å®ç°æ–¹å¼å°±æ˜¯å¯¹ä¸€ä¸ªå¯¹è±¡çš„æ‹·è´ï¼Œä¹Ÿæ˜¯ä¸€ç§ç»§æ‰¿æ–¹å¼ï¼Œä½†å¾ˆç‰¹æ®Šçš„ä¸€ç‚¹ï¼Œåˆ›å»ºè¿‡ç¨‹äºå®ƒæ— ç“œï¼Œç†è§£è¿™ä¸€ç‚¹å¾ˆé‡è¦~ 5.å•ä¾‹æ¨¡å¼ï¼š singletonè¿™æ˜¯jsç¼–ç¨‹ä¸­å¾ˆå¸¸è§çš„ä¸€ç§æ¨¡å¼ï¼Œåªå…è®¸å®ä¾‹åŒ–ä¸€æ¬¡çš„å¯¹è±¡ç±»ã€‚æœ‰æ—¶ç”Ÿæˆå‘½åç©ºé—´namespaceã€‚å¤šäººåä½œå¼€å‘æˆ–è€…åŠ è½½ç‹¬ç«‹çš„ç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„è¯è¯­æ€»æ˜¯æœ‰é™çš„ï¼Œæ€ä¹ˆè®©å®ƒä»¬çš„å‘½åäº’ä¸å½±å“å‘¢ï¼Ÿç­”æ¡ˆè¯´éƒ½å¼€è¾Ÿç‹¬ç«‹çš„å‘½åç©ºé—´ï¼Œä½¿å¾—å…¶æ–¹æ³•åéƒ½å¯ä»¥åŒºåˆ†å¼€ã€‚åŒæ—¶ï¼Œå¯¹æˆ‘ä»¬åœ¨ç®¡ç†é™æ€å˜é‡ä¹Ÿéå¸¸æœ‰å¸®åŠ©ã€‚ é£é¡å¾ˆå¤šæ—¶çš„Jqueryå°±æ˜¯ç»å…¸çš„ä¾‹å­ï¼Œå…¶$ç¬¦å°±æ˜¯å‘½åç©ºé—´ï¼Œ$(&#39;className&#39;).functionè¿™æ ·çš„è°ƒç”¨æ–¹å¼ä½¿å¾—ä»£ç æ¸…æ™°æ˜äº†ï¼Œä¸€çœ‹å°±çŸ¥é“æ˜¯Jqueryçš„æ–¹æ³•ã€‚ 1234567891011let mynamespace = &#123; utils: &#123; formate: function() &#123; ..... &#125; &#125;, ajax: function() &#123; ..... &#125; MYHEIGHT: 180&#125; å…¶å®å°±æ˜¯å°è£…åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢ï¼Œå»¶å±•å¼€æ¥å°±æ˜¯æ¨¡å—æœºåˆ¶ï¼ŒæŠŠæ•´ä¸ªjsæ–‡ä»¶ä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå­˜æ”¾ä¸åŒçš„å‘½åç©ºé—´ï¼Œé¿å…æ–¹æ³•åçš„è¦†ç›–ã€‚ æ€ä¹ˆå®ç°åªèƒ½å®ä¾‹åŒ–ä¸€æ¬¡çš„å¯¹è±¡ç±»ï¼Ÿ å¦ˆè€¶ï¼Œç”¨ä¸ªé—­åŒ…è®°å½•ï¼Œå¦‚æœè¢«å®ä¾‹åŒ–äº†ï¼Œå°±returnæ‰ï¼Œeasyã€‚ ä»€ä¹ˆï¼Ÿ æ€ä¹ˆåˆ›å»ºä¸€ä¸ªé—­åŒ…ï¼Ÿï¼Ÿï¼Ÿ å»ºè®®ä½ å»çœ‹çœ‹ã€Šä½ ä¸çŸ¥é“çš„javascriptã€‹,ä¹¦ä¸­è¯¦ç»†çš„è®ºè¿°äº†é—­åŒ…æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆåˆ›å»ºé—­åŒ…ï¼Œé—­åŒ…çš„ç”¨é€”åˆæ˜¯ä»€ä¹ˆï¼Œé—­åŒ…èƒŒåçš„ä½œç”¨æœºåˆ¶å…¶å®æ˜¯ä¿æŒå¯¹ä½œç”¨åŸŸçš„å¼•ç”¨ç­‰ç­‰ã€‚ä¸‹æ¬¡æœ‰ç©ºï¼Œç»“åˆä¹¦æœ¬æˆ‘ä»¬æ¥è¯¦è§£ä¸€ä¸‹jsä¸­çš„é—­åŒ…ï¼Œè§£å¼€å…¶ç¥ç§˜çš„é¢çº±ã€‚ æ€»ç»“ åˆ›å»ºå‹è®¾è®¡æ¨¡å¼æ˜¯ä¸€äº›å¤„ç†å¯¹è±¡åˆ›å»ºçš„æ¨¡å¼ï¼Œé€šè¿‡æŸç§æ–¹å¼æ§åˆ¶å¯¹è±¡çš„åˆ›å»ºæ¥é¿å…åŸºæœ¬å¯¹è±¡åˆ›å»ºæ—¶å¯èƒ½å¯¼è‡´è®¾è®¡ä¸Šçš„é—®é¢˜æˆ–å¢åŠ è®¾è®¡ä¸Šçš„å¤æ‚åº¦ã€‚ åˆ›å»ºå•ç±»ç®€å•å¯¹è±¡çš„ç®€å•å·¥å‚æ¨¡å¼ï¼Œç®€å•çš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œäºæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼è¡¥è¶³åˆ›å»ºå¤šç±»çš„å®ä¾‹(å…¶å®æ˜¯ä¼ å…¥ä¸åŒå‚æ•°çš„ç®€å•å·¥å‚æ¨¡å¼å’Œå®‰å…¨æ¨¡å¼çš„æ··åˆ)ã€‚å»ºé€ è€…æ¨¡å¼åˆ™æ˜¯é€šè¿‡ç»„åˆå¤šç§ç®€å•å·¥å‚æ¨¡å¼ï¼Œæ¥åˆ›é€ å¤æ‚çš„å¯¹è±¡ã€‚åŸå‹æ¨¡å¼ä¹Ÿè¢«æˆä¸ºè¯­è¨€ä¹‹é­‚ï¼Œå°†æŸäº›å±æ€§å’Œæ–¹æ³•æ”¾åœ¨åŸå‹å¯¹è±¡ä¸­ä½œä¸ºæ‰€æœ‰å¯¹è±¡çš„å…±æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œé¿å…äº†å­ç±»æ¯æ¬¡å®ä¾‹åŒ–éƒ½ä¼šå¯èƒ½åˆ›å»ºæ–°çš„ä¸å¿…è¦çš„ï¼Œå¼€é”€å¤§çš„å±æ€§å’Œæ–¹æ³•ã€‚å•ä¾‹æ¨¡å¼åˆ™æ˜¯ä¸ºæˆ‘ä»¬çš„ä»£ç ç®¡ç†åšå‡ºäº†å“è¶Šçš„è´¡çŒ®ã€‚è¿™äº”ç§æ¨¡å¼ä¸­ï¼ŒåŸå‹æ¨¡å¼å¹¶ä¸å…³å¿ƒå¯¹è±¡åˆ›å»ºè¿‡ç¨‹ï¼Œä½†å¯¹åˆ›å»ºè¿‡ç¨‹åšå‡ºçš„è´¡çŒ®è¿˜æ˜¯æœ‰ç›®å…±ç¹ï¼Œæˆ–è®¸è¿™å°±æ˜¯å¤§ä½¬å§ï¼Œæ¶¦ç‰©ç»†æ— å£°~","categories":[],"tags":[{"name":"javascript-native","slug":"javascript-native","permalink":"https://tsunamigg.github.io/tags/javascript-native/"}]},{"title":"7.httpç¼“å­˜","slug":"http7","date":"2019-07-12T07:33:20.000Z","updated":"2020-06-01T14:36:56.099Z","comments":true,"path":"2019/07/12/http7/","link":"","permalink":"https://tsunamigg.github.io/2019/07/12/http7/","excerpt":"ä¸æ‰“ä¸ç›¸è¯†ä¹‹httpç¼“å­˜","text":"ä¸æ‰“ä¸ç›¸è¯†ä¹‹httpç¼“å­˜ åˆè¯†httpç¼“å­˜è¿‘æ—¥ï¼Œå‘ç°æˆ‘æ‰“åŒ…çš„jsä»£ç ä¸Šä¼ åˆ°æœåŠ¡å™¨åï¼Œå¹¶æ²¡æœ‰æ›´æ–°ã€‚æƒ³åˆ°ç”¨ngåšäº†ä»£ç†ï¼Œå¯èƒ½æ˜¯ngç¼“å­˜çš„é—®é¢˜ï¼Œå°±æŸ¥èµ„æ–™å­¦ä¹ äº†ä¸€ä¸‹httpï¼ˆ1.1ï¼‰ç¼“å­˜çš„ä¸œè¥¿ã€‚ 1.ç›¸å…³æœ¯è¯­ï¼š(çº¦å®šreqä¸ºè¯·æ±‚å¤´ï¼Œreså“åº”å¤´ï¼ŒCå®¢æˆ·ç«¯ï¼ŒSæœåŠ¡ç«¯)1234567891011// response HeadersHTTP/1.1 200 OKServer: nginxDate: Wed, 04 Dec 2019 09:11:07 GMTContent-Type: text/cssVary: Accept-EncodingLast-Modified: Wed, 04 Dec 2019 09:03:18 GMTETag: W/\"5de77656-2340\"Expires: Wed, 04 Dec 2019 21:11:06 GMTCache-Control: max-age=43200Content-Encoding: gzip Expires ï¼šresä¸­ä¸ºèµ„æºè¿‡æœŸæ—¶é—´ Last-Modifiedï¼š resä¸­ä¸ºèµ„æºæœ€è¿‘ä¿®æ”¹æ—¶é—´ ETagï¼š resä¸­èµ„æºçš„å”¯ä¸€æ ‡è¯†ç¬¦(hashç®—æ³•ç”Ÿæˆ) If-Modified-Since ï¼š reqä¸­çš„èµ„æºæœ€è¿‘ä¿®æ”¹æ—¶é—´ If-None-Match ï¼šreqä¸­çš„èµ„æºæ ‡è¯† Cache-Control ï¼š resï¼Œreqä¸­è¡¨ç¤ºç¼“å­˜ç­–ç•¥ reqä¸­å¸¸ç”¨æŒ‡ä»¤ å­—æ®µåç§° è¯´æ˜ max-age= è®¾ç½®ç¼“å­˜å­˜å‚¨çš„æœ€å¤§å‘¨æœŸï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ç¼“å­˜è¢«è®¤ä¸ºè¿‡æœŸ(å•ä½ç§’)ã€‚ä¸Expiresç›¸åï¼Œæ—¶é—´æ˜¯ç›¸å¯¹äºè¯·æ±‚çš„æ—¶é—´ max-stale[=] Cå¯æ¥æ”¶ä¸€ä¸ªå·²ç»è¿‡æœŸçš„èµ„æºã€‚è®¾ç½®ä¸€ä¸ªå¯é€‰çš„ç§’æ•°ï¼Œä¸æ¥å—è¶…è¿‡ç»™å®šæ—¶é—´çš„èµ„æº min-fresh= Cå¸Œæœ›è·å–ä¸€ä¸ªèƒ½åœ¨æŒ‡å®šçš„ç§’æ•°å†…ä¿æŒå…¶æœ€æ–°çŠ¶æ€çš„res no-cache åœ¨å‘å¸ƒç¼“å­˜å‰¯æœ¬ä¹‹å‰ï¼Œå¼ºåˆ¶è¦æ±‚ç¼“å­˜æŠŠè¯·æ±‚æäº¤ç»™åŸå§‹æœåŠ¡å™¨è¿›è¡ŒéªŒè¯ no-store ä¸ç¼“å­˜æœ‰å…³å®¢æˆ·ç«¯è¯·æ±‚æˆ–æœåŠ¡å™¨å“åº”çš„ä»»ä½•å†…å®¹ â€‹ 2. resä¸­å¸¸ç”¨æŒ‡ä»¤(reqä¸­é‡å¤çš„ä¸åˆ—ä¸¾ï¼Œè¯¦è§MDN) å­—æ®µåç§° è¯´æ˜ public è¡¨æ˜å“åº”å¯ä»¥è¢«ä»»ä½•å¯¹è±¡ï¼ˆåŒ…æ‹¬ï¼šå‘é€è¯·æ±‚çš„å®¢æˆ·ç«¯ï¼Œä»£ç†æœåŠ¡å™¨ï¼Œç­‰ç­‰ï¼‰ç¼“å­˜ï¼Œå³ä½¿æ˜¯é€šå¸¸ä¸å¯ç¼“å­˜çš„å†…å®¹ private è¡¨æ˜å“åº”åªèƒ½è¢«å•ä¸ªç”¨æˆ·ç¼“å­˜ï¼Œä¸èƒ½ä½œä¸ºå…±äº«ç¼“å­˜ï¼ˆå³ä»£ç†æœåŠ¡å™¨ä¸èƒ½ç¼“å­˜å®ƒï¼‰ã€‚ç§æœ‰ç¼“å­˜å¯ä»¥ç¼“å­˜å“åº”å†…å®¹ must-revalidate ä¸€æ—¦èµ„æºè¿‡æœŸï¼ˆæ¯”å¦‚å·²ç»è¶…è¿‡max-ageï¼‰ï¼Œåœ¨æˆåŠŸå‘åŸå§‹æœåŠ¡å™¨éªŒè¯ä¹‹å‰ï¼Œç¼“å­˜ä¸èƒ½ç”¨è¯¥èµ„æºå“åº”åç»­è¯·æ±‚ proxy-revalidate ä¸must-revalidateä½œç”¨ç›¸åŒï¼Œä½†å®ƒä»…é€‚ç”¨äºå…±äº«ç¼“å­˜ï¼ˆä¾‹å¦‚ä»£ç†ï¼‰ï¼Œå¹¶è¢«ç§æœ‰ç¼“å­˜å¿½ç•¥ s-maxage= è¦†ç›–max-ageæˆ–è€…Expireså¤´ï¼Œä½†æ˜¯ä»…é€‚ç”¨äºå…±äº«ç¼“å­˜(æ¯”å¦‚å„ä¸ªä»£ç†)ï¼Œç§æœ‰ç¼“å­˜ä¼šå¿½ç•¥å®ƒ å…¶ä¸­Last-Modifiedä¸If-Modified-Sinceï¼ŒETagä¸If-None-Matchæ˜¯åœ¨æ¯æ¬¡çš„resï¼Œreqä¸­é…å¯¹ä½¿ç”¨çš„ã€‚ 2. å¸¸è§ç¼“å­˜åœºæ™¯ï¼š(çº¦å®šèµ„æºä¸ºapp.js) Expiresï¼š è¿‡ç¨‹ Cç«¯è¯·æ±‚app.js â€”-&gt; Sç«¯ã€‚ Sç«¯å“åº”app.js ä¸Expires â€”-&gt; Cç«¯ã€‚(Cç«¯ç¼“å­˜app.jsç›´åˆ°Expires) if 1 å‘ç”Ÿåœ¨Expires å‰ï¼Œä¼šç›´æ¥ä»ç¼“å­˜ä¸­å–, else 2 é‡å¤ä»¥ä¸Š ä¼˜åŠ¿ ç›¸æ¯”äºæœ€åŸå§‹çš„ä¸å¸¦ç¼“å­˜çš„è¯·æ±‚å’Œç›¸åº”ï¼Œä¼˜åŠ¿å¾ˆæ˜æ˜¾ï¼Œä¼šç›´æ¥ä»ç¼“å­˜ä¸­å–ï¼Œå‡å°‘è¯·æ±‚å“åº”æ¬¡æ•° ç¼ºé™· å¦‚æœapp.jsåœ¨Expires å†…å‘ç”Ÿäº†æ”¹å˜ï¼ŒCç«¯å‘ˆç°çš„èµ„æºä¸æ˜¯æœ€æ–°çš„ã€‚ Expires + Last-Modifiedï¼š è¿‡ç¨‹ Cç«¯è¯·æ±‚app.js â€”-&gt; Sç«¯ Sç«¯å“åº”app.js ä¸Expires*ï¼Œ *Last-Modified â€”-&gt; Cç«¯ã€‚(Cç«¯ç¼“å­˜app.jsç›´åˆ°Expires,ä¸Šæ¬¡ä¿®æ”¹æ—¶é—´æ˜¯ Last-Modifiedï¼‰ if 1 å‘ç”Ÿåœ¨Expires å‰ï¼Œä¼šç›´æ¥ä»ç¼“å­˜ä¸­å–(200)ã€‚ else Cç«¯è¯·æ±‚Sç«¯ï¼Œå¸¦ä¸ŠIf-Modified-Sinceï¼ˆç­‰äºä¸Šä¸€æ¬¡ç›¸åº”çš„Last-Modifiedï¼‰ Sç«¯ç”¨reqä¸­çš„If-Modified-Sinceå’Œresä¸­çš„ Last-Modifiedæ¯”è¾ƒã€‚ if ä¸€è‡´ï¼Œå“åº” Cç«¯ï¼šä½ å¯ä»¥ç»§ç»­ç”¨æœ¬åœ°ç¼“å­˜(304) else,2 é‡å¤ä»¥ä¸Š ä¼˜åŠ¿ ç›¸æ¯”ä¸åªä½¿ç”¨Expiresï¼Œif app.jså‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥æ›´æ–°ç¼“å­˜ï¼ŒCç«¯å‘ˆç°å†…å®¹ä¸ºæœ€æ–°ï¼Œelse ä¸ä¼šæœ‰æ–°çš„resæ‹‰ä¸€æ¬¡èµ„æºï¼Œç›´æ¥è¯»ç¼“å­˜ ç¼ºé™· Last-Modifiedç²¾ç¡®åˆ°ç§’ï¼Œå®é™…ä¸­æœ‰å¾ˆå¤šä¸€ç§’å†…ä¼šå®Œæˆå¾ˆå¤šreqå’Œres,é—®é¢˜å‘¼ä¹‹æ¬²å‡º åœ¨ Last-Modifiedå†…ï¼Œapp.jsè¢«ä¿®æ”¹å¤šæ¬¡ï¼Œé‚£ä¹ˆCç«¯è¿˜æ˜¯ä¼šä»ç¼“å­˜ä¸­è¯»ï¼Œå‘ˆç°å†…å®¹ä¸æ˜¯æœ€æ–° å‡è®¾å¤„äºvue-cliå¼€å‘ä¸‹ï¼Œå› ä¸ºæŸç§åŸå› ï¼Œä»£ç å®é™…æ²¡æœ‰ä¿®æ”¹ï¼Œä½†CI/CDé‡å¤æ„å»ºæ‰“åŒ…äº†æ–‡ä»¶,app.jså˜ä¸ºäº†app01.js(build.jsç”Ÿæˆçš„ä¸åŒç‰ˆæœ¬hashåç§°)ï¼Œä½†ä»£ç åªæ˜¯åç§°å˜åŒ–ï¼Œå†…å®¹å¹¶ä¸å˜åŒ–ï¼Œå´é‡æ–°æ‹‰äº†ä¸€æ¬¡èµ„æº Expires + Last-Modified + ETagï¼š è¿‡ç¨‹ Cç«¯è¯·æ±‚app.js â€”-&gt; Sç«¯ Sç«¯å“åº”app.js ä¸Expires*ï¼Œ *Last-Modified ,ETagâ€”-&gt; Cç«¯ã€‚(Cç«¯ç¼“å­˜app.jsç›´åˆ°Expires,ä¸Šæ¬¡ä¿®æ”¹æ—¶é—´æ˜¯ Last-Modified,æ–‡ä»¶æ ‡è¯†æ˜¯ETagï¼‰ if 1 å‘ç”Ÿåœ¨Expires å‰ï¼Œä¼šç›´æ¥ä»ç¼“å­˜ä¸­å–(200)ã€‚ else Cç«¯è¯·æ±‚Sç«¯ï¼Œå¸¦ä¸ŠIf-Modified-Sinceï¼ˆç­‰äºä¸Šä¸€æ¬¡ç›¸åº”çš„Last-Modifiedï¼‰å’ŒIf-None-Matchï¼ˆç­‰äºä¸Šä¸€æ¬¡ç›¸åº”çš„Etagï¼‰ Sç«¯ç”¨reqä¸­çš„If-None-Matchå’Œresä¸­çš„ Etagæ¯”è¾ƒï¼Œå¿½ç•¥æ‰If-Modified-Sinceå’ŒLast-Modifiedçš„æ¯”è¾ƒã€‚(å¦‚æœEtagå˜åŒ–ï¼ŒLast-Modifiedä¸€å®šå˜åŒ–ï¼Œå……åˆ†æ¡ä»¶) if ä¸€è‡´ï¼Œå“åº” Cç«¯ï¼šä½ å¯ä»¥ç»§ç»­ç”¨æœ¬åœ°ç¼“å­˜(304) else,2 é‡å¤ä»¥ä¸Š ä¼˜åŠ¿ ç›¸è¾ƒäºä¸Šä¸€ç§ï¼Œä½¿å¾—èµ„æºå˜æ›´çš„éªŒè¯æ›´åŠ ä¸¥æ ¼ã€‚ ç¼ºé™· è®©æˆ‘ä»¬è®¾æƒ³è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬é¢‘ç¹çš„ä¿®æ”¹app.jsï¼Œæ‰“åŒ…æ„å»ºï¼Œå¤„äºæŸç§åŸå› ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³Cç«¯å‘ˆç°æœ€æ–°çš„app.jsï¼Œè€Œæ˜¯ä¸€æ®µæ—¶é—´åå†è¯»å–æœ€æ–°çš„ï¼Œæ˜¾ç„¶è¿˜è¾¾ä¸åˆ°æˆ‘ä»¬çš„è¦æ±‚ Expires + Last-Modified + ETag + Cache-Control ï¼š è¿‡ç¨‹ Cç«¯è¯·æ±‚app.js â€”-&gt; Sç«¯ Sç«¯å“åº”app.js ä¸Expires*ï¼Œ *Last-Modified ,ETagï¼Œ *Cache-Controlï¼šmax-age=43200 â€”-&gt; Cç«¯ã€‚(Cç«¯å‘ç°å¸¦æœ‰ Cache-Controlï¼šmax-age=43200,å¿½ç•¥Expiresï¼Œè®°ä½Last-Modified ,ETagï¼‰ if 1 å‘ç”Ÿåœ¨ï¼ˆreqå‘ç”Ÿçš„æ—¶é—´+ 12h(43200s)ï¼‰ï¼Œä¼šç›´æ¥ä»ç¼“å­˜ä¸­å–(200)ã€‚ else Cç«¯è¯·æ±‚Sç«¯ï¼Œå¸¦ä¸ŠIf-Modified-Sinceï¼ˆç­‰äºä¸Šä¸€æ¬¡ç›¸åº”çš„Last-Modifiedï¼‰å’ŒIf-None-Matchï¼ˆç­‰äºä¸Šä¸€æ¬¡ç›¸åº”çš„Etagï¼‰ Sç«¯ç”¨reqä¸­çš„If-None-Matchå’Œresä¸­çš„ Etagæ¯”è¾ƒï¼Œå¿½ç•¥æ‰If-Modified-Sinceå’ŒLast-Modifiedçš„æ¯”è¾ƒã€‚(å¦‚æœEtagå˜åŒ–ï¼ŒLast-Modifiedä¸€å®šå˜åŒ–ï¼Œå……åˆ†æ¡ä»¶) if ä¸€è‡´ï¼Œå“åº” Cç«¯ï¼šä½ å¯ä»¥ç»§ç»­ç”¨æœ¬åœ°ç¼“å­˜(304) else,2 é‡å¤ä»¥ä¸Š ä¼˜åŠ¿ è¾¾åˆ°äº†æˆ‘ä»¬ä¸Šä¸ªæ–¹æ¡ˆè¾¾ä¸åˆ°çš„æ•ˆæœ ç¼ºé™·ï¼Ÿ Cç«¯æ— æ³•ä¸»åŠ¨çŸ¥é“Sç«¯ä¸Šæˆ‘ä»¬è¯·æ±‚çš„èµ„æºå˜åŒ–ï¼Œåªèƒ½è¢«åŠ¨çš„ä»resä¸­å¾—çŸ¥ï¼Œè¿™ç®—ç¼ºé™·å—ï¼Ÿæˆ‘æ›´å¤šçš„è®¤ä¸ºæ˜¯åŸºäºæŸç§å®‰å…¨ç­–ç•¥ï¼Œæ‰€ä»¥è¿™æ ·è§„å®šã€‚ 3. å¸¸è§é—®é¢˜ï¼š(çº¦å®šèµ„æºä¸ºapp.js) å¦‚ä½•è®¾ç½®ä¸ç¼“å­˜ï¼Ÿ ngé…ç½®å¦‚ä¸‹ï¼š 12345678910111213// è¿˜æœ‰å¤šç§è®¾ç½®æ–¹æ³•ï¼Œä¸¾ä¾‹ä¸€ç§// é‡å¯ngä¸ä¸€å®šç«‹å³ç”Ÿæ•ˆlocation / &#123; access_log /data/nginx/log/xxx.log api; root /home/www/html; if ($request_filename ~ .*\\.(htm|html)$) &#123; add_header Cache-Control no-cache; &#125;&#125; æ‰“åŒ…htmlè®¾ç½®metaæ ‡ç­¾å¦‚ä¸‹ 123&lt;meta http-equiv=\"Cache-Control\" content=\"no-cache, no-store, must-revalidate\" /&gt;&lt;meta http-equiv=\"Pragma\" content=\"no-cache\" /&gt;&lt;meta http-equiv=\"Expires\" content=\"0\" /&gt; metaæ˜¯ç”¨æ¥åœ¨HTMLæ–‡æ¡£ä¸­æ¨¡æ‹ŸHTTPåè®®çš„å“åº”å¤´æŠ¥æ–‡ã€‚meta æ ‡ç­¾ç”¨äºç½‘é¡µçš„ä¸ä¸­ï¼Œmeta æ ‡ç­¾çš„ç”¨å¤„å¾ˆå¤šã€‚meta çš„å±æ€§æœ‰ä¸¤ç§ï¼šnameå’Œhttp-equivã€‚nameå±æ€§ä¸»è¦ç”¨äºæè¿°ç½‘é¡µï¼Œå¯¹åº”äºcontentï¼ˆç½‘é¡µå†…å®¹ï¼‰ï¼Œä»¥ä¾¿äºæœç´¢å¼•æ“æœºå™¨äººæŸ¥æ‰¾ã€åˆ†ç±»ï¼ˆç›®å‰å‡ ä¹æ‰€æœ‰çš„æœç´¢å¼•æ“éƒ½ä½¿ç”¨ç½‘ä¸Šæœºå™¨äººè‡ªåŠ¨æŸ¥æ‰¾metaå€¼æ¥ç»™ç½‘é¡µåˆ†ç±»ï¼‰ã€‚è¿™å…¶ä¸­æœ€é‡è¦çš„æ˜¯descriptionï¼ˆç«™ç‚¹åœ¨æœç´¢å¼•æ“ä¸Šçš„æè¿°ï¼‰å’Œkeywordsï¼ˆåˆ†ç±»å…³é”®è¯ï¼‰ï¼Œæ‰€ä»¥åº”è¯¥ç»™æ¯é¡µåŠ ä¸€ä¸ªmetaå€¼ã€‚ å¦‚ä½•æ¸…ç†ç¼“å­˜ï¼Ÿ Nginxä¼ä¸šç‰ˆæä¾›äº†purgeråŠŸèƒ½ï¼Œå¯¹äºç¤¾åŒºç‰ˆNginxå¯ä»¥è€ƒè™‘ä½¿ç”¨ngx_cache_purge`ï¼ˆhttps://github.com/FRiCKLE/ngx_cache_purgeï¼‰æ¨¡å—è¿›è¡Œæ¸…ç†ç¼“å­˜ã€‚ï¼ˆè¯¥æ–¹æ³•æœ€å¥½é™åˆ¶å…¶è®¿é—®æƒé™ï¼Œå¦‚åªå…è®¸å†…ç½‘å¯ä»¥è®¿é—®æˆ–è€…éœ€è¦å¯†ç æ‰èƒ½è®¿é—®ï¼‰ 123456789location ~ /purge(/.*) &#123; allow 127.0.0.1; deny all; proxy_cache_purge cache$1$is_args$args; &#125; PSï¼š ç±»ä¼¼å®å¡”é¢æ¿è¿™ç§Ngéƒ½è‡ªåŠ¨å®‰è£…äº†ngx_cache_purgeæ¨¡å—ï¼Œå¦‚ä½•è®¾ç½®è¯¦è§ä¸‹æ–¹å‚è€ƒã€‚ æ‰¾åˆ°ç¼“å­˜æ–‡ä»¶å¤¹ï¼Œç›´æ¥killã€‚ å¦‚æœå‘ç”Ÿç¼“å­˜é”™è¯¯ï¼Œæ£€æŸ¥çš„æ­¥éª¤ï¼Ÿ æ£€æŸ¥æ˜¯å¦ä¼ é”™æ–‡ä»¶å¤¹ æ‰“å¼€é¡¹ç›®æ‰“åŒ…åçš„jsï¼Œæ£€æŸ¥app.jsæ–‡ä»¶åã€‚ æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°Network,å‹¾é€‰js,F5åˆ·æ–°åæ‰¾åˆ°å¯¹åº”çš„app.xxx.jsï¼Œæ¯”è¾ƒã€‚å¦‚æœä½ å‘ç°åç§°ä¸ä¸€æ ·ï¼Œè€Œä¸”reså¤´éƒ¨ Last-Modifiedä¹Ÿä¸å¯¹ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡ä½ ä¼ é”™æ–‡ä»¶å¤¹äº†ã€‚ æ£€æŸ¥æ˜¯å¦æ­£ç¡®æ›´æ–° è®°å½•ç°é˜¶æ®µ ETag é‡æ–°ä¸Šä¼ ååˆ·æ–°ï¼Œæ¯”è¾ƒä¸¤æ¬¡ ETagæ˜¯å¦ä¸€è‡´ æ£€æŸ¥æ˜¯å¦æ­£ç¡®é…ç½®ngç­‰Server æ¢³ç†æ„å»ºéƒ¨ç½²æ­¥éª¤ï¼Œé€æ­¥æ£€æŸ¥(åªèƒ½å¸®ä½ åˆ°è¿™å•¦) åªæ˜¯httpï¼ˆ1.1ï¼‰çš„éƒ¨åˆ†å¸¸è§åœºæ™¯ï¼Œç›®å‰åˆ°è¿™é‡Œå·²ç»è¶³å¤Ÿï¼Œå’±å¾—ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œåˆ‡å‹¿å›«å›µåæ£~ æ€è€ƒæœ‰é™ï¼Œéš¾å…å‡ºç°ç–æ¼ï¼Œæ¬¢è¿è¯¸ä½æŒ‡å‡ºï¼Œé›†æ€å¹¿ç›Šã€‚ reference ã€Šé¢è¯•ç²¾é€‰ä¹‹httpç¼“å­˜ã€‹ https://juejin.im/post/5b3c87386fb9a04f9a5cb037#heading-2 ã€ŠMDN - Cache-Controlã€‹https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control ã€Šæµ…è°ˆhttpä¸­çš„Cache-Controlã€‹https://blog.csdn.net/u012375924/article/details/82806617 ã€ŠNginxç¼“å­˜é…ç½®åŠnginx ngx_cache_purgeæ¨¡å—çš„ä½¿ç”¨ã€‹https://www.cnblogs.com/Eivll0m/p/4921829.html","categories":[],"tags":[{"name":"http","slug":"http","permalink":"https://tsunamigg.github.io/tags/http/"}]},{"title":"6.httpæ ¸å¿ƒ","slug":"http6","date":"2019-06-29T11:13:20.000Z","updated":"2020-06-01T14:38:49.164Z","comments":true,"path":"2019/06/29/http6/","link":"","permalink":"https://tsunamigg.github.io/2019/06/29/http6/","excerpt":"httpæŠ¥æ–‡æ˜¯å¥ å®šå…¶æˆä¸ºåº”ç”¨å±‚å¤§å“¥çš„æ ¸å¿ƒï¼Œæ•æˆ‘HTTPç›´è¨€ï¼Œåœ¨åº§çš„åº”ç”¨å±‚åè®®éƒ½æ˜¯è¾£é¸¡~","text":"httpæŠ¥æ–‡æ˜¯å¥ å®šå…¶æˆä¸ºåº”ç”¨å±‚å¤§å“¥çš„æ ¸å¿ƒï¼Œæ•æˆ‘HTTPç›´è¨€ï¼Œåœ¨åº§çš„åº”ç”¨å±‚åè®®éƒ½æ˜¯è¾£é¸¡~ HTTPçš„æ ¸å¿ƒåŸºäºå‰é¢çš„åŸºç¡€çŸ¥è¯†å¤ä¹ ï¼Œæˆ‘å‘ç°æ‰€è°“çš„HTTPåè®®å…¶å®â€œåä¸å‰¯å®â€ã€‚ å› ä¸ºå®ƒå‹æ ¹å„¿ä¸ç®¡â€ä¼ è¾“â€œçš„è¿‡ç¨‹ï¼Œè¿™éƒ¨åˆ†çš„å·¥ä½œè¢«TCP/IPè€å“¥ä»»åŠ³ä»»æ€¨çš„å¹²äº†ã€‚å…¶å·¥ä½œæ¨¡å¼å¾ˆç®€å•ï¼Œâ€œè¯·æ±‚ - åº”ç­”â€ï¼Œä½†å…¶å°±å¼ºåœ¨ç®€å•ï¼Œå¥ å®šäº†ç°ä»£webä¸€å“¥çš„åœ°ä½ã€‚ é‚£ä¹ˆå®ƒçš„æ ¸å¿ƒå†…å®¹ï¼Œæ˜¯é‚£äº›è¢«ä¼ è¾“çš„å†…å®¹ï¼šhttpæŠ¥æ–‡ã€‚ HTTP åè®®åœ¨è§„èŒƒæ–‡æ¡£é‡Œè¯¦ç»†å®šä¹‰äº†æŠ¥æ–‡çš„æ ¼å¼ï¼Œè§„å®šäº†ç»„æˆéƒ¨åˆ†ï¼Œè§£æè§„åˆ™ï¼Œè¿˜æœ‰å¤„ç†ç­–ç•¥ã€‚ æ‰€ä»¥å¯ä»¥åœ¨ TCP/IP å±‚ä¹‹ä¸Šå®ç°æ›´çµæ´»ä¸°å¯Œçš„åŠŸèƒ½ï¼Œä¾‹å¦‚è¿æ¥æ§åˆ¶ï¼Œç¼“å­˜ç®¡ç†ã€æ•°æ®ç¼–ç ã€å†…å®¹åå•†ç­‰ç­‰ã€‚ æŠ¥æ–‡ç»“æ„å’ŒTCP/UDPä¸€æ ·ï¼Œéƒ½éœ€è¦åœ¨å®é™…ä¼ è¾“çš„æ•°æ®å‰åŠ ä¸€äº›â€œæ–™â€(é™„åŠ å¤´æ•°æ®)ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªâ€œçº¯æ–‡æœ¬â€çš„åè®®ï¼Œæ‰€ä»¥å¤´æ•°æ®éƒ½æ˜¯ ASCII ç çš„æ–‡æœ¬ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨è‚‰çœ¼é˜…è¯»ï¼Œä¸ç”¨å€ŸåŠ©ç¨‹åºè§£æä¹Ÿèƒ½å¤Ÿçœ‹æ‡‚ã€‚ å¾ˆå¸¸è§çš„ä¸€ä¸ªæµè§ˆå™¨ä¼˜åŒ–è¿‡çš„è¯·æ±‚å¤´ä¾‹å­ï¼š 1234567891011121314151617GeneralRequest URL: https://blog.csdn.net/weixin_44163780/article/uvc/90693902Request Method: GETStatus Code: 200 Remote Address: 127.0.0.1:7890Referrer Policy: unsafe-urlResponse HeadersAccess-Control-Allow-Origin: *cache-control: no-cacheContent-Security-Policy: script-src 'self' 'sha256-nl+LCdUZCsURbeBC1buBlAcvBhCD2/SswpeCH2ZaR34=' 'sha256-nuF8drPPKUM4+b3urtYHupidizytc1BonZF1t/vSzs0'; object-src 'self';Content-Type: text/cssETag: \"7UTBv1mKEz8B8cXsi14YOLWk94U=\"Request HeadersReferer: https://blog.csdn.net/weixin_44163780/article/details/90693902User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36Bodybody&gt;div#blockbyte-bs-indicator&gt;div&#123;opacity:0;pointer-events:none&#125;body&gt;iframe#blockbyte-bs-sidebar.blockbyte-bs-visible,body&gt;iframe#blockbyte-bs-overlay.blockbyte-bs-visible&#123;opacity:1;pointer-events:auto&#125;body.blockbyte-bs-noscroll&#123;overflow:hidden !important&#125;body&gt;div#blockbyte-bs-indicator&gt;div&#123;position:absolute;transform:translate3d(-\"%indicatorWidth\", 0, 0);top:0;left:0;width:\"%indicatorWidth\" !important;height:100%;background:\"%indicatorColor\";border-radius:0 10px 10px 0;transition:opacity 0.3s, transform 0.3s;z-index:2&#125;body&gt;div#blockbyte-bs-indicator&gt;div&gt;span&#123;-webkit-mask:no-repeat center/\"%indicatorIconSize\";-webkit-mask-image:url(chrome-extension://jdbnofccmhefkmjbkkdkfiicjkgofkdh/img/icon-bookmark.svg);background-color:\"%indicatorIconColor\";position:absolute;display:block;top:0;left:0;width:100%;height:100%&#125;body&gt;div#blockbyte-bs-indicator[data-pos='right']&#123;left:auto;right:0&#125;body&gt;div#blockbyte-bs-indicator[data-pos='right']&gt;div&#123;transform:translate3d(\"%indicatorWidth\", 0, 0);left:auto;right:0;border-radius:10px 0 0 10px&#125;body&gt;div#blockbyte-bs-indicator.blockbyte-bs-fullHeight&gt;div&#123;border-radius:0&#125;body&gt;div#blockbyte-bs-indicator.blockbyte-bs-hover&gt;div&#123;transform:translate3d(0, 0, 0);opacity:1&#125;body&gt;div#blockbyte-bs-indicator[data-pos='left'].blockbyte-bs-has-lsb&#123;height:100% !important;top:0 !important&#125;body&gt;div#blockbyte-bs-indicator[data-pos='left'].blockbyte-bs-has-lsb&gt;div&#123;background:transparent&#125;body&gt;div#blockbyte-bs-indicator[data-pos='left'].blockbyte-bs-has-lsb&gt;div&gt;span&#123;-webkit-mask-position-y:20px&#125;body&gt;iframe#blockbyte-bs-sidebar&#123;width:\"%sidebarWidth\";max-width:none;height:0;z-index:2147483646;background-color:\"%sidebarMaskColor\" !important;border:none;display:block !important;transform:translate3d(-\"%sidebarWidth\", 0, 0);transition:width 0s 0.3s, height 0s 0.3s, opacity 0.3s, transform 0.3s&#125;body&gt;iframe#blockbyte-bs-sidebar[data-pos='right']&#123;left:auto;right:0;transform:translate3d(\"%sidebarWidth\", 0, 0)&#125;body&gt;iframe#blockbyte-bs-sidebar.blockbyte-bs-visible&#123;width:calc(100% + %sidebarWidth);height:100%;transform:translate3d(0, 0, 0);transition:opacity 0.3s, transform 0.3s&#125;body&gt;iframe#blockbyte-bs-sidebar.blockbyte-bs-hideMask&#123;background:none !important&#125;body&gt;iframe#blockbyte-bs-sidebar.blockbyte-bs-hideMask:not(.blockbyte-bs-hover)&#123;width:calc(%sidebarWidth + 50px)&#125;body&gt;iframe#blockbyte-bs-overlay&#123;width:100%;max-width:none;height:100%;z-index:2147483647;border:none;background:\"%overlayMaskColor\" !important;transition:opacity 0.3s&#125; HTTP åè®®çš„è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡çš„ç»“æ„åŸºæœ¬ç›¸åŒï¼Œç”±ä¸‰å¤§éƒ¨åˆ†ç»„æˆï¼š èµ·å§‹è¡Œ(start line): æè¿°è¯·æ±‚æˆ–ç›¸åº”çš„åŸºæœ¬ä¿¡æ¯ï¼› å¤´éƒ¨å­—æ®µé›†åˆï¼ˆheaderï¼‰ï¼šä½¿ç”¨ key-value å½¢å¼æ›´è¯¦ç»†åœ°è¯´æ˜æŠ¥æ–‡ï¼› æ¶ˆæ¯æ­£æ–‡ï¼ˆbody/entityï¼‰ï¼šå®é™…ä¼ è¾“çš„æ•°æ®ï¼Œå®ƒä¸ä¸€å®šæ˜¯çº¯æ–‡æœ¬ï¼Œå¯ä»¥æ˜¯å›¾ç‰‡ã€è§†é¢‘ç­‰äºŒè¿›åˆ¶æ•°æ®ã€‚ è¿™å…¶ä¸­å‰ä¸¤éƒ¨åˆ†èµ·å§‹è¡Œå’Œå¤´éƒ¨å­—æ®µç»å¸¸åˆåˆç§°ä¸ºâ€œè¯·æ±‚å¤´â€æˆ–â€œå“åº”å¤´â€ï¼Œæ¶ˆæ¯æ­£æ–‡åˆç§°ä¸ºâ€œå®ä½“â€ï¼Œä½†ä¸â€œheaderâ€å¯¹åº”ï¼Œå¾ˆå¤šæ—¶å€™å°±ç›´æ¥ç§°ä¸ºâ€œbodyâ€ã€‚ HTTP åè®®è§„å®šæŠ¥æ–‡å¿…é¡»æœ‰ headerï¼Œä½†å¯ä»¥æ²¡æœ‰ bodyï¼Œè€Œä¸”åœ¨ header ä¹‹åå¿…é¡»è¦æœ‰ä¸€ä¸ªâ€œç©ºè¡Œâ€ï¼Œä¹Ÿå°±æ˜¯â€œCRLFâ€ï¼Œåå…­è¿›åˆ¶çš„â€œ0D0Aâ€ã€‚ ä¸€ä¸ªçœŸæ­£çš„æŠ¥æ–‡ = start line + header + CRLF(ç©ºè¡Œ) + (body/entity) ç”±äºâ€œå¿«é€’å¼â€çš„åŒ…è£…ï¼Œæ‹†åŒ…è£…çš„å·¥ä½œæ–¹å¼ï¼Œæˆ‘ä»¬åœ¨TCP/IPä¸Šä¼ è¾“äº†å¤ªå¤šå¯¹äºçœŸå®æ•°æ®æ— ç”¨çš„ä¿¡æ¯ï¼Œheaderé‡Œé¢å„ç§tokenï¼ŒcookieéªŒè¯çš„ä¸€å¤§å †å­—ç¬¦ä¸²æ³›æ»¥ã€‚TCP/IPè€å“¥ï¼Œæˆ‘å¤ªéš¾äº†â€¦ ä½¿ç”¨ABNF(æ‰©å……å·´ç§‘æ–¯-ç‘™å°”èŒƒå¼)æè¿°HTTPæŠ¥æ–‡ä¸Šé¢æåˆ°æŠ¥æ–‡çš„ç»“æ„ï¼Œé‚£ä¹ˆæ€ä¹ˆç§‘å­¦ä¸¥è°¨çš„æè¿°å®ƒï¼Œå°±è¦ä½¿ç”¨ABNFäº†ã€‚ èŒƒå¼ä¸¤ä¸ªå­—æ˜¯ä¸æ˜¯å›æƒ³èµ·å¤§å­¦æ—¶é—´è€å¸ˆæ•™SQLæ•°æ®åº“æ—¶çš„èŒƒå¼ å·´ç§‘æ–¯èŒƒå¼çš„è‹±æ–‡ç¼©å†™ä¸ºBNF,å®ƒæ˜¯ä»¥ç¾å›½äººå·´ç§‘æ–¯ï¼ˆBackusï¼‰å’Œä¸¹éº¦äººï¼ˆNaurï¼‰çš„åå­—å‘½åçš„ä¸€ç§å½¢å¼åŒ–çš„è¯­æ³•è¡¨ç¤ºæ–¹æ³•ï¼Œç”¨æ¥æè¿°è¯­æ³•çš„ä¸€ç§å½¢å¼ä½“ç³»ï¼Œæ˜¯ä¸€ç§å…¸å‹çš„å…ƒè¯­è¨€ã€‚åˆç§°å·´ç§‘æ–¯-è¯ºå°”å½¢å¼ï¼ˆBackus-Naur formï¼‰ã€‚å®ƒä¸ä»…èƒ½ä¸¥æ ¼çš„è¡¨ç¤ºè¯­æ³•è§„åˆ™ï¼Œè€Œä¸”æ‰€æè¿°çš„è¯­æ³•ä¸ä¸Šä¸‹æ–‡æ— å…³çš„ã€‚å®ƒå…·æœ‰è¯­æ³•ç®€å•ï¼Œè¡¨ç¤ºæ˜ç¡®ï¼Œä¾¿äºè¯­æ³•åˆ†æå’Œç¼–è¯‘çš„ç‰¹ç‚¹ã€‚ ABNFè§„åˆ™ç©ºç™½å­—ç¬¦( SP )ï¼šç”¨æ¥åˆ†éš”å®šä¹‰ä¸­çš„å„ä¸ªå…ƒç´  method SP request-target SP HTTP-version CRLF é€‰æ‹©ï¼ˆ / ï¼‰ï¼šè¡¨ç¤ºå¤šä¸ªè§„åˆ™éƒ½æ˜¯å¯ä¾›é€‰æ‹©çš„è§„åˆ™ start-line=request-line / status-line å€¼èŒƒå›´ ï¼ˆ %c##-## ï¼‰ï¼š OCTAL=â€0â€ / â€œ1â€ / â€œ2â€ / â€œ3â€ / â€œ4â€ / â€œ5â€ / â€6â€œ / â€7â€œ ä¸ OCTAL=%x30-37 ç­‰ä»· åºåˆ—ç»„åˆï¼ˆï¼‰:å°†è§„åˆ™ç»„åˆèµ·æ¥ï¼Œè§†ä¸ºå•ä¸ªå…ƒç´  ä¸å®šé‡é‡å¤ ï¼ˆ m*n ï¼‰ï¼š * å…ƒç´ è¡¨ç¤ºé›¶ä¸ªæˆ–æ›´å¤šå…ƒç´ ï¼š*ï¼ˆheader-field CRLFï¼‰ 1* å…ƒç´ è¡¨ç¤ºä¸€ä¸ªæˆ–æ›´å¤šå…ƒç´ ï¼Œ2*4 å…ƒç´ è¡¨ç¤ºä¸¤ä¸ªè‡³å››ä¸ªå…ƒç´  å¯é€‰åºåˆ—ï¼ˆ [] ï¼‰ï¼š [ message-body ] è§„åˆ™ å½¢å¼å®šä¹‰ æ„ä¹‰ ALPHA %x41-5A / %x61-7A å¤§å°å†™å­—æ¯ï¼ˆA-zï¼‰ DIGIT %x30-39 æ•°å­—ï¼ˆ0-9ï¼‰ HEXDIG DIGIT/â€œAâ€/â€œBâ€/â€œCâ€/â€œDâ€/â€œEâ€/â€œFâ€ åå…­è¿›åˆ¶æ•°(0-9,A-F,a-f) DQUOTE %x22 åŒå¼•å· SP %x20 ç©ºæ ¼ HTAB %x09 æ¨ªå‘åˆ¶è¡¨ç¬¦ WSP SP/HTAB ç©ºæ ¼æˆ–æ¨ªå‘åˆ¶è¡¨ç¬¦ LWSP *(WSP/CRLF WSP) ç›´çº¿ç©ºç™½ VCHAR %x21-7E å¯è§å­—ç¬¦ CHAR %x01-7F ä»»ä½•7-ä½US-ASCIIå­—ç¬¦ï¼Œä¸åŒ…æ‹¬NUL OCTET %x00-FF 8ä½æ•°æ® CTL %x00-1F/%x7F ç©ºå€¼å­—ç¬¦ CR %x0D å›è½¦ ï¼ˆmacï¼‰ LF %x0A æ¢è¡Œ ï¼ˆLinuxï¼‰ CRLF CR LF æ ‡å‡†æ¢è¡Œï¼ˆwindowsï¼‰ BIT â€œ0â€/â€œ1â€ äºŒè¿›åˆ¶æ•°å­— ABNFè¡¨ç¤ºHTTP-message=start-line ( *header-filed** CRLF ) CRLF [ message-body ] start-line= request-line / status-line â€‹ request-line= method SP resquest-status SP HTTP-version CRLF â€‹ status-line= HTTP-version SP status-code SP reason-phrase CRLF header-filed= field-name â€œ:â€ OWS field-value OWS â€‹ OWS= *(SP / HTAB) â€‹ field-name = token â€‹ field-value = *(field-content / obs-fold ) *message-body *= *OCTET ç¤ºä¾‹ï¼š 123456789101112131415161718192021# curl -I www.baidu.com&#x2F;&#x2F; è¾“å‡ºHTTP&#x2F;1.1 200 OKAccept-Ranges: bytesCache-Control: private, no-cache, no-store, proxy-revalidate, no-transformConnection: keep-aliveContent-Length: 277Content-Type: text&#x2F;htmlDate: Fri, 29 May 2020 04:55:28 GMTEtag: &quot;575e1f71-115&quot;Last-Modified: Mon, 13 Jun 2016 02:50:25 GMTPragma: no-cacheServer: bfe&#x2F;1.0.8.18&#x2F;&#x2F; çŠ¶æ€è¡Œç¤ºä¾‹status-line&#x3D; HTTP-version SP status-code SP reason-phrase CRLFHTTP&#x2F;1.1 200 OKHTTP&#x2F;1.1 400 Bad Request................ å¯è§ç”¨è¿™ç§å…ƒè¯­è¨€æ¥æè¿°HTTPçš„æ¶ˆæ¯å¾ˆæ–¹ä¾¿ï¼Œè™½ç„¶æœ‰ä¸€äº›è§„å®šçš„ç†è§£æˆæœ¬ï¼Œä½†æœ‰äº†çº¦æŸä¼šç†è§£çš„æ›´åŠ æ¸…æ™°ã€‚ å¸¸ç”¨å¤´å­—æ®µHTTP åè®®è§„å®šäº†éå¸¸å¤šçš„å¤´éƒ¨å­—æ®µï¼Œå®ç°å„ç§å„æ ·çš„åŠŸèƒ½ï¼Œä½†åŸºæœ¬ä¸Šå¯ä»¥åˆ†ä¸ºå››å¤§ç±»ï¼š é€šç”¨å­—æ®µï¼šåœ¨è¯·æ±‚å¤´å’Œå“åº”å¤´é‡Œéƒ½å¯ä»¥å‡ºç°ï¼› è¯·æ±‚å­—æ®µï¼šä»…èƒ½å‡ºç°åœ¨è¯·æ±‚å¤´é‡Œï¼Œè¿›ä¸€æ­¥è¯´æ˜è¯·æ±‚ä¿¡æ¯æˆ–è€…é¢å¤–çš„é™„åŠ æ¡ä»¶ï¼› å“åº”å­—æ®µï¼šä»…èƒ½å‡ºç°åœ¨å“åº”å¤´é‡Œï¼Œè¡¥å……è¯´æ˜å“åº”æŠ¥æ–‡çš„ä¿¡æ¯ï¼› å®ä½“å­—æ®µï¼šå®ƒå®é™…ä¸Šå±äºé€šç”¨å­—æ®µï¼Œä½†ä¸“é—¨æè¿° body çš„é¢å¤–ä¿¡æ¯ã€‚ 1.Hostï¼š å®ƒå±äºè¯·æ±‚å­—æ®µï¼Œåªèƒ½å‡ºç°åœ¨è¯·æ±‚å¤´é‡Œï¼Œå®ƒåŒæ—¶ä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ª HTTP/1.1 è§„èŒƒé‡Œè¦æ±‚å¿…é¡»å‡ºç°çš„å­—æ®µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¯·æ±‚å¤´é‡Œæ²¡æœ‰ Hostï¼Œé‚£è¿™å°±æ˜¯ä¸€ä¸ªé”™è¯¯çš„æŠ¥æ–‡ 2.User-Agentï¼š æ˜¯è¯·æ±‚å­—æ®µï¼Œåªå‡ºç°åœ¨è¯·æ±‚å¤´é‡Œã€‚å®ƒä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²æ¥æè¿°å‘èµ· HTTP è¯·æ±‚çš„å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨å¯ä»¥ä¾æ®å®ƒæ¥è¿”å›æœ€åˆé€‚æ­¤æµè§ˆå™¨æ˜¾ç¤ºçš„é¡µé¢ã€‚ ä½†ç”±äºå†å²çš„åŸå› ï¼ŒUser-Agent éå¸¸æ··ä¹±ï¼Œæ¯ä¸ªæµè§ˆå™¨éƒ½è‡ªç§°æ˜¯â€œMozillaâ€â€œChromeâ€â€œSafariâ€ï¼Œä¼å›¾ä½¿ç”¨è¿™ä¸ªå­—æ®µæ¥äº’ç›¸â€œä¼ªè£…â€ï¼Œå¯¼è‡´ User-Agent å˜å¾—è¶Šæ¥è¶Šé•¿ï¼Œæœ€ç»ˆå˜å¾—æ¯«æ— æ„ä¹‰ã€‚ ä¸è¿‡æœ‰çš„æ¯”è¾ƒâ€œè¯šå®â€çš„çˆ¬è™«ä¼šåœ¨ User-Agent é‡Œç”¨â€œspiderâ€æ ‡æ˜è‡ªå·±æ˜¯çˆ¬è™«ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªå­—æ®µå®ç°ç®€å•çš„åçˆ¬è™«ç­–ç•¥ 3.Dateï¼š å­—æ®µæ˜¯ä¸€ä¸ªé€šç”¨å­—æ®µï¼Œä½†é€šå¸¸å‡ºç°åœ¨å“åº”å¤´é‡Œï¼Œè¡¨ç¤º HTTP æŠ¥æ–‡åˆ›å»ºçš„æ—¶é—´ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ—¶é—´å†æ­é…å…¶ä»–å­—æ®µå†³å®šç¼“å­˜ç­–ç•¥ 4.Serverï¼š æ˜¯å“åº”å­—æ®µï¼Œåªèƒ½å‡ºç°åœ¨å“åº”å¤´é‡Œã€‚å®ƒå‘Šè¯‰å®¢æˆ·ç«¯å½“å‰æ­£åœ¨æä¾› Web æœåŠ¡çš„è½¯ä»¶åç§°å’Œç‰ˆæœ¬å·ã€‚ Server å­—æ®µä¹Ÿä¸æ˜¯å¿…é¡»è¦å‡ºç°çš„ï¼Œå› ä¸ºè¿™ä¼šæŠŠæœåŠ¡å™¨çš„ä¸€éƒ¨åˆ†ä¿¡æ¯æš´éœ²ç»™å¤–ç•Œï¼Œå¦‚æœè¿™ä¸ªç‰ˆæœ¬æ°å¥½å­˜åœ¨ bugï¼Œé‚£ä¹ˆé»‘å®¢å°±æœ‰å¯èƒ½åˆ©ç”¨ bug æ”»é™·æœåŠ¡å™¨ã€‚æ‰€ä»¥ï¼Œæœ‰çš„ç½‘ç«™å“åº”å¤´é‡Œè¦ä¹ˆæ²¡æœ‰è¿™ä¸ªå­—æ®µï¼Œè¦ä¹ˆå°±ç»™å‡ºä¸€ä¸ªå®Œå…¨æ— å…³çš„æè¿°ä¿¡æ¯ã€‚ çŠ¶æ€ç æè¿° çŠ¶æ€è¡Œçš„ èŒƒå¼ï¼šstatus-line= HTTP-version SP status-code SP reason-phrase CRLFçš„tatus-codeæ˜¯çŠ¶æ€è¡Œä¸­ä¿¡æ¯é‡æœ€å¤šçš„éƒ¨åˆ†ï¼ŒHTTP-versionå¤§å¤šéƒ½æ˜¯HTTP/1.1ï¼Œreason-phraseåˆ™æ˜¯å†™å¾ˆå¸¸è§çš„çŸ­è¯­ï¼šâ€œOKâ€ï¼Œâ€œNot Foundâ€ï¼Œâ€œBad Requestâ€ ç­‰ç­‰ã€‚ ç›®å‰ RFC æ ‡å‡†é‡Œè§„å®šçš„çŠ¶æ€ç æ˜¯ä¸‰ä½æ•°ï¼Œæ‰€ä»¥å–å€¼èŒƒå›´å°±æ˜¯ä» 000 åˆ° 999ã€‚ä½†å¦‚æœæŠŠä»£ç ç®€å•åœ°ä» 000 å¼€å§‹é¡ºåºç¼–ä¸‹å»å°±æ˜¾å¾—æœ‰ç‚¹å¤ªâ€œlowâ€ï¼Œä¸çµæ´»ã€ä¸åˆ©äºæ‰©å±•ï¼Œæ‰€ä»¥çŠ¶æ€ç ä¹Ÿè¢«è®¾è®¡æˆæœ‰ä¸€å®šçš„æ ¼å¼ã€‚ RFC æ ‡å‡†æŠŠçŠ¶æ€ç åˆ†æˆäº†äº”ç±»ï¼Œç”¨æ•°å­—çš„ç¬¬ä¸€ä½è¡¨ç¤ºåˆ†ç±»ï¼Œè€Œ 099 ä¸ç”¨ï¼Œè¿™æ ·çŠ¶æ€ç çš„å®é™…å¯ç”¨èŒƒå›´å°±å¤§å¤§ç¼©å°äº†ï¼Œç”± 000999 å˜æˆäº† 100~599ã€‚ æ€»å…±æœ‰ 41 ä¸ªçŠ¶æ€ç ï¼Œä½†çŠ¶æ€ç çš„å®šä¹‰æ˜¯å¼€æ”¾çš„ï¼Œå…è®¸è‡ªè¡Œæ‰©å±•ã€‚æ‰€ä»¥ Apacheã€Nginx ç­‰ Web æœåŠ¡å™¨éƒ½å®šä¹‰äº†ä¸€äº›ä¸“æœ‰çš„çŠ¶æ€ç ã€‚å¦‚æœä½ è‡ªå·±å¼€å‘ Web åº”ç”¨ï¼Œä¹Ÿå®Œå…¨å¯ä»¥åœ¨ä¸å†²çªçš„å‰æä¸‹å®šä¹‰æ–°çš„ä»£ç ã€‚ è¿™äº”ç±»çš„å…·ä½“å«ä¹‰æ˜¯ï¼š 1Ã—Ã—ï¼šæç¤ºä¿¡æ¯ï¼Œè¡¨ç¤ºç›®å‰æ˜¯åè®®å¤„ç†çš„ä¸­é—´çŠ¶æ€ï¼Œè¿˜éœ€è¦åç»­çš„æ“ä½œï¼› 2Ã—Ã—ï¼šæˆåŠŸï¼ŒæŠ¥æ–‡å·²ç»æ”¶åˆ°å¹¶è¢«æ­£ç¡®å¤„ç†ï¼› 3Ã—Ã—ï¼šé‡å®šå‘ï¼Œèµ„æºä½ç½®å‘ç”Ÿå˜åŠ¨ï¼Œéœ€è¦å®¢æˆ·ç«¯é‡æ–°å‘é€è¯·æ±‚ï¼› 4Ã—Ã—ï¼šå®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚æŠ¥æ–‡æœ‰è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†ï¼› 5Ã—Ã—ï¼šæœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶å†…éƒ¨å‘ç”Ÿäº†é”™è¯¯ã€‚ ä»è¿™äº”ç±»çš„å…·ä½“å«ä¹‰å¯ä»¥çœ‹å‡ºï¼ŒçŠ¶æ€ç å¹¶ä¸å•å•è¡¨æ˜è¿™æ¬¡è¯·æ±‚çš„å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡ç«¯çš„â€œååº”ç»“æœâ€ï¼Œè€Œæ˜¯è¡¨æ˜åŒæ–¹è¿›è¡Œå¤„ç†åçš„ç»“æœï¼Œå¯èƒ½æ˜¯å®¢æˆ·ç«¯çš„è¯·æ±‚æŠ¥æ–‡æœ‰é”™è¯¯ï¼Œä¹Ÿå¯èƒ½æ˜¯æœåŠ¡ç«¯å†…éƒ¨å¤„ç†æ—¶å‘ç”Ÿäº†é”™è¯¯ç­‰ç­‰ã€‚ å¸¸è§çš„çŠ¶æ€ç ï¼š 101 Switching Protocols: å®ƒçš„æ„æ€æ˜¯å®¢æˆ·ç«¯ä½¿ç”¨ Upgrade å¤´å­—æ®µï¼Œè¦æ±‚åœ¨ HTTP åè®®çš„åŸºç¡€ä¸Šæ”¹æˆå…¶ä»–çš„åè®®ç»§ç»­é€šä¿¡ï¼Œæ¯”å¦‚ WebSocketã€‚è€Œå¦‚æœæœåŠ¡å™¨ä¹ŸåŒæ„å˜æ›´åè®®ï¼Œå°±ä¼šå‘é€çŠ¶æ€ç  101ï¼Œä½†è¿™ä¹‹åçš„æ•°æ®ä¼ è¾“å°±ä¸ä¼šå†ä½¿ç”¨ HTTP äº† 206 Partial Content: æ˜¯ HTTP åˆ†å—ä¸‹è½½æˆ–æ–­ç‚¹ç»­ä¼ çš„åŸºç¡€ï¼Œåœ¨å®¢æˆ·ç«¯å‘é€â€œèŒƒå›´è¯·æ±‚â€ã€è¦æ±‚è·å–èµ„æºçš„éƒ¨åˆ†æ•°æ®æ—¶å‡ºç°ï¼Œå®ƒä¸ 200 ä¸€æ ·ï¼Œä¹Ÿæ˜¯æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½† body é‡Œçš„æ•°æ®ä¸æ˜¯èµ„æºçš„å…¨éƒ¨ï¼Œè€Œæ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚çŠ¶æ€ç  206 é€šå¸¸è¿˜ä¼šä¼´éšç€å¤´å­—æ®µâ€œContent-Rangeâ€ï¼Œè¡¨ç¤ºå“åº”æŠ¥æ–‡é‡Œ body æ•°æ®çš„å…·ä½“èŒƒå›´ï¼Œä¾›å®¢æˆ·ç«¯ç¡®è®¤ï¼Œä¾‹å¦‚â€œContent-Range: bytes 0-99/2000â€ï¼Œæ„æ€æ˜¯æ­¤æ¬¡è·å–çš„æ˜¯æ€»è®¡ 2000 ä¸ªå­—èŠ‚çš„å‰ 100 ä¸ªå­—èŠ‚ã€‚ 301 Moved Permanently: ä¿—ç§°â€œæ°¸ä¹…é‡å®šå‘â€ï¼Œå«ä¹‰æ˜¯æ­¤æ¬¡è¯·æ±‚çš„èµ„æºå·²ç»ä¸å­˜åœ¨äº†ï¼Œéœ€è¦æ”¹ç”¨æ”¹ç”¨æ–°çš„ URI å†æ¬¡è®¿é—®ã€‚ä¸302(Moved Temporarily)ä¸´æ—¶é‡å®šå‘ï¼Œä¸€è¯ä¹‹å·®ï¼Œåº”ç”¨åœºæ™¯å´æœ‰å¾ˆå¤§ä¸åŒã€‚å¦‚æœä½ çš„æœåŠ¡ä»httpå‡çº§åˆ°httpsï¼Œå°±éœ€è¦é…ç½®301ï¼Œæ°¸ä¹…é‡å®šå‘åçš„è·³è½¬é“¾æ¥ï¼›å¦‚æœä»Šå¤©å¤œé‡Œç½‘ç«™åå°è¦ç³»ç»Ÿç»´æŠ¤ï¼ŒæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¿™å°±å±äºâ€œä¸´æ—¶â€çš„ï¼Œå¯ä»¥é…ç½®æˆ 302 è·³è½¬ï¼ŒæŠŠæµé‡ä¸´æ—¶åˆ‡æ¢åˆ°ä¸€ä¸ªé™æ€é€šçŸ¥é¡µé¢ï¼Œæµè§ˆå™¨çœ‹åˆ°è¿™ä¸ª 302 å°±çŸ¥é“è¿™åªæ˜¯æš‚æ—¶çš„æƒ…å†µï¼Œä¸ä¼šåšç¼“å­˜ä¼˜åŒ–ï¼Œç¬¬äºŒå¤©è¿˜ä¼šè®¿é—®åŸæ¥çš„åœ°å€ã€‚ 304 Not Modified: æ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„çŠ¶æ€ç ï¼Œå®ƒç”¨äº If-Modified-Since ç­‰æ¡ä»¶è¯·æ±‚ï¼Œè¡¨ç¤ºèµ„æºæœªä¿®æ”¹ï¼Œç”¨äºç¼“å­˜æ§åˆ¶ã€‚å®ƒä¸å…·æœ‰é€šå¸¸çš„è·³è½¬å«ä¹‰ï¼Œä½†å¯ä»¥ç†è§£æˆâ€œé‡å®šå‘å·²åˆ°ç¼“å­˜çš„æ–‡ä»¶â€ï¼ˆå³â€œç¼“å­˜é‡å®šå‘â€ï¼‰ã€‚ 400 Bad Request: æ˜¯ä¸€ä¸ªé€šç”¨çš„é”™è¯¯ç ï¼Œè¡¨ç¤ºè¯·æ±‚æŠ¥æ–‡æœ‰é”™è¯¯ï¼Œä½†å…·ä½“æ˜¯æ•°æ®æ ¼å¼é”™è¯¯ã€ç¼ºå°‘è¯·æ±‚å¤´è¿˜æ˜¯ URI è¶…é•¿å®ƒæ²¡æœ‰æ˜ç¡®è¯´ï¼Œåªæ˜¯ä¸€ä¸ªç¬¼ç»Ÿçš„é”™è¯¯ï¼Œå®¢æˆ·ç«¯çœ‹åˆ° 400 åªä¼šæ˜¯â€œä¸€å¤´é›¾æ°´â€â€œä¸çŸ¥æ‰€æªâ€ã€‚æ‰€ä»¥ï¼Œåœ¨å¼€å‘ Web åº”ç”¨æ—¶åº”å½“å°½é‡é¿å…ç»™å®¢æˆ·ç«¯è¿”å› 400ï¼Œè€Œæ˜¯è¦ç”¨å…¶ä»–æ›´æœ‰æ˜ç¡®å«ä¹‰çš„çŠ¶æ€ç ã€‚ 403 Forbidden: å®é™…ä¸Šä¸æ˜¯å®¢æˆ·ç«¯çš„è¯·æ±‚å‡ºé”™ï¼Œè€Œæ˜¯è¡¨ç¤ºæœåŠ¡å™¨ç¦æ­¢è®¿é—®èµ„æºã€‚åŸå› å¯èƒ½å¤šç§å¤šæ ·ï¼Œä¾‹å¦‚ä¿¡æ¯æ•æ„Ÿã€æ³•å¾‹ç¦æ­¢ç­‰ï¼Œå¦‚æœæœåŠ¡å™¨å‹å¥½ä¸€ç‚¹ï¼Œå¯ä»¥åœ¨ body é‡Œè¯¦ç»†è¯´æ˜æ‹’ç»è¯·æ±‚çš„åŸå› ï¼Œä¸è¿‡ç°å®ä¸­é€šå¸¸éƒ½æ˜¯ç›´æ¥ç»™ä¸€ä¸ªâ€œé—­é—¨ç¾¹â€ã€‚ 405 Method Not Allowedï¼šä¸å…è®¸ä½¿ç”¨æŸäº›æ–¹æ³•æ“ä½œèµ„æºï¼Œä¾‹å¦‚ä¸å…è®¸ POST åªèƒ½ GETï¼› 406 Not Acceptableï¼šèµ„æºæ— æ³•æ»¡è¶³å®¢æˆ·ç«¯è¯·æ±‚çš„æ¡ä»¶ï¼Œä¾‹å¦‚è¯·æ±‚ä¸­æ–‡ä½†åªæœ‰è‹±æ–‡ï¼› 408 Request Timeoutï¼šè¯·æ±‚è¶…æ—¶ï¼ŒæœåŠ¡å™¨ç­‰å¾…äº†è¿‡é•¿çš„æ—¶é—´ï¼› 409 Conflictï¼šå¤šä¸ªè¯·æ±‚å‘ç”Ÿäº†å†²çªï¼Œå¯ä»¥ç†è§£ä¸ºå¤šçº¿ç¨‹å¹¶å‘æ—¶çš„ç«æ€ï¼› 413 Request Entity Too Largeï¼šè¯·æ±‚æŠ¥æ–‡é‡Œçš„ body å¤ªå¤§ï¼› 414 Request-URI Too Longï¼šè¯·æ±‚è¡Œé‡Œçš„ URI å¤ªå¤§ï¼› 429 Too Many Requestsï¼šå®¢æˆ·ç«¯å‘é€äº†å¤ªå¤šçš„è¯·æ±‚ï¼Œé€šå¸¸æ˜¯ç”±äºæœåŠ¡å™¨çš„é™è¿ç­–ç•¥ï¼› 431 Request Header Fields Too Largeï¼šè¯·æ±‚å¤´æŸä¸ªå­—æ®µæˆ–æ€»ä½“å¤ªå¤§ï¼› 500 Internal Server Errorï¼šä¸ 400 ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé€šç”¨çš„é”™è¯¯ç ï¼ŒæœåŠ¡å™¨ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆé”™è¯¯æˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„ã€‚ä¸è¿‡å¯¹äºæœåŠ¡å™¨æ¥è¯´è¿™åº”è¯¥ç®—æ˜¯å¥½äº‹ï¼Œé€šå¸¸ä¸åº”è¯¥æŠŠæœåŠ¡å™¨å†…éƒ¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚å‡ºé”™çš„å‡½æ•°è°ƒç”¨æ ˆå‘Šè¯‰å¤–ç•Œã€‚è™½ç„¶ä¸åˆ©äºè°ƒè¯•ï¼Œä½†èƒ½å¤Ÿé˜²æ­¢é»‘å®¢çš„çª¥æ¢æˆ–è€…åˆ†æã€‚ 500 Internal Server Errorï¼šä¸ 400 ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé€šç”¨çš„é”™è¯¯ç ï¼ŒæœåŠ¡å™¨ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆé”™è¯¯æˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„ã€‚ä¸è¿‡å¯¹äºæœåŠ¡å™¨æ¥è¯´è¿™åº”è¯¥ç®—æ˜¯å¥½äº‹ï¼Œé€šå¸¸ä¸åº”è¯¥æŠŠæœåŠ¡å™¨å†…éƒ¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚å‡ºé”™çš„å‡½æ•°è°ƒç”¨æ ˆå‘Šè¯‰å¤–ç•Œã€‚è™½ç„¶ä¸åˆ©äºè°ƒè¯•ï¼Œä½†èƒ½å¤Ÿé˜²æ­¢é»‘å®¢çš„çª¥æ¢æˆ–è€…åˆ†æã€‚ 502 Bad Gatewayï¼šé€šå¸¸æ˜¯æœåŠ¡å™¨ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†æ—¶è¿”å›çš„é”™è¯¯ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è‡ªèº«å·¥ä½œæ­£å¸¸ï¼Œè®¿é—®åç«¯æœåŠ¡å™¨æ—¶å‘ç”Ÿäº†é”™è¯¯ï¼Œä½†å…·ä½“çš„é”™è¯¯åŸå› ä¹Ÿæ˜¯ä¸çŸ¥é“çš„ 503 Service Unavailableï¼šè¡¨ç¤ºæœåŠ¡å™¨å½“å‰å¾ˆå¿™ï¼Œæš‚æ—¶æ— æ³•å“åº”æœåŠ¡ï¼Œæˆ‘ä»¬ä¸Šç½‘æ—¶æœ‰æ—¶å€™é‡åˆ°çš„â€œç½‘ç»œæœåŠ¡æ­£å¿™ï¼Œè¯·ç¨åé‡è¯•â€çš„æç¤ºä¿¡æ¯å°±æ˜¯çŠ¶æ€ç  503ï¼Œå¾ˆå¯èƒ½è¿‡å‡ ç§’é’ŸåæœåŠ¡å™¨å°±ä¸é‚£ä¹ˆå¿™äº†ï¼Œå¯ä»¥ç»§ç»­æä¾›æœåŠ¡ï¼Œæ‰€ä»¥ 503 å“åº”æŠ¥æ–‡é‡Œé€šå¸¸è¿˜ä¼šæœ‰ä¸€ä¸ªâ€œRetry-Afterâ€å­—æ®µï¼ŒæŒ‡ç¤ºå®¢æˆ·ç«¯å¯ä»¥åœ¨å¤šä¹…ä»¥åå†æ¬¡å°è¯•å‘é€è¯·æ±‚ å†…å®¹åå•†å‡å¦‚ HTTP æ²¡æœ‰å‘ŠçŸ¥æ•°æ®ç±»å‹çš„åŠŸèƒ½ï¼ŒæœåŠ¡å™¨æŠŠâ€œä¸€å¤§å¨â€æ•°æ®å‘ç»™äº†æµè§ˆå™¨ï¼Œæµè§ˆå™¨çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªâ€œé»‘ç›’å­â€ï¼Œé¢å¯¹èŒ«èŒ«å¤šçš„æ•°æ®ç±»å‹ï¼ŒçŒœä¸å¤ªå¯èƒ½ï¼Œäºæ˜¯å°±æœ‰äº†ä¸¤ç«¯çš„å†…å®¹åå•†ã€‚ å†…å®¹çš„æ•°æ®ç±»å‹HTTPç”¨ä¸€éƒ¨åˆ†çš„â€œMIMEâ€æ¥æ ‡è®°bodyä¸­çš„æ•°æ®ç±»å‹ï¼Œå«â€œMIME typeâ€ã€‚ç”¨â€œEncoding typeâ€æ¥è¡¨æ˜æ•°æ®çš„å‹ç¼©ç±»å‹(ç¼–ç æ ¼å¼)ã€‚è¿˜æœ‰è¯­è¨€ç±»å‹ï¼Œç¼–ç ç±»å‹â€¦ å¸¸è§çš„MIME type: textï¼šå³æ–‡æœ¬æ ¼å¼çš„å¯è¯»æ•°æ®ï¼Œæˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„åº”è¯¥å°±æ˜¯ text/html äº†ï¼Œè¡¨ç¤ºè¶…æ–‡æœ¬æ–‡æ¡£ï¼Œæ­¤å¤–è¿˜æœ‰çº¯æ–‡æœ¬ text/plainã€æ ·å¼è¡¨ text/css ç­‰ã€‚ imageï¼šå³å›¾åƒæ–‡ä»¶ï¼Œæœ‰ image/gifã€image/jpegã€image/png ç­‰ã€‚ audio/videoï¼šéŸ³é¢‘å’Œè§†é¢‘æ•°æ®ï¼Œä¾‹å¦‚ audio/mpegã€video/mp4 ç­‰ã€‚ applicationï¼šæ•°æ®æ ¼å¼ä¸å›ºå®šï¼Œå¯èƒ½æ˜¯æ–‡æœ¬ä¹Ÿå¯èƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¿…é¡»ç”±ä¸Šå±‚åº”ç”¨ç¨‹åºæ¥è§£é‡Šã€‚å¸¸è§çš„æœ‰ application/jsonï¼Œapplication/javascriptã€application/pdf ç­‰ï¼Œå¦å¤–ï¼Œå¦‚æœå®åœ¨æ˜¯ä¸çŸ¥é“æ•°æ®æ˜¯ä»€ä¹ˆç±»å‹ï¼Œåƒåˆšæ‰è¯´çš„â€œé»‘ç›’â€ï¼Œå°±ä¼šæ˜¯ application/octet-streamï¼Œå³ä¸é€æ˜çš„äºŒè¿›åˆ¶æ•°æ®ã€‚ å¸¸è§çš„Encoding type: gzipï¼šGNU zip å‹ç¼©æ ¼å¼ï¼Œä¹Ÿæ˜¯äº’è”ç½‘ä¸Šæœ€æµè¡Œçš„å‹ç¼©æ ¼å¼ï¼› deflateï¼šzlibï¼ˆdeflateï¼‰å‹ç¼©æ ¼å¼ï¼Œæµè¡Œç¨‹åº¦ä»…æ¬¡äº gzipï¼› brï¼šä¸€ç§ä¸“é—¨ä¸º HTTP ä¼˜åŒ–çš„æ–°å‹ç¼©ç®—æ³•ï¼ˆBrotliï¼‰ã€‚ å¸¸è§çš„Language type: zh-CN, zh, en å¸¸è§çš„Charset type: gbk, utf-8 ä¸Šè¿°çš„æ˜¯â€œå†…å®¹åå•†â€çš„é”®å€¼å¯¹çš„å€¼ï¼ŒHTTP åè®®ä¸ºæ­¤å®šä¹‰äº†ä¸¤ä¸ª Accept è¯·æ±‚å¤´å­—æ®µå’Œä¸¤ä¸ª Content å®ä½“å¤´å­—æ®µä½œä¸ºâ€œå†…å®¹åå•†â€çš„é”®å€¼å¯¹çš„é”®ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå®¢æˆ·ç«¯ç”¨ Accept å¤´å‘Šè¯‰æœåŠ¡å™¨å¸Œæœ›æ¥æ”¶ä»€ä¹ˆæ ·çš„æ•°æ®ï¼Œè€ŒæœåŠ¡å™¨ç”¨ Content å¤´å‘Šè¯‰å®¢æˆ·ç«¯å®é™…å‘é€äº†ä»€ä¹ˆæ ·çš„æ•°æ®ã€‚ ä¾‹å¦‚ä¸Šæ–‡ä¸­ä¸¾ä¾‹çš„æŠ¥æ–‡ï¼š 12345Accept-Ranges: bytesCache-Control: private, no-cache, no-store, proxy-revalidate, no-transformConnection: keep-aliveContent-Length: 277Content-Type: text/html å¯ä»¥ç”¨â€œ,â€åšåˆ†éš”ç¬¦åˆ—å‡ºå¤šä¸ªç±»å‹ï¼Œä¾‹å¦‚ä¸‹é¢ï¼š 12345Accept-Encoding: gzip, deflate, brContent-Encoding: gzipAccept-Language: zh-CN, zh, enAccept-Charset: gbk, utf-8Content-Type: text/html; charset=utf-8 è¯´å®Œäº†è¡¨ç¤ºæ•°æ®ç±»å‹çš„ä¸»ä½“å†…å®¹ï¼Œè¿˜æœ‰ä¸€äº›è¾…åŠ©å†…å®¹ã€‚ å†…å®¹çš„é€‰æ‹©æƒé‡åœ¨ HTTP åè®®é‡Œç”¨ Acceptã€Accept-Encodingã€Accept-Language ç­‰è¯·æ±‚å¤´å­—æ®µè¿›è¡Œå†…å®¹åå•†çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥ç”¨ä¸€ç§ç‰¹æ®Šçš„â€œqâ€å‚æ•°è¡¨ç¤ºæƒé‡æ¥è®¾å®šä¼˜å…ˆçº§ï¼Œè¿™é‡Œçš„â€œqâ€æ˜¯â€œquality factorâ€çš„æ„æ€ã€‚ æƒé‡çš„æœ€å¤§å€¼æ˜¯ 1ï¼Œæœ€å°å€¼æ˜¯ 0.01ï¼Œé»˜è®¤å€¼æ˜¯ 1ï¼Œå¦‚æœå€¼æ˜¯ 0 å°±è¡¨ç¤ºæ‹’ç»ã€‚å…·ä½“çš„å½¢å¼æ˜¯åœ¨æ•°æ®ç±»å‹æˆ–è¯­è¨€ä»£ç åé¢åŠ ä¸€ä¸ªâ€œ;â€ï¼Œç„¶åæ˜¯â€œq=valueâ€ã€‚ è¿™é‡Œè¦æé†’çš„æ˜¯â€œ;â€çš„ç”¨æ³•ï¼Œåœ¨å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€é‡Œâ€œ;â€çš„æ–­å¥è¯­æ°”è¦å¼ºäºâ€œ,â€ï¼Œè€Œåœ¨ HTTP çš„å†…å®¹åå•†é‡Œå´æ°å¥½åäº†è¿‡æ¥ï¼Œâ€œ;â€çš„æ„ä¹‰æ˜¯å°äºâ€œ,â€çš„ã€‚ ä¾‹å¦‚ä¸‹é¢çš„ Accept å­—æ®µï¼š 1Accept: text/html,application/xml;q=0.9,*/*;q=0.8 å®ƒè¡¨ç¤ºæµè§ˆå™¨æœ€å¸Œæœ›ä½¿ç”¨çš„æ˜¯ HTML æ–‡ä»¶ï¼Œæƒé‡æ˜¯ 1ï¼Œå…¶æ¬¡æ˜¯ XML æ–‡ä»¶ï¼Œæƒé‡æ˜¯ 0.9ï¼Œæœ€åæ˜¯ä»»æ„æ•°æ®ç±»å‹ï¼Œæƒé‡æ˜¯ 0.8ã€‚æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚å¤´åï¼Œå°±ä¼šè®¡ç®—æƒé‡ï¼Œå†æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µä¼˜å…ˆè¾“å‡º HTML æˆ–è€… XMLã€‚ å†…å®¹åå•†çš„ç»“æœå†…å®¹åå•†çš„è¿‡ç¨‹æ˜¯ä¸é€æ˜çš„ï¼Œæ¯ä¸ª Web æœåŠ¡å™¨ä½¿ç”¨çš„ç®—æ³•éƒ½ä¸ä¸€æ ·ã€‚ä½†æœ‰çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¼šåœ¨å“åº”å¤´é‡Œå¤šåŠ ä¸€ä¸ª Vary å­—æ®µï¼Œè®°å½•æœåŠ¡å™¨åœ¨å†…å®¹åå•†æ—¶å‚è€ƒçš„è¯·æ±‚å¤´å­—æ®µï¼Œç»™å‡ºä¸€ç‚¹ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š 1Vary: Accept-Encoding,User-Agent,Accept è¿™ä¸ª Vary å­—æ®µè¡¨ç¤ºæœåŠ¡å™¨ä¾æ®äº† Accept-Encodingã€User-Agent å’Œ Accept è¿™ä¸‰ä¸ªå¤´å­—æ®µï¼Œç„¶åå†³å®šäº†å‘å›çš„å“åº”æŠ¥æ–‡ã€‚ Vary å­—æ®µå¯ä»¥è®¤ä¸ºæ˜¯å“åº”æŠ¥æ–‡çš„ä¸€ä¸ªç‰¹æ®Šçš„â€œç‰ˆæœ¬æ ‡è®°â€ã€‚æ¯å½“ Accept ç­‰è¯·æ±‚å¤´å˜åŒ–æ—¶ï¼ŒVary ä¹Ÿä¼šéšç€å“åº”æŠ¥æ–‡ä¸€èµ·å˜åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ª URI å¯èƒ½ä¼šæœ‰å¤šä¸ªä¸åŒçš„â€œç‰ˆæœ¬â€ï¼Œä¸»è¦ç”¨åœ¨ä¼ è¾“é“¾è·¯ä¸­é—´çš„ä»£ç†æœåŠ¡å™¨å®ç°ç¼“å­˜æœåŠ¡ã€‚ Httpç¼“å­˜å¸¸ç”¨å­—æ®µçº¦å®šreqä¸ºè¯·æ±‚å¤´ï¼Œreså“åº”å¤´ï¼ŒCå®¢æˆ·ç«¯ï¼ŒSæœåŠ¡ç«¯ Expires ï¼šresä¸­ä¸ºèµ„æºè¿‡æœŸæ—¶é—´ Last-Modifiedï¼š resä¸­ä¸ºèµ„æºæœ€è¿‘ä¿®æ”¹æ—¶é—´ ETagï¼š resä¸­èµ„æºçš„å”¯ä¸€æ ‡è¯†ç¬¦(hashç®—æ³•ç”Ÿæˆ) If-Modified-Since ï¼š reqä¸­çš„èµ„æºæœ€è¿‘ä¿®æ”¹æ—¶é—´ If-None-Match ï¼šreqä¸­çš„èµ„æºæ ‡è¯† Cache-Control ï¼š resï¼Œreqä¸­è¡¨ç¤ºç¼“å­˜ç­–ç•¥ reqä¸­å¸¸ç”¨æŒ‡ä»¤ å­—æ®µåç§° è¯´æ˜ max-age= è®¾ç½®ç¼“å­˜å­˜å‚¨çš„æœ€å¤§å‘¨æœŸï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ç¼“å­˜è¢«è®¤ä¸ºè¿‡æœŸ(å•ä½ç§’)ã€‚ä¸Expiresç›¸åï¼Œæ—¶é—´æ˜¯ç›¸å¯¹äºè¯·æ±‚çš„æ—¶é—´ max-stale[=] Cå¯æ¥æ”¶ä¸€ä¸ªå·²ç»è¿‡æœŸçš„èµ„æºã€‚è®¾ç½®ä¸€ä¸ªå¯é€‰çš„ç§’æ•°ï¼Œä¸æ¥å—è¶…è¿‡ç»™å®šæ—¶é—´çš„èµ„æº min-fresh= Cå¸Œæœ›è·å–ä¸€ä¸ªèƒ½åœ¨æŒ‡å®šçš„ç§’æ•°å†…ä¿æŒå…¶æœ€æ–°çŠ¶æ€çš„res no-cache åœ¨å‘å¸ƒç¼“å­˜å‰¯æœ¬ä¹‹å‰ï¼Œå¼ºåˆ¶è¦æ±‚ç¼“å­˜æŠŠè¯·æ±‚æäº¤ç»™åŸå§‹æœåŠ¡å™¨è¿›è¡ŒéªŒè¯ no-store ä¸ç¼“å­˜æœ‰å…³å®¢æˆ·ç«¯è¯·æ±‚æˆ–æœåŠ¡å™¨å“åº”çš„ä»»ä½•å†…å®¹ â€‹ 2. resä¸­å¸¸ç”¨æŒ‡ä»¤(reqä¸­é‡å¤çš„ä¸åˆ—ä¸¾ï¼Œè¯¦è§MDN) å­—æ®µåç§° è¯´æ˜ public è¡¨æ˜å“åº”å¯ä»¥è¢«ä»»ä½•å¯¹è±¡ï¼ˆåŒ…æ‹¬ï¼šå‘é€è¯·æ±‚çš„å®¢æˆ·ç«¯ï¼Œä»£ç†æœåŠ¡å™¨ï¼Œç­‰ç­‰ï¼‰ç¼“å­˜ï¼Œå³ä½¿æ˜¯é€šå¸¸ä¸å¯ç¼“å­˜çš„å†…å®¹ private è¡¨æ˜å“åº”åªèƒ½è¢«å•ä¸ªç”¨æˆ·ç¼“å­˜ï¼Œä¸èƒ½ä½œä¸ºå…±äº«ç¼“å­˜ï¼ˆå³ä»£ç†æœåŠ¡å™¨ä¸èƒ½ç¼“å­˜å®ƒï¼‰ã€‚ç§æœ‰ç¼“å­˜å¯ä»¥ç¼“å­˜å“åº”å†…å®¹ must-revalidate ä¸€æ—¦èµ„æºè¿‡æœŸï¼ˆæ¯”å¦‚å·²ç»è¶…è¿‡max-ageï¼‰ï¼Œåœ¨æˆåŠŸå‘åŸå§‹æœåŠ¡å™¨éªŒè¯ä¹‹å‰ï¼Œç¼“å­˜ä¸èƒ½ç”¨è¯¥èµ„æºå“åº”åç»­è¯·æ±‚ proxy-revalidate ä¸must-revalidateä½œç”¨ç›¸åŒï¼Œä½†å®ƒä»…é€‚ç”¨äºå…±äº«ç¼“å­˜ï¼ˆä¾‹å¦‚ä»£ç†ï¼‰ï¼Œå¹¶è¢«ç§æœ‰ç¼“å­˜å¿½ç•¥ s-maxage= è¦†ç›–max-ageæˆ–è€…Expireså¤´ï¼Œä½†æ˜¯ä»…é€‚ç”¨äºå…±äº«ç¼“å­˜(æ¯”å¦‚å„ä¸ªä»£ç†)ï¼Œç§æœ‰ç¼“å­˜ä¼šå¿½ç•¥å®ƒ å…¶ä¸­Last-Modifiedä¸If-Modified-Sinceï¼ŒETagä¸If-None-Matchæ˜¯åœ¨æ¯æ¬¡çš„resï¼Œreqä¸­é…å¯¹ä½¿ç”¨çš„ã€‚","categories":[],"tags":[{"name":"http","slug":"http","permalink":"https://tsunamigg.github.io/tags/http/"}]},{"title":"5.ä»ä¸€æ¬¡é“¾æ¥çœ‹TCPä¸HTTP","slug":"http5","date":"2019-06-22T12:22:40.000Z","updated":"2020-06-01T14:36:49.434Z","comments":true,"path":"2019/06/22/http5/","link":"","permalink":"https://tsunamigg.github.io/2019/06/22/http5/","excerpt":"ä½¿ç”¨WiresharkæŠ“åŒ…ï¼Œä»ä¸€æ¬¡é“¾æ¥çœ‹TCPä¸HTTP","text":"ä½¿ç”¨WiresharkæŠ“åŒ…ï¼Œä»ä¸€æ¬¡é“¾æ¥çœ‹TCPä¸HTTP TCPHeader ç¬¬ä¸€æ¬¡è¯·æ±‚åŒ…ç¤ºä¾‹ï¼š 60738 -&gt; 8081 [SYN] Seq=0 Win=64240 Len=0 Mss=1460 Ws=256 SACK_PERM=1 è¯·æ±‚ä¿¡æ¯å­—æ®µåè¯¦è§£1. Win: TCP çª—å£å¤§å°ï¼Œæ˜¯æŒ‡TCPä¼ è¾“èƒ½æ¥å—çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œè¿™ä¸ªå¯ä»¥è¿›è¡ŒåŠ¨æ€è°ƒèŠ‚ï¼Œä¹Ÿå°±æ˜¯TCPçš„æ»‘åŠ¨çª—å£ï¼Œé€šè¿‡åŠ¨æ€è°ƒæ•´çª—å£å¤§å°ï¼Œæ¥æ§åˆ¶å‘é€æ•°æ®çš„é€Ÿç‡ã€‚ä¸Šå›¾ä¸­å ç”¨2ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯16ä½ï¼Œé‚£ä¹ˆå¯ä»¥æ”¯æŒçš„æœ€å¤§æ•°å°±æ˜¯2^16=65536ï¼Œæ‰€ä»¥é»˜è®¤æƒ…å†µä¸‹TCPå¤´éƒ¨æ ‡è®°èƒ½æ”¯æŒçš„æœ€å¤§çª—å£æ•°æ˜¯65536å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯64KBã€‚ 2. Len: æ¶ˆæ¯é•¿åº¦å°±æ˜¯æŒ‡æ•°æ®æŠ¥æ–‡æ®µï¼Œå› ä¸ºæ•´ä¸ªTCPæŠ¥æ–‡=Header+packSize,æ‰€ä»¥è¿™ä¸ªæ¶ˆæ¯é•¿åº¦å°±æ˜¯æŒ‡è¦ä¼ é€çš„æ•°æ®åŒ…æ€»å…±é•¿åº¦ï¼Œåœ¨æœ¬æ¬¡åˆ†æä¸­ä¹Ÿå°±æ˜¯HTTPæŠ¥æ–‡çš„å¤§å°ã€‚ 3. Mss: æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦ï¼šè¿™ä¸ªå°±æ˜¯è§„å®šæœ€å¤§çš„èƒ½ä¼ è¾“æŠ¥æ–‡çš„é•¿åº¦ï¼Œä¸ºäº†è¾¾åˆ°æœ€ä½³çš„ä¼ è¾“æ•ˆèƒ½ï¼ŒTCPåè®®åœ¨å»ºç«‹è¿æ¥çš„æ—¶å€™é€šå¸¸è¦åå•†åŒæ–¹çš„MSSå€¼ï¼Œè¿™ä¸ªå€¼TCPåè®®åœ¨å®ç°çš„æ—¶å€™å¾€å¾€ç”¨MTU( æœ€å¤§ä¼ è¾“å•å…ƒ)å€¼ä»£æ›¿ï¼ˆä»¥å¤ªç½‘çš„1500å‡å»IPæ•°æ®åŒ…åŒ…å¤´çš„å¤§å°20Byteså’ŒTCPæ•°æ®æ®µçš„åŒ…å¤´20Bytesï¼‰æ‰€ä»¥ä¸€èˆ¬MSSå€¼1460ï¼Œè€Œå®é™…ä¸Šçš„MSSå€¼ä¸€èˆ¬ä¼šæ¯”è¿™ä¸ªæ•°å­—å¤§ã€‚ TSOï¼ˆTCP Segment Offloadï¼‰çš„æŠ€æœ¯ï¼Œè¯¥é¡¹æŠ€æœ¯æ˜¯å°†éƒ¨åˆ†çš„å°åŒ…è§£åŒ…çš„å¤„ç†å·¥ä½œäº¤ç»™äº†ç½‘å¡ï¼Œä»è€Œè®©CPUå‡å°‘éƒ¨åˆ†åŒ…å¤„ç†çš„å·¥ä½œã€‚ ç½‘å¡æ”¯æŒTSOæŠ€æœ¯æ—¶ï¼ŒTCPå±‚ä¼šé€æ¸çš„åŠ å¤§MSSï¼ˆåŒ…å¤§å°è¶…è¿‡MSSå­—èŠ‚ï¼‰ï¼Œå½“ä¸‹å±‚æ¥æ”¶åˆ°è¿™ä¸ªå¤§åŒ…æ—¶ä¸ä¼šåšåˆ†åŒ…è€Œæ˜¯ç›´æ¥ä¸‹å‘ç»™ä¸‹ä¸€å±‚ï¼Œå½“åˆ°è¾¾ç½‘å¡åç½‘å¡ä¼šå°†è¿™ä¸ªå¤§çš„IPåŒ…æ‹†åˆ†ä¸ºNä¸ªåŒ…ï¼ˆå°äºç­‰äºMTUå­—èŠ‚çš„åŒ…ï¼‰å‘é€å‡ºå»ï¼Œè€Œæ¥æ”¶ç«¯ä¹Ÿæ˜¯è¿™æ ·å¤„ç†ï¼Œè¿™æ ·å°±ç›¸å½“äºæŠŠéƒ¨åˆ†åŒ…çš„ç»„è£…å·¥ä½œç»™ç½‘å¡å»åšï¼ˆç¡¬ä»¶çš„å¤„ç†é€Ÿåº¦ä¼šæ¯”è½¯ä»¶å¿«å¾ˆå¤šï¼‰ã€‚ 4. Ws: çª—å£ç¼©æ”¾è°ƒæ•´å› å­ï¼šåœ¨å‰é¢è¯´TCPçª—å£å¤§å°ä¸­æˆ‘ä»¬è¯´åˆ°ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒTCPçª—å£å¤§å°æœ€å¤§åªèƒ½æ”¯æŒ64KBçš„ç¼“å†²æ•°æ®ï¼Œåœ¨ä»Šå¤©è¿™ä¸ªé«˜é€Ÿä¸Šç½‘æ—¶ä»£ï¼Œè¿™ä¸ªå¤§å°è‚¯å®šä¸æ»¡è¶³æ¡ä»¶äº†ï¼Œæ‰€ä»¥ï¼Œä¸ºäº†èƒ½å¤Ÿæ”¯æŒæ›´å¤šçš„ç¼“å†²æ•°æ® RFC 1323ä¸­å°±è§„å®šäº†TCPçš„æ‰©å±•é€‰é¡¹ï¼Œå…¶ä¸­çª—å£ç¼©æ”¾è°ƒæ•´å› å­å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œè¿™ä¸ªæ˜¯å¦‚ä½•èµ·ä½œç”¨çš„å‘¢ï¼Ÿé¦–å…ˆè¯´æ˜ï¼Œè¿™ä¸ªå‚æ•°æ˜¯åœ¨[SYN]åŒæ­¥é˜¶æ®µè¿›è¡Œåå•†çš„ï¼Œæˆ‘ä»¬ç»“åˆä¸Šé¢æŠ“åŒ…æ•°æ®åˆ†æä¸‹ã€‚æˆ‘ä»¬çœ‹åˆ°ç¬¬ä¸€æ¬¡è¯·æ±‚åå•†çš„ç»“æœæ˜¯WS=256,ç„¶åå†ACKé˜¶æ®µæ‰©å±•å› å­ç”Ÿæ•ˆï¼Œè°ƒæ•´äº†çª—å£å¤§å°ã€‚ ç”Ÿæ•ˆçš„æŠ“åŒ…å¦‚ä¸‹ï¼š 60738 -&gt;8081 [ACK] Seq=1 ACK=1 Win=66560 Len=0 æˆ‘ä»¬å‘ç°è¿™ä¸ªçª—å£å˜æˆäº†66560ï¼Œæ¯”é»˜è®¤çš„çª—å£è¦å¤§ï¼Œæˆ‘ä»¬æŸ¥çœ‹æŠ¥æ–‡è¯¦æƒ…ï¼š æˆ‘ä»¬å‘ç°ï¼Œå®é™…è¯·æ±‚å£°æ˜çš„çª—å£æ˜¯260ï¼ŒWSæ‰©å±•å› å­æ˜¯256ï¼Œæœ€ç»ˆè®¡ç®—çš„çª—å£å¤§å°æ˜¯66560ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“äº†ï¼Œè¿™ä¸ªæ‰©å±•å› å­çš„ä½œç”¨å°±æ˜¯ï¼Œç”¨åŸçª—å£å¤§å°ä¹˜ä»¥æ‰©å±•å› å­ï¼Œå¾—åˆ°æœ€ç»ˆçš„çª—å£å¤§å°ï¼Œä¹Ÿå°±æ˜¯260*256=66560. 5. SACK_PERM:SACKé€‰é¡¹ï¼Œæˆ‘ä»¬çŸ¥é“TCPä¼ è¾“æœ‰åŒ…çš„ç¡®è®¤æœºåˆ¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¥å—ç«¯æ¥å—åˆ°ä¸€ä¸ªåŒ…åï¼Œå‘é€ACKç¡®è®¤ï¼Œä½†æ˜¯ï¼Œé»˜è®¤åªæ”¯æŒé¡ºåºçš„ç¡®è®¤ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‘é€A,B,Cä¸ªåŒ…ï¼Œå¦‚æœæˆ‘æ”¶åˆ°äº†A,Cçš„åŒ…ï¼ŒBæ²¡æœ‰æ”¶åˆ°ï¼Œé‚£ä¹ˆå¯¹äºCï¼Œè¿™ä¸ªåŒ…æˆ‘æ˜¯ä¸ä¼šç¡®è®¤çš„ï¼Œéœ€è¦ç­‰Bè¿™ä¸ªåŒ…æ”¶åˆ°åå†ç¡®è®¤ï¼Œé‚£ä¹ˆTCPæœ‰è¶…æ—¶é‡ä¼ æœºåˆ¶ï¼Œå¦‚æœä¸€ä¸ªåŒ…å¾ˆä¹…æ²¡æœ‰ç¡®è®¤ï¼Œå°±ä¼šå½“å®ƒä¸¢å¤±äº†ï¼Œè¿›è¡Œé‡ä¼ ï¼Œè¿™æ ·ä¼šé€ æˆå¾ˆå¤šå¤šä½™çš„åŒ…é‡ä¼ ï¼Œæµªè´¹ä¼ è¾“ç©ºé—´ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒSACKå°±æå‡ºäº†é€‰æ‹©æ€§ç¡®è®¤æœºåˆ¶ï¼Œå¯ç”¨SACKåï¼Œæ¥å—ç«¯ä¼šç¡®è®¤æ‰€æœ‰æ”¶åˆ°çš„åŒ…ï¼Œè¿™æ ·å‘é€ç«¯å°±åªç”¨é‡ä¼ çœŸæ­£ä¸¢å¤±çš„åŒ…äº†ã€‚ ä¸‰æ¬¡æ¡æ‰‹TCPä¸‰æ¬¡æ¡æ‰‹ï¼ˆå»ºç«‹è¿æ¥è¿‡ç¨‹ï¼‰ è§’è‰²å‘é€ è¿‡ç¨‹ æŠ¥æ–‡é¦–éƒ¨ æŠ¥æ–‡éƒ¨åˆ†å†…å®¹ çŠ¶æ€ å®¢æˆ·ç«¯ 1æ¬¡æ¡æ‰‹ SYN = 1 seq = x SYN_SENT æœåŠ¡ç«¯ 2æ¬¡æ¡æ‰‹ SYN = 1, ACK= 1 ack = x +1, seq = y SYN_RECD å®¢æˆ·ç«¯ 3æ¬¡æ¡æ‰‹ ACK = 1 ack = y + 1,seq = x +1 ESTABLISHED æˆ‘ä»¬æ ¹æ®ä¸Šé¢çš„æµç¨‹æ¢³ç†ï¼Œå¯ä»¥çŸ¥é“ï¼Œåºå·1-åºå·3æ˜¯æ˜æ˜¾çš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œç„¶ååºå·4è¿›è¡Œäº†ä¸€æ¬¡HTTPè¯·æ±‚ï¼Œæ¥ç€åºå·5æ˜¯å¯¹HTTPè¯·æ±‚çš„ä¸€æ¬¡æ¥æ”¶ç¡®è®¤ï¼Œåºå·6æ˜¯å“åº”HTTPè¯·æ±‚ï¼Œåºå·7æ˜¯å¯¹å“åº”è¯·æ±‚çš„ç¡®è®¤ã€‚ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå»ºç«‹è¿æ¥ã€‚å®¢æˆ·ç«¯å‘é€è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå°†SYNä½ç½®ä¸º1ï¼ŒSequence Numberä¸ºxï¼›ç„¶åï¼Œå®¢æˆ·ç«¯è¿›å…¥SYN_SENDçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨çš„ç¡®è®¤ï¼› ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°SYNæŠ¥æ–‡æ®µã€‚æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„SYNæŠ¥æ–‡æ®µï¼Œéœ€è¦å¯¹è¿™ä¸ªSYNæŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤ï¼Œè®¾ç½®Acknowledgment Numberä¸ºx+1(Sequence Number+1)ï¼›åŒæ—¶ï¼Œè‡ªå·±è¿˜è¦å‘é€SYNè¯·æ±‚ä¿¡æ¯ï¼Œå°†SYNä½ç½®ä¸º1ï¼ŒSequence Numberä¸ºyï¼›æœåŠ¡å™¨ç«¯å°†ä¸Šè¿°æ‰€æœ‰ä¿¡æ¯æ”¾åˆ°ä¸€ä¸ªæŠ¥æ–‡æ®µï¼ˆå³SYN+ACKæŠ¥æ–‡æ®µï¼‰ä¸­ï¼Œä¸€å¹¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥SYN_RECVçŠ¶æ€ï¼› ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„SYN+ACKæŠ¥æ–‡æ®µã€‚ç„¶åå°†Acknowledgment Numberè®¾ç½®ä¸ºy+1ï¼Œå‘æœåŠ¡å™¨å‘é€ACKæŠ¥æ–‡æ®µï¼Œè¿™ä¸ªæŠ¥æ–‡æ®µå‘é€å®Œæ¯•ä»¥åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½è¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œå®ŒæˆTCPä¸‰æ¬¡æ¡æ‰‹ã€‚ ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚ å››æ¬¡æŒ¥æ‰‹TCPå››æ¬¡æŒ¥æ‰‹ï¼ˆæ–­å¼€è¿æ¥è¿‡ç¨‹ï¼‰ è§’è‰²å‘é€ è¿‡ç¨‹ æŠ¥æ–‡é¦–éƒ¨ æŠ¥æ–‡éƒ¨åˆ†å†…å®¹ çŠ¶æ€ å®¢æˆ·ç«¯ 1æ¬¡æŒ¥æ‰‹ FIN = 1 seq = u FIN_WAIT_1 æœåŠ¡ç«¯ 2æ¬¡æŒ¥æ‰‹ ACK = 1 ack = u +1,seq = v CLOSE_WAIT å®¢æˆ·ç«¯ 3æ¬¡æŒ¥æ‰‹ FIN = 1 ack = u + 1,seq = w LAST_ACK æœåŠ¡ç«¯ 4æ¬¡æŒ¥æ‰‹ ACK = 1 ack = w + 1ï¼Œseq = u +1 TIME_WAIT æ³¨æ„æ­¤æ—¶çš„TCPè¿æ¥è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå¿…é¡»ç»è¿‡2MSLï¼ˆæœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½ï¼‰çš„æ—¶é—´åï¼Œå½“å®¢æˆ·ç«¯æ’¤é”€ç›¸åº”çš„TCBåï¼Œæ‰ä¼šè¿›å…¥CLOSEDçŠ¶æ€ã€‚ æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„ç¡®è®¤ï¼Œç«‹å³è¿›å…¥CLOSEDçŠ¶æ€ã€‚ å¯ä»¥ä»ä¸Šé¢å‘ç°ï¼ŒæœåŠ¡ç«¯ç»“æŸè¿æ¥è¦æ¯”å®¢æˆ·ç«¯æ—©ä¸€äº› PSï¼š seqï¼šåºåˆ—å· ackï¼šç¡®è®¤å· SYNï¼šè¯·æ±‚åŒæ­¥æ ‡å¿— ACKï¼šç¡®è®¤æ ‡å¿— FIN ï¼š ç»“æŸæ ‡å¿— â€œå››æ¬¡æŒ¥æ‰‹â€åœ¨æŠ“åŒ…é‡Œæ²¡æœ‰å‡ºç°ï¼Œè¿™æ˜¯å› ä¸º HTTP/1.1 é•¿è¿æ¥ç‰¹æ€§ï¼Œé»˜è®¤ä¸ä¼šç«‹å³å…³é—­è¿æ¥ã€‚ æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¿æ¥æ–­å¼€æ˜¯4æ¬¡æŒ¥æ‰‹çš„ï¼Œ4æ¬¡æŒ¥æ‰‹è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š æˆ‘ä»¬åˆ†æè¿™å›¾ï¼ŒæŒ¥æ‰‹æµç¨‹æ˜¯è¿™æ ·çš„ï¼š ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šä¸»æœº1ï¼ˆå¯ä»¥ä½¿å®¢æˆ·ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯æœåŠ¡å™¨ç«¯ï¼‰ï¼Œè®¾ç½®Sequence Numberï¼Œå‘ä¸»æœº2å‘é€ä¸€ä¸ªFINæŠ¥æ–‡æ®µï¼›æ­¤æ—¶ï¼Œä¸»æœº1è¿›å…¥FIN_WAIT_1çŠ¶æ€ï¼›è¿™è¡¨ç¤ºä¸»æœº1æ²¡æœ‰æ•°æ®è¦å‘é€ç»™ä¸»æœº2äº†ï¼› ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šä¸»æœº2æ”¶åˆ°äº†ä¸»æœº1å‘é€çš„FINæŠ¥æ–‡æ®µï¼Œå‘ä¸»æœº1å›ä¸€ä¸ªACKæŠ¥æ–‡æ®µï¼ŒAcknowledgment Numberä¸ºSequence NumberåŠ 1ï¼›ä¸»æœº1è¿›å…¥FIN_WAIT_2çŠ¶æ€ï¼›ä¸»æœº2å‘Šè¯‰ä¸»æœº1ï¼Œæˆ‘â€œåŒæ„â€ä½ çš„å…³é—­è¯·æ±‚ï¼› ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šä¸»æœº2å‘ä¸»æœº1å‘é€FINæŠ¥æ–‡æ®µï¼Œè¯·æ±‚å…³é—­è¿æ¥ï¼ŒåŒæ—¶ä¸»æœº2è¿›å…¥LAST_ACKçŠ¶æ€ï¼› ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šä¸»æœº1æ”¶åˆ°ä¸»æœº2å‘é€çš„FINæŠ¥æ–‡æ®µï¼Œå‘ä¸»æœº2å‘é€ACKæŠ¥æ–‡æ®µï¼Œç„¶åä¸»æœº1è¿›å…¥TIME_WAITçŠ¶æ€ï¼›ä¸»æœº2æ”¶åˆ°ä¸»æœº1çš„ACKæŠ¥æ–‡æ®µä»¥åï¼Œå°±å…³é—­è¿æ¥ï¼›æ­¤æ—¶ï¼Œä¸»æœº1ç­‰å¾…2MSLåä¾ç„¶æ²¡æœ‰æ”¶åˆ°å›å¤ï¼Œåˆ™è¯æ˜Serverç«¯å·²æ­£å¸¸å…³é—­ï¼Œé‚£å¥½ï¼Œä¸»æœº1ä¹Ÿå¯ä»¥å…³é—­è¿æ¥äº†ã€‚ ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ TCPåè®®æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„è¿è¾“å±‚é€šä¿¡åè®®ã€‚TCPæ˜¯å…¨åŒå·¥æ¨¡å¼ï¼Œè¿™å°±æ„å‘³ç€ï¼Œå½“ä¸»æœº1å‘å‡ºFINæŠ¥æ–‡æ®µæ—¶ï¼Œåªæ˜¯è¡¨ç¤ºä¸»æœº1å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä¸»æœº1å‘Šè¯‰ä¸»æœº2ï¼Œå®ƒçš„æ•°æ®å·²ç»å…¨éƒ¨å‘é€å®Œæ¯•äº†ï¼›ä½†æ˜¯ï¼Œè¿™ä¸ªæ—¶å€™ä¸»æœº1è¿˜æ˜¯å¯ä»¥æ¥å—æ¥è‡ªä¸»æœº2çš„æ•°æ®ï¼›å½“ä¸»æœº2è¿”å›ACKæŠ¥æ–‡æ®µæ—¶ï¼Œè¡¨ç¤ºå®ƒå·²ç»çŸ¥é“ä¸»æœº1æ²¡æœ‰æ•°æ®å‘é€äº†ï¼Œä½†æ˜¯ä¸»æœº2è¿˜æ˜¯å¯ä»¥å‘é€æ•°æ®åˆ°ä¸»æœº1çš„ï¼›å½“ä¸»æœº2ä¹Ÿå‘é€äº†FINæŠ¥æ–‡æ®µæ—¶ï¼Œè¿™ä¸ªæ—¶å€™å°±è¡¨ç¤ºä¸»æœº2ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œå°±ä¼šå‘Šè¯‰ä¸»æœº1ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä¹‹åå½¼æ­¤å°±ä¼šæ„‰å¿«çš„ä¸­æ–­è¿™æ¬¡TCPè¿æ¥ã€‚ ä¸Šè¿°åºå·8,9,10æ˜¯æˆ‘å…³é—­æµè§ˆå™¨åæŠ“åˆ°çš„åŒ…ï¼Œæ—¢ç„¶æ˜¯å…³é—­æµè§ˆå™¨ï¼Œæˆ‘ä»¬è‚¯å®šçŸ¥é“å°±æ˜¯TCPè¿æ¥çš„æ–­å¼€äº†ã€‚è¿™é‡Œæœ‰åŒå­¦åº”è¯¥å·²ç»å‘ç°äº†é—®é¢˜äº†ï¼Œæˆ‘ä»¬çš„æ–­å¼€æ˜¯4æ¬¡æŒ¥æ‰‹ï¼Œä½ è¿™æŠ“çš„åŒ…åªæœ‰ä¸‰æ¡è®°å½•ï¼Œæ˜¯ä½ å†™é”™äº†å§ï¼Ÿæˆ‘è¦å‘Šè¯‰ä½ çš„æ˜¯ï¼Œæˆ‘æ²¡æœ‰å†™é”™ï¼Œè¿™æ˜¯çœŸå®çš„æŠ“åŒ…æŠ“çš„ï¼Œè‡³äºä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼š åœ¨ RFC 2581ä¸­çš„4.2èŠ‚æœ‰æåˆ°ï¼Œackå¯ä»¥å»¶è¿Ÿç¡®è®¤ï¼Œåªè¦æ±‚ä¿è¯åœ¨500msä¹‹å†…ä¿è¯ç¡®è®¤åŒ…åˆ°è¾¾å³å¯ã€‚åœ¨è¿™æ ·çš„æ ‡å‡†ä¸‹ï¼ŒTCPç¡®è®¤æ˜¯æœ‰å¯èƒ½è¿›è¡Œåˆå¹¶å»¶è¿Ÿç¡®è®¤çš„ï¼Œæ‰€ä»¥ï¼Œæ ¹æ®è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ¨æ–­ä¸‹é¢è¿™ä¸ªåŒ…ï¼š 9) 8081 -&gt; 60738 [FIN ACK] Seq=120 Ack=397 Win=30336 Len=0 åˆå¹¶äº†å¯¹å®¢æˆ·ç«¯çš„ackç¡®è®¤ä»¥åŠæœåŠ¡ç«¯å‘é€çš„FINæ–­å¼€ä¿¡å·åŒ…ã€‚æˆ‘ä»¬ç‚¹å‡»è¯¥åŒ…è¯¦æƒ…å¦‚ä¸‹ï¼š è¿™é‡Œçº¢æ¡†ä¸­ä½“ç°äº†ï¼Œè¿™ä¸ª9å·åŒ…æ˜¯å¯¹Frame500çš„ACKç¡®è®¤ï¼Œæˆ‘ä»¬æ ¹æ®æœ€å¼€å§‹çš„æˆªå›¾å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªåŒ…å°±æ˜¯8å·åŒ… 8) 60738 -&gt; 8081 [FIN ACK] Seq=396 Ack=120 Win=66560 Len=0 å¹¶ä¸”9å·åŒ…æœ¬èº«è‡ªå·±æ˜¯å‘é€çš„FINä¿¡å·åŒ…ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸º9å·åŒ…åˆå¹¶äº†ACKå’ŒFINçš„å†…å®¹ï¼Œæ‰€ä»¥é€šå¸¸çš„4æ¬¡æŒ¥æ‰‹ï¼Œç»è¿‡åˆå¹¶åå˜æˆäº†3æ¬¡æŒ¥æ‰‹ã€‚ Keep-Aliveç­”æ¡ˆæ˜¯ï¼šç›®å‰çš„åè®®æ˜¯ä¸ç”¨çš„ åœ¨HTTP0.9ç‰ˆæœ¬å’ŒHTTP1.0ç‰ˆæœ¬ä¸­ï¼Œæ¯æ¬¡è¯·æ±‚å“åº”éƒ½æ˜¯è¦ä¸‰æ¬¡æ¡æ‰‹çš„ï¼Œ ä½†æ˜¯HTTP1.0å¼€å§‹å°è¯•æŒç»­è¿æ¥ï¼Œä¹Ÿå°±æ˜¯Keep-Aliveå‚æ•°ï¼Œä½†æ˜¯å®˜æ–¹è¿˜æ²¡æœ‰æ­£å¼æ”¯æŒï¼Œåœ¨HTTP1.1åè®®ä¸­ï¼Œå®˜æ–¹é»˜è®¤å°±æ˜¯æ”¯æŒKeep-Aliveå‚æ•°çš„ï¼Œé»˜è®¤æ˜¯æŒç»­è¿æ¥ã€‚Keep-Aliveçš„ä½œç”¨ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š 1.æ£€æŸ¥æ­»èŠ‚ç‚¹ ä¸»è¦æ˜¯ä¸ºäº†è®©è¿æ¥å¿«é€Ÿå¤±è´¥è¢«å‘ç°ï¼Œå¯ä»¥è¿›è¡Œé‡æ–°è¿æ¥ï¼Œæ¯”å¦‚Aå’ŒBä¸¤ç«¯å·²ç»å»ºç«‹äº†è¿æ¥ï¼ŒBèŠ‚ç‚¹å› ä¸º å¼‚å¸¸åŸå› æŒ‚æ‰äº†ï¼ŒåŒæ—¶AèŠ‚ç‚¹å¹¶ä¸çŸ¥é“ï¼Œè¿™æ—¶å€™æœ‰ä¸¤ç§æƒ…å†µï¼š 1.å‡è®¾BèŠ‚ç‚¹è¿˜æ²¡æœ‰æ¢å¤ï¼Œé‚£ä¹ˆBèŠ‚ç‚¹ä¸ä¼šå›å¤ACKï¼ŒAèŠ‚ç‚¹å°±ä¼šä¸€ç›´é‡è¯•ï¼Œé‡è¯•åˆ°ä¸€å®šæ¬¡æ•°æ‰èƒ½çŸ¥é“BèŠ‚ç‚¹æ˜¯æ­»èŠ‚ç‚¹ã€‚ 2.BèŠ‚ç‚¹åœ¨Aå‘é€æ•°æ®ä¹‹å‰é‡å¯æˆåŠŸäº†ï¼Œè¿™ä¸ªæ—¶å€™AèŠ‚ç‚¹å‘é€æ•°æ®ï¼ŒBèŠ‚ç‚¹å¹¶ä¸ä¼šæ¥å—ï¼Œè€Œæ˜¯ä¼šå‘é€ä¸€ä¸ªRSTä¿¡å·ï¼ˆåœ¨ä¸€ä¸ªå·²å…³é—­çš„socketä¸Šæ”¶åˆ°æ•°æ®æ—¶ï¼Œå°†å‘é€RSTæ•°æ®åŒ…ï¼Œè¦æ±‚å¯¹ç«¯å…³é—­å¼‚å¸¸è¿æ¥ä¸”å¯¹ç«¯ä¸éœ€è¦å›å¤ACKï¼‰,ç„¶åAæ‰çŸ¥é“BèŠ‚ç‚¹éœ€è¦é‡è¿äº†ã€‚ ä»¥ä¸Šä¸¤ç§æƒ…å†µï¼Œéƒ½ä¼šå¯¼è‡´åªæœ‰åˆ°å‘é€æ•°æ®çš„æ—¶å€™æ‰çŸ¥é“å¯¹æ–¹å·²ç»å‡ºå¼‚å¸¸äº†ã€‚è€ŒKeep-Aliveæ¯éš”ä¸€æ®µæ—¶é—´å°±ä¼šå‘é€å¿ƒè·³ï¼Œå°±å¯ä»¥å¾ˆå¿«çš„çŸ¥é“æœåŠ¡ç«¯èŠ‚ç‚¹çš„æƒ…å†µã€‚ 2.é˜²æ­¢è¿æ¥ç”±äºä¸æ´»è·ƒè€Œæ–­å¼€ æˆ‘ä»¬çŸ¥é“ï¼Œç½‘ç»œè¿æ¥çš„å»ºç«‹å’Œç»´æŒæ˜¯æ¶ˆè€—èµ„æºçš„ï¼Œä¸€ä¸ªæœåŠ¡å™¨ä¸Šèƒ½å»ºç«‹çš„è¿æ¥æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥åƒé˜²ç«å¢™æˆ–è€…æ“ä½œç³»ç»Ÿä¸­ä¼šä¸ºäº†èŠ‚çœèµ„æºä¼šé‡Šæ”¾æ‰ä¸æ´»è·ƒçš„è¿æ¥ï¼Œè€ŒKeep-Aliveæ¯éš”ä¸€æ®µæ—¶é—´å‘é€ä¸€ä¸ªå¿ƒè·³åŒ…ï¼Œå°±æ˜¯å‘Šè¯‰é˜²ç«å¢™æˆ–è€…æ“ä½œç³»ç»Ÿï¼Œæˆ‘è¿™ä¸ªè¿æ¥æ˜¯æ´»è·ƒçš„ï¼Œä¸è¦æ€æˆ‘ã€‚ åæ¥é‡æ–°æŠ“äº†ä¸€æ¬¡å¸¦æœ‰Keep-Aliveçš„åŒ…ï¼Œæˆªå›¾å¦‚ä¸‹ï¼š åœ¨ä¸Šå›¾ä¸­æœ€åä¸¤ä¸ªåŒ…å°±æ˜¯å‘çš„Keep-AliveåŒ…ï¼Œç„¶åæœåŠ¡ç«¯è¿›è¡ŒACKç¡®è®¤ï¼Œæˆ‘ä»¬çœ‹åˆ°keep-aliveåŒ…ï¼Œå®é™…ä¸Šæ˜¯ä¼šå‘å¸¦æœ‰ä¸€ä¸ªå­—èŠ‚çš„åŒ…ï¼Œè¿™å°±æ˜¯keep-aliveçš„å®ç°ã€‚ å®è§‚ä¸Šçš„è¾“å…¥ç½‘å€åå‘ç”Ÿçš„äº‹æƒ…å¦‚æœä½ ç”¨çš„æ˜¯ç”µè„‘å°å¼æœºï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šä½¿ç”¨å¸¦æ°´æ™¶å¤´çš„åŒç»çº¿è¿ä¸Šç½‘å£ï¼Œç”±äº¤æ¢æœºæ¥å…¥å›ºå®šç½‘ç»œã€‚å¦‚æœä½ ç”¨çš„æ˜¯æ‰‹æœºã€å¹³æ¿ç”µè„‘ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šé€šè¿‡èœ‚çªç½‘ç»œã€WiFiï¼Œç”±ç”µä¿¡åŸºç«™ã€æ— çº¿çƒ­ç‚¹æ¥å…¥ç§»åŠ¨ç½‘ç»œã€‚ æ¥å…¥ç½‘ç»œçš„åŒæ—¶ï¼Œç½‘ç»œè¿è¡Œå•†ä¼šç»™ä½ çš„è®¾å¤‡åˆ†é…ä¸€ä¸ª IP åœ°å€ï¼Œè¿™ä¸ªåœ°å€å¯èƒ½æ˜¯é™æ€åˆ†é…çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯åŠ¨æ€åˆ†é…çš„ã€‚é™æ€ IP å°±å§‹ç»ˆä¸å˜ï¼Œè€ŒåŠ¨æ€ IP å¯èƒ½ä½ ä¸‹æ¬¡ä¸Šç½‘å°±å˜äº†ã€‚ å‡è®¾ä½ è¦è®¿é—®çš„æ˜¯ Apple ç½‘ç«™ï¼Œæ˜¾ç„¶ä½ æ˜¯ä¸çŸ¥é“å®ƒçš„çœŸå® IP åœ°å€çš„ï¼Œåœ¨æµè§ˆå™¨é‡Œåªèƒ½ä½¿ç”¨åŸŸåâ€œwww.apple.comâ€è®¿é—®ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¦åšçš„å¿…ç„¶æ˜¯åŸŸåè§£æã€‚è¿™å°±è¦ç”¨ DNS åè®®å¼€å§‹ä»æ“ä½œç³»ç»Ÿã€æœ¬åœ° DNSã€æ ¹ DNSã€é¡¶çº§ DNSã€æƒå¨ DNS çš„å±‚å±‚è§£æï¼Œå½“ç„¶è¿™ä¸­é—´æœ‰ç¼“å­˜ï¼Œå¯èƒ½ä¸ä¼šè´¹å¤ªå¤šæ—¶é—´å°±èƒ½æ‹¿åˆ°ç»“æœã€‚ åˆ«å¿˜äº†äº’è”ç½‘ä¸Šè¿˜æœ‰å¦å¤–ä¸€ä¸ªé‡è¦çš„è§’è‰² CDNï¼Œå®ƒä¹Ÿä¼šåœ¨ DNS çš„è§£æè¿‡ç¨‹ä¸­â€œæ’ä¸Šä¸€è„šâ€ã€‚DNS è§£æå¯èƒ½ä¼šç»™å‡º CDN æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œè¿™æ ·ä½ æ‹¿åˆ°çš„å°±ä¼šæ˜¯ CDN æœåŠ¡å™¨è€Œä¸æ˜¯ç›®æ ‡ç½‘ç«™çš„å®é™…åœ°å€ã€‚ å› ä¸º CDN ä¼šç¼“å­˜ç½‘ç«™çš„å¤§éƒ¨åˆ†èµ„æºï¼Œæ¯”å¦‚å›¾ç‰‡ã€CSS æ ·å¼è¡¨ï¼Œæ‰€ä»¥æœ‰çš„ HTTP è¯·æ±‚å°±ä¸éœ€è¦å†å‘åˆ° Appleï¼ŒCDN å°±å¯ä»¥ç›´æ¥å“åº”ä½ çš„è¯·æ±‚ï¼ŒæŠŠæ•°æ®å‘ç»™ä½ ã€‚ ç”± PHPã€Java ç­‰åå°æœåŠ¡åŠ¨æ€ç”Ÿæˆçš„é¡µé¢å±äºâ€œåŠ¨æ€èµ„æºâ€ï¼ŒCDN æ— æ³•ç¼“å­˜ï¼Œåªèƒ½ä»ç›®æ ‡ç½‘ç«™è·å–ã€‚äºæ˜¯ä½ å‘å‡ºçš„ HTTP è¯·æ±‚å°±è¦å¼€å§‹åœ¨äº’è”ç½‘ä¸Šçš„â€œæ¼«é•¿è·‹æ¶‰â€ï¼Œç»è¿‡æ— æ•°çš„è·¯ç”±å™¨ã€ç½‘å…³ã€ä»£ç†ï¼Œæœ€ååˆ°è¾¾ç›®çš„åœ°ã€‚ ç›®æ ‡ç½‘ç«™çš„æœåŠ¡å™¨å¯¹å¤–è¡¨ç°çš„æ˜¯ä¸€ä¸ª IP åœ°å€ï¼Œä½†ä¸ºäº†èƒ½å¤Ÿæ‰›ä½é«˜å¹¶å‘ï¼Œåœ¨å†…éƒ¨ä¹Ÿæ˜¯ä¸€å¥—å¤æ‚çš„æ¶æ„ã€‚é€šå¸¸åœ¨å…¥å£æ˜¯è´Ÿè½½å‡è¡¡è®¾å¤‡ï¼Œä¾‹å¦‚å››å±‚çš„ LVS æˆ–è€…ä¸ƒå±‚çš„ Nginxï¼Œåœ¨åé¢æ˜¯è®¸å¤šçš„æœåŠ¡å™¨ï¼Œæ„æˆä¸€ä¸ªæ›´å¼ºæ›´ç¨³å®šçš„é›†ç¾¤ã€‚ è´Ÿè½½å‡è¡¡è®¾å¤‡ä¼šå…ˆè®¿é—®ç³»ç»Ÿé‡Œçš„ç¼“å­˜æœåŠ¡å™¨ï¼Œé€šå¸¸æœ‰ memory çº§ç¼“å­˜ Redis å’Œ disk çº§ç¼“å­˜ Varnishï¼Œå®ƒä»¬çš„ä½œç”¨ä¸ CDN ç±»ä¼¼ï¼Œä¸è¿‡æ˜¯å·¥ä½œåœ¨å†…éƒ¨ç½‘ç»œé‡Œï¼ŒæŠŠæœ€é¢‘ç¹è®¿é—®çš„æ•°æ®ç¼“å­˜å‡ ç§’é’Ÿæˆ–å‡ åˆ†é’Ÿï¼Œå‡è½»åç«¯åº”ç”¨æœåŠ¡å™¨çš„å‹åŠ›ã€‚ å¦‚æœç¼“å­˜æœåŠ¡å™¨é‡Œä¹Ÿæ²¡æœ‰ï¼Œé‚£ä¹ˆè´Ÿè½½å‡è¡¡è®¾å¤‡å°±è¦æŠŠè¯·æ±‚è½¬å‘ç»™åº”ç”¨æœåŠ¡å™¨äº†ã€‚è¿™é‡Œå°±æ˜¯å„ç§å¼€å‘æ¡†æ¶å¤§æ˜¾ç¥é€šçš„åœ°æ–¹äº†ï¼Œä¾‹å¦‚ Java çš„ Tomcat/Netty/Jettyï¼ŒPython çš„ Djangoï¼Œè¿˜æœ‰ PHPã€Node.jsã€Golang ç­‰ç­‰ã€‚å®ƒä»¬åˆä¼šå†è®¿é—®åé¢çš„ MySQLã€PostgreSQLã€MongoDB ç­‰æ•°æ®åº“æœåŠ¡ï¼Œå®ç°ç”¨æˆ·ç™»å½•ã€å•†å“æŸ¥è¯¢ã€è´­ç‰©ä¸‹å•ã€æ‰£æ¬¾æ”¯ä»˜ç­‰ä¸šåŠ¡æ“ä½œï¼Œç„¶åæŠŠæ‰§è¡Œçš„ç»“æœè¿”å›ç»™è´Ÿè½½å‡è¡¡è®¾å¤‡ï¼ŒåŒæ—¶ä¹Ÿå¯èƒ½ç»™ç¼“å­˜æœåŠ¡å™¨é‡Œä¹Ÿæ”¾ä¸€ä»½ã€‚ åº”ç”¨æœåŠ¡å™¨çš„è¾“å‡ºåˆ°äº†è´Ÿè½½å‡è¡¡è®¾å¤‡è¿™é‡Œï¼Œè¯·æ±‚çš„å¤„ç†å°±ç®—æ˜¯å®Œæˆäº†ï¼Œå°±è¦æŒ‰ç…§åŸè·¯å†èµ°å›å»ï¼Œè¿˜æ˜¯è¦ç»è¿‡è®¸å¤šçš„è·¯ç”±å™¨ã€ç½‘å…³ã€ä»£ç†ã€‚å¦‚æœè¿™ä¸ªèµ„æºå…è®¸ç¼“å­˜ï¼Œé‚£ä¹ˆç»è¿‡ CDN çš„æ—¶å€™å®ƒä¹Ÿä¼šåšç¼“å­˜ï¼Œè¿™æ ·ä¸‹æ¬¡åŒæ ·çš„è¯·æ±‚å°±ä¸ä¼šåˆ°è¾¾æºç«™äº†ã€‚ æœ€åç½‘ç«™çš„å“åº”æ•°æ®å›åˆ°äº†ä½ çš„è®¾å¤‡ï¼Œå®ƒå¯èƒ½æ˜¯ HTMLã€JSONã€å›¾ç‰‡æˆ–è€…å…¶ä»–æ ¼å¼çš„æ•°æ®ï¼Œéœ€è¦ç”±æµè§ˆå™¨è§£æå¤„ç†æ‰èƒ½æ˜¾ç¤ºå‡ºæ¥ï¼Œå¦‚æœæ•°æ®é‡Œé¢è¿˜æœ‰è¶…é“¾æ¥ï¼ŒæŒ‡å‘åˆ«çš„èµ„æºï¼Œé‚£ä¹ˆå°±åˆè¦é‡èµ°ä¸€éæ•´ä¸ªæµç¨‹ï¼Œç›´åˆ°æ‰€æœ‰çš„èµ„æºéƒ½ä¸‹è½½å®Œã€‚","categories":[],"tags":[{"name":"http","slug":"http","permalink":"https://tsunamigg.github.io/tags/http/"}]},{"title":"4.httpä¸–ç•Œ","slug":"http4","date":"2019-06-18T13:32:25.000Z","updated":"2020-06-01T14:36:45.500Z","comments":true,"path":"2019/06/18/http4/","link":"","permalink":"https://tsunamigg.github.io/2019/06/18/http4/","excerpt":"httpçš„è¿è¡Œä¾èµ–äºä¸‹å±‚çš„TCP/IPï¼Œç»ä¸æ˜¯å•æ‰“ç‹¬æ–—ã€‚ é•¿æ–‡è­¦å‘Š","text":"httpçš„è¿è¡Œä¾èµ–äºä¸‹å±‚çš„TCP/IPï¼Œç»ä¸æ˜¯å•æ‰“ç‹¬æ–—ã€‚ é•¿æ–‡è­¦å‘Š çŸ¥è¯†map httpæ˜¯æ•´ä¸ªOSIå…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯å•æ‰“ç‹¬æ–—çš„å¤§ä¾ ï¼Œä¸å…¶ç›¸å…³çš„åè®®æœ‰å¾ˆå¤šï¼šTCP/IPã€DNSã€URIã€HTTPS ç­‰ã€‚æˆ‘ä»¬åº”è¯¥å¼„æ¸…æ¥šä»–ä»¬çš„è”ç³»ã€‚ åº”è¯¥äº†è§£æ–¹æ–¹é¢é¢æˆ‘ä»¬èƒ½å¤Ÿè¯´ æˆ‘ä»¬ç†Ÿæ‚‰æŸç§ä¸œè¥¿ï¼Œç»ä¸ä»…ä»…æ˜¯èƒ½å¤Ÿå°†å®ƒçš„æ¦‚å¿µè¯´æ¸…æ¥šï¼Œè€Œåº”è¯¥äº†è§£å®ƒå¤„äºæ•´ä¸ªä½“ç³»ä¸­çš„ä½ç½®ï¼Œä»¥åŠå®ƒçš„å„ç§åº”ç”¨åœºæ™¯ã€‚å»ºç«‹èµ·è‡ªå·±çš„æ•´ä¸ªçŸ¥è¯†ç»“æ„ï¼Œè€Œä¸æ˜¯é›¶æ•£çš„çŸ¥è¯†ç‚¹ã€‚ æµè§ˆå™¨æµè§ˆå™¨çš„æ­£å¼åå­—å«â€œWeb Browserâ€ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯æ£€ç´¢ã€æŸ¥çœ‹äº’è”ç½‘ä¸Šç½‘é¡µèµ„æºçš„åº”ç”¨ç¨‹åºã€‚åå­—é‡Œçš„ Webï¼Œå®é™…ä¸ŠæŒ‡çš„å°±æ˜¯â€œWorld Wide Webâ€ï¼Œä¹Ÿå°±æ˜¯ä¸‡ç»´ç½‘ã€‚ æµè§ˆå™¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª HTTP åè®®ä¸­çš„è¯·æ±‚æ–¹ï¼Œä½¿ç”¨ HTTP åè®®è·å–ç½‘ç»œä¸Šçš„å„ç§èµ„æºã€‚å½“ç„¶ï¼Œä¸ºäº†è®©æˆ‘ä»¬æ›´å¥½åœ°æ£€ç´¢æŸ¥çœ‹ç½‘é¡µï¼Œå®ƒè¿˜é›†æˆäº†å¾ˆå¤šé¢å¤–çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼ŒHTML æ’ç‰ˆå¼•æ“ç”¨æ¥å±•ç¤ºé¡µé¢ï¼ŒJavaScript å¼•æ“ç”¨æ¥å®ç°åŠ¨æ€åŒ–æ•ˆæœï¼Œç”šè‡³è¿˜æœ‰å¼€å‘è€…å·¥å…·ç”¨æ¥è°ƒè¯•ç½‘é¡µï¼Œä»¥åŠäº”èŠ±å…«é—¨çš„å„ç§æ’ä»¶å’Œæ‰©å±•ã€‚ åœ¨ HTTP åè®®é‡Œï¼Œæµè§ˆå™¨çš„è§’è‰²è¢«ç§°ä¸ºâ€œUser Agentâ€å³â€œç”¨æˆ·ä»£ç†â€ï¼Œæ„æ€æ˜¯ä½œä¸ºè®¿é—®è€…çš„â€œä»£ç†â€æ¥å‘èµ· HTTP è¯·æ±‚ã€‚ä¸è¿‡åœ¨ä¸å¼•èµ·æ··æ·†çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸éƒ½ç®€å•åœ°ç§°ä¹‹ä¸ºâ€œå®¢æˆ·ç«¯â€ã€‚ webæœåŠ¡å™¨Web æœåŠ¡å™¨æ˜¯ä¸€ä¸ªå¾ˆå¤§ä¹Ÿå¾ˆé‡è¦çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ HTTP åè®®é‡Œå“åº”è¯·æ±‚çš„ä¸»ä½“ï¼Œé€šå¸¸ä¹ŸæŠŠæ§ç€ç»å¤§å¤šæ•°çš„ç½‘ç»œèµ„æºï¼Œåœ¨ç½‘ç»œä¸–ç•Œé‡Œå¤„äºå¼ºåŠ¿åœ°ä½ã€‚ å½“æˆ‘ä»¬è°ˆåˆ°â€œWeb æœåŠ¡å™¨â€æ—¶æœ‰ä¸¤ä¸ªå±‚é¢çš„å«ä¹‰ï¼šç¡¬ä»¶å’Œè½¯ä»¶ã€‚ ç¡¬ä»¶å«ä¹‰å°±æ˜¯ç‰©ç†å½¢å¼æˆ–â€œäº‘â€å½¢å¼çš„æœºå™¨ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å®ƒå¯èƒ½ä¸æ˜¯ä¸€å°æœåŠ¡å™¨ï¼Œè€Œæ˜¯åˆ©ç”¨åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ç­‰æŠ€æœ¯ç»„æˆçš„åºå¤§é›†ç¾¤ã€‚ä½†ä»å¤–ç•Œçœ‹æ¥ï¼Œå®ƒä»ç„¶è¡¨ç°ä¸ºä¸€å°æœºå™¨ï¼Œä½†è¿™ä¸ªå½¢è±¡æ˜¯â€œè™šæ‹Ÿçš„â€ï¼Œå„ç§é˜¿é‡Œäº‘ï¼Œè…¾è®¯äº‘â€¦ è½¯ä»¶å«ä¹‰çš„ Web æœåŠ¡å™¨å¯èƒ½æˆ‘ä»¬æ›´ä¸ºå…³å¿ƒï¼Œå®ƒå°±æ˜¯æä¾› Web æœåŠ¡çš„åº”ç”¨ç¨‹åºï¼Œé€šå¸¸ä¼šè¿è¡Œåœ¨ç¡¬ä»¶å«ä¹‰çš„æœåŠ¡å™¨ä¸Šã€‚å®ƒåˆ©ç”¨å¼ºå¤§çš„ç¡¬ä»¶èƒ½åŠ›å“åº”æµ·é‡çš„å®¢æˆ·ç«¯ HTTP è¯·æ±‚ï¼Œå¤„ç†ç£ç›˜ä¸Šçš„ç½‘é¡µã€å›¾ç‰‡ç­‰é™æ€æ–‡ä»¶ï¼Œæˆ–è€…æŠŠè¯·æ±‚è½¬å‘ç»™åé¢çš„ Tomcatã€Node.js ç­‰ä¸šåŠ¡åº”ç”¨ï¼Œè¿”å›åŠ¨æ€çš„ä¿¡æ¯ã€‚ æ¯”èµ·å±‚å‡ºä¸ç©·çš„å„ç§ Web æµè§ˆå™¨ï¼ŒWeb æœåŠ¡å™¨å°±è¦å°‘å¾ˆå¤šäº†ï¼Œä¸€åªæ‰‹çš„æ‰‹æŒ‡å¤´å°±å¯ä»¥æ•°å¾—è¿‡æ¥ã€‚ Apache æ˜¯è€ç‰Œçš„æœåŠ¡å™¨ï¼Œåˆ°ä»Šå¤©å·²ç»å¿« 25 å¹´äº†ï¼ŒåŠŸèƒ½ç›¸å½“å®Œå–„ï¼Œç›¸å…³çš„èµ„æ–™å¾ˆå¤šï¼Œå­¦ä¹ é—¨æ§›ä½ï¼Œæ˜¯è®¸å¤šåˆ›ä¸šè€…å»ºç«™çš„å…¥é—¨äº§å“ Nginx æ˜¯ Web æœåŠ¡å™¨é‡Œçš„åèµ·ä¹‹ç§€ï¼Œç‰¹ç‚¹æ˜¯é«˜æ€§èƒ½ã€é«˜ç¨³å®šï¼Œä¸”æ˜“äºæ‰©å±•ã€‚è‡ª 2004 å¹´æ¨å‡ºåå°±ä¸æ–­èš•é£Ÿ Apache çš„å¸‚åœºä»½é¢ï¼Œåœ¨é«˜æµé‡çš„ç½‘ç«™é‡Œæ›´æ˜¯ä¸äºŒä¹‹é€‰ è¿˜æœ‰ Windows ä¸Šçš„ IISã€Java çš„ Jetty/Tomcat ç­‰ï¼Œå› ä¸ºæ€§èƒ½ä¸æ˜¯å¾ˆé«˜ï¼Œæ‰€ä»¥åœ¨äº’è”ç½‘ä¸Šåº”ç”¨å¾—è¾ƒå°‘ CDNå…¨ç§°æ˜¯â€œContent Delivery Networkâ€ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯â€œå†…å®¹åˆ†å‘ç½‘ç»œâ€ã€‚å®ƒåº”ç”¨äº† HTTP åè®®é‡Œçš„ç¼“å­˜å’Œä»£ç†æŠ€æœ¯ï¼Œä»£æ›¿æºç«™å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ åœ¨httpæœåŠ¡çš„ä¸¤ç«¯ï¼Œå¹¶ä¸æ˜¯ç›´æ¥è¿æ¥çš„ï¼Œä¸­é—´çš„éƒ¨åˆ†çš„ä¸€ä¸ªé‡è¦è§’è‰²å°±æ˜¯CDNã€‚ CDNçš„å¥½å¤„æ˜¯ï¼šå®ƒå¯ä»¥ç¼“å­˜æºç«™çš„æ•°æ®ï¼Œè®©æµè§ˆå™¨çš„è¯·æ±‚ä¸ç”¨â€œåƒé‡Œè¿¢è¿¢â€åœ°åˆ°è¾¾æºç«™æœåŠ¡å™¨ï¼Œç›´æ¥åœ¨â€œåŠè·¯â€å°±å¯ä»¥è·å–å“åº”ã€‚å¦‚æœ CDN çš„è°ƒåº¦ç®—æ³•å¾ˆä¼˜ç§€ï¼Œæ›´å¯ä»¥æ‰¾åˆ°ç¦»ç”¨æˆ·æœ€è¿‘çš„èŠ‚ç‚¹ï¼Œå¤§å¹…åº¦ç¼©çŸ­å“åº”æ—¶é—´ã€‚ CDN ä¹Ÿæ˜¯ç°åœ¨äº’è”ç½‘ä¸­çš„ä¸€é¡¹é‡è¦åŸºç¡€è®¾æ–½ï¼Œé™¤äº†åŸºæœ¬çš„ç½‘ç»œåŠ é€Ÿå¤–ï¼Œè¿˜æä¾›è´Ÿè½½å‡è¡¡ã€å®‰å…¨é˜²æŠ¤ã€è¾¹ç¼˜è®¡ç®—ã€è·¨è¿è¥å•†ç½‘ç»œç­‰åŠŸèƒ½ï¼Œèƒ½å¤Ÿæˆå€åœ°â€œæ”¾å¤§â€æºç«™æœåŠ¡å™¨çš„æœåŠ¡èƒ½åŠ›ï¼Œå¾ˆå¤šäº‘æœåŠ¡å•†éƒ½æŠŠ CDN ä½œä¸ºäº§å“çš„ä¸€éƒ¨åˆ†ã€‚ çˆ¬è™«å‰é¢è¯´åˆ°è¿‡æµè§ˆå™¨ï¼Œå®ƒæ˜¯ä¸€ç§ç”¨æˆ·ä»£ç†ï¼Œä»£æ›¿æˆ‘ä»¬è®¿é—®äº’è”ç½‘ã€‚ ä½† HTTP åè®®å¹¶æ²¡æœ‰è§„å®šç”¨æˆ·ä»£ç†åé¢å¿…é¡»æ˜¯â€œçœŸæ­£çš„äººç±»â€ï¼Œå®ƒä¹Ÿå®Œå…¨å¯ä»¥æ˜¯â€œæœºå™¨äººâ€ï¼Œè¿™äº›â€œæœºå™¨äººâ€çš„æ­£å¼åç§°å°±å«åšâ€œçˆ¬è™«â€ï¼ˆCrawlerï¼‰ï¼Œå®é™…ä¸Šæ˜¯ä¸€ç§å¯ä»¥è‡ªåŠ¨è®¿é—® Web èµ„æºçš„åº”ç”¨ç¨‹åºã€‚ â€œçˆ¬è™«â€è¿™ä¸ªåå­—éå¸¸å½¢è±¡ï¼Œå®ƒä»¬å°±åƒæ˜¯ä¸€åªåªä¸çŸ¥ç–²å€¦çš„ã€è¾›å‹¤çš„èš‚èšï¼Œåœ¨æ— è¾¹æ— é™…çš„ç½‘ç»œä¸Šçˆ¬æ¥çˆ¬å»ï¼Œä¸åœåœ°åœ¨ç½‘ç«™é—´å¥”èµ°ï¼Œæœé›†æŠ“å–å„ç§ä¿¡æ¯ã€‚ æ®ä¼°è®¡ï¼Œäº’è”ç½‘ä¸Šè‡³å°‘æœ‰ 50% çš„æµé‡éƒ½æ˜¯ç”±çˆ¬è™«äº§ç”Ÿçš„ï¼ŒæŸäº›ç‰¹å®šé¢†åŸŸçš„æ¯”ä¾‹è¿˜ä¼šæ›´é«˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ çš„ç½‘ç«™ä»Šå¤©çš„è®¿é—®é‡æ˜¯åä¸‡ï¼Œé‚£ä¹ˆé‡Œé¢è‡³å°‘æœ‰äº”å…­ä¸‡æ˜¯çˆ¬è™«æœºå™¨äººï¼Œè€Œä¸æ˜¯çœŸå®çš„ç”¨æˆ·ã€‚ çˆ¬è™«æ€ä¹ˆæ¥çš„ï¼Ÿ ç»å¤§å¤šæ•°æ˜¯ç”±å„å¤§æœç´¢å¼•æ“â€œæ”¾â€å‡ºæ¥çš„ï¼ŒæŠ“å–ç½‘é¡µå­˜å…¥åºå¤§çš„æ•°æ®åº“ï¼Œå†å»ºç«‹å…³é”®å­—ç´¢å¼•ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å¤Ÿåœ¨æœç´¢å¼•æ“ä¸­å¿«é€Ÿåœ°æœç´¢åˆ°äº’è”ç½‘è§’è½é‡Œçš„é¡µé¢ã€‚ çˆ¬è™«ä¹Ÿæœ‰ä¸å¥½çš„ä¸€é¢ï¼Œå®ƒä¼šè¿‡åº¦æ¶ˆè€—ç½‘ç»œèµ„æºï¼Œå ç”¨æœåŠ¡å™¨å’Œå¸¦å®½ï¼Œå½±å“ç½‘ç«™å¯¹çœŸå®æ•°æ®çš„åˆ†æï¼Œç”šè‡³å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„æ¼ã€‚æ‰€ä»¥ï¼Œåˆå‡ºç°äº†â€œåçˆ¬è™«â€æŠ€æœ¯ï¼Œé€šè¿‡å„ç§æ‰‹æ®µæ¥é™åˆ¶çˆ¬è™«ã€‚å…¶ä¸­ä¸€é¡¹å°±æ˜¯â€œå›å­åå®šâ€robots.txtï¼Œçº¦å®šå“ªäº›è¯¥çˆ¬ï¼Œå“ªäº›ä¸è¯¥çˆ¬ã€‚ Web ServiceWeb Service æ˜¯ä¸€ç§ç”± W3C å®šä¹‰çš„åº”ç”¨æœåŠ¡å¼€å‘è§„èŒƒï¼Œä½¿ç”¨ client-server ä¸»ä»æ¶æ„ï¼Œé€šå¸¸ä½¿ç”¨ WSDL å®šä¹‰æœåŠ¡æ¥å£ï¼Œä½¿ç”¨ HTTP åè®®ä¼ è¾“ XML æˆ– SOAP æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäº Webï¼ˆHTTPï¼‰çš„æœåŠ¡æ¶æ„æŠ€æœ¯ï¼Œæ—¢å¯ä»¥è¿è¡Œåœ¨å†…ç½‘ï¼Œä¹Ÿå¯ä»¥åœ¨é€‚å½“ä¿æŠ¤åè¿è¡Œåœ¨å¤–ç½‘ã€‚ å› ä¸ºé‡‡ç”¨äº† HTTP åè®®ä¼ è¾“æ•°æ®ï¼Œæ‰€ä»¥åœ¨ Web Service æ¶æ„é‡ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å¯ä»¥é‡‡ç”¨ä¸åŒçš„æ“ä½œç³»ç»Ÿæˆ–ç¼–ç¨‹è¯­è¨€å¼€å‘ã€‚ä¾‹å¦‚æœåŠ¡å™¨ç«¯ç”¨ Linux+Javaï¼Œå®¢æˆ·ç«¯ç”¨ Windows+C#ï¼Œå…·æœ‰è·¨å¹³å°è·¨è¯­è¨€çš„ä¼˜ç‚¹ã€‚ WAFWAF æ˜¯è¿‘å‡ å¹´æ¯”è¾ƒâ€œç«â€çš„ä¸€ä¸ªè¯ï¼Œæ„æ€æ˜¯â€œç½‘ç»œåº”ç”¨é˜²ç«å¢™â€ã€‚ä¸ç¡¬ä»¶â€œé˜²ç«å¢™â€ç±»ä¼¼ï¼Œå®ƒæ˜¯åº”ç”¨å±‚é¢çš„â€œé˜²ç«å¢™â€ï¼Œä¸“é—¨æ£€æµ‹ HTTP æµé‡ï¼Œæ˜¯é˜²æŠ¤ Web åº”ç”¨çš„å®‰å…¨æŠ€æœ¯ã€‚ WAF é€šå¸¸ä½äº Web æœåŠ¡å™¨ä¹‹å‰ï¼Œå¯ä»¥é˜»æ­¢å¦‚ SQL æ³¨å…¥ã€è·¨ç«™è„šæœ¬ç­‰æ”»å‡»ï¼Œç›®å‰åº”ç”¨è¾ƒå¤šçš„ä¸€ä¸ªå¼€æºé¡¹ç›®æ˜¯ ModSecurityï¼Œå®ƒèƒ½å¤Ÿå®Œå…¨é›†æˆè¿› Apache æˆ– Nginxã€‚ TCP/IPTCP/IP åè®®å®é™…ä¸Šæ˜¯ä¸€ç³»åˆ—ç½‘ç»œé€šä¿¡åè®®çš„ç»Ÿç§°ï¼Œå…¶ä¸­æœ€æ ¸å¿ƒçš„ä¸¤ä¸ªåè®®æ˜¯ TCP å’Œ IPï¼Œå…¶ä»–çš„è¿˜æœ‰ UDPã€ICMPã€ARP ç­‰ç­‰ï¼Œå…±åŒæ„æˆäº†ä¸€ä¸ªå¤æ‚ä½†æœ‰å±‚æ¬¡çš„åè®®æ ˆã€‚è¿™ä¸ªåè®®æ ˆæœ‰å››å±‚ï¼Œæœ€ä¸Šå±‚æ˜¯â€œåº”ç”¨å±‚â€ï¼Œæœ€ä¸‹å±‚æ˜¯â€œé“¾æ¥å±‚â€ï¼ŒTCP å’Œ IP åˆ™åœ¨ä¸­é—´ï¼šTCP å±äºâ€œä¼ è¾“å±‚â€ï¼ŒIP å±äºâ€œç½‘é™…å±‚â€ã€‚åè®®çš„å±‚çº§å…³ç³»æ¨¡å‹éå¸¸é‡è¦ã€‚ IP åè®®æ˜¯â€œInternet Protocolâ€çš„ç¼©å†™ï¼Œä¸»è¦ç›®çš„æ˜¯è§£å†³å¯»å€å’Œè·¯ç”±é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•åœ¨ä¸¤ç‚¹é—´ä¼ é€æ•°æ®åŒ…ã€‚IP åè®®ä½¿ç”¨â€œIP åœ°å€â€çš„æ¦‚å¿µæ¥å®šä½äº’è”ç½‘ä¸Šçš„æ¯ä¸€å°è®¡ç®—æœºã€‚ ç±»æ¯”å‡ºç”Ÿå–åå­—ä¸€æ ·ï¼Œåå­—çš„å¾ˆå¤§ä¸€ä¸ªç›®çš„ï¼Œæ˜¯ä¸ºäº†ä¸ä»–äººåŒºåˆ†å¼€æ¥ï¼ŒIPåˆ™æ˜¯ä¸ºäº†æ ‡æ˜ä½ åœ¨äº’è”ç½‘çš„èº«ä»½ã€‚ å¯ä»¥å¯¹æ¯”ä¸€ä¸‹ç°å®ä¸­çš„ç”µè¯ç³»ç»Ÿï¼Œä½ æ‹¿ç€çš„æ‰‹æœºç›¸å½“äºäº’è”ç½‘ä¸Šçš„è®¡ç®—æœºï¼Œè€Œè¦æ‰“ç”µè¯å°±å¿…é¡»æ¥å…¥ç”µè¯ç½‘ï¼Œç”±é€šä¿¡å…¬å¸ç»™ä½ åˆ†é…ä¸€ä¸ªå·ç ï¼Œè¿™ä¸ªå·ç å°±ç›¸å½“äº IP åœ°å€ã€‚ ç°åœ¨æˆ‘ä»¬ä½¿ç”¨çš„ IP åè®®å¤§å¤šæ•°æ˜¯ v4 ç‰ˆï¼Œåœ°å€æ˜¯å››ä¸ªç”¨â€œ.â€åˆ†éš”çš„æ•°å­—ï¼Œä¾‹å¦‚â€œ192.168.0.1â€ï¼Œæ€»å…±æœ‰ 2^32ï¼Œå¤§çº¦ 42 äº¿ä¸ªå¯ä»¥åˆ†é…çš„åœ°å€ã€‚çœ‹ä¸Šå»å¥½åƒå¾ˆå¤šï¼Œä½†äº’è”ç½‘çš„å¿«é€Ÿå‘å±•è®©åœ°å€çš„åˆ†é…ç®¡ç†å¾ˆå¿«å°±â€œæ‰è¥Ÿè§è‚˜â€ã€‚æ‰€ä»¥ï¼Œå°±åˆå‡ºç°äº† v6 ç‰ˆï¼Œä½¿ç”¨ 8 ç»„â€œ:â€åˆ†éš”çš„æ•°å­—ä½œä¸ºåœ°å€ï¼Œå®¹é‡æ‰©å¤§äº†å¾ˆå¤šï¼Œæœ‰ 2^128 ä¸ªï¼Œåœ¨æœªæ¥çš„å‡ åå¹´é‡Œåº”è¯¥æ˜¯è¶³å¤Ÿç”¨äº† TCP åè®®æ˜¯â€œTransmission Control Protocolâ€çš„ç¼©å†™ï¼Œæ„æ€æ˜¯â€œä¼ è¾“æ§åˆ¶åè®®â€ï¼Œå®ƒä½äº IP åè®®ä¹‹ä¸Šï¼ŒåŸºäº IP åè®®æä¾›å¯é çš„ã€å­—èŠ‚æµå½¢å¼çš„é€šä¿¡ï¼Œæ˜¯ HTTP åè®®å¾—ä»¥å®ç°çš„åŸºç¡€ã€‚ â€œå¯é â€æ˜¯æŒ‡ä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼Œâ€œå­—èŠ‚æµâ€æ˜¯æŒ‡ä¿è¯æ•°æ®å®Œæ•´ï¼Œæ‰€ä»¥åœ¨ TCP åè®®çš„ä¸¤ç«¯å¯ä»¥å¦‚åŒæ“ä½œæ–‡ä»¶ä¸€æ ·è®¿é—®ä¼ è¾“çš„æ•°æ®ï¼Œå°±åƒæ˜¯è¯»å†™åœ¨ä¸€ä¸ªå¯†é—­çš„ç®¡é“é‡Œâ€œæµåŠ¨â€çš„å­—èŠ‚ã€‚ åŸŸååŸŸåæ˜¯ä¸€ä¸ªæœ‰å±‚æ¬¡çš„ç»“æ„ï¼Œæ˜¯ä¸€ä¸²ç”¨â€œ.â€åˆ†éš”çš„å¤šä¸ªå•è¯ï¼Œæœ€å³è¾¹çš„è¢«ç§°ä¸ºâ€œé¡¶çº§åŸŸåâ€ï¼Œç„¶åæ˜¯â€œäºŒçº§åŸŸåâ€ï¼Œå±‚çº§å…³ç³»å‘å·¦ä¾æ¬¡é™ä½ã€‚ ä¾‹å¦‚ï¼š www.time.geekbang.org =&gt; [com]æ˜¯é¡¶çº§åŸŸåï¼Œ[geekbang]æ˜¯äºŒçº§åŸŸåï¼Œ[time]æ˜¯ä¸»æœºåï¼Œ[www]åˆ™æ˜¯ä¸‡ç»´ç½‘ã€‚ è¿™æ ·åˆ’åˆ†çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„, www.time.a.org ä¸ www.time.b.orgï¼›åˆ†å±‚ä½¿å¾—å…¶ç§°ä¸ºä¸€ä¸ªä¸ªåå­—ç©ºé—´ç³»ç»Ÿï¼Œä½¿ç”¨å¤šçº§åŸŸåå°±å¯ä»¥åˆ’åˆ†å‡ºä¸åŒçš„å›½å®¶ã€åœ°åŒºã€ç»„ç»‡ã€å…¬å¸ã€éƒ¨é—¨ï¼Œæ¯ä¸ªåŸŸåéƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå¯ä»¥ä½œä¸ºä¸€ç§èº«ä»½çš„æ ‡è¯†ã€‚ DNSåœ¨ TCP/IP åè®®ä¸­ä½¿ç”¨ IP åœ°å€æ¥æ ‡è¯†è®¡ç®—æœºï¼Œæ•°å­—å½¢å¼çš„åœ°å€å¯¹äºè®¡ç®—æœºæ¥è¯´æ˜¯æ–¹ä¾¿äº†ï¼Œä½†äººç±»ä¸å¥½åˆ†è¾¨ï¼Œäºæ˜¯â€œåŸŸåç³»ç»Ÿâ€ï¼ˆDomain Name Systemï¼‰å‡ºç°äº†ï¼Œç”¨æœ‰æ„ä¹‰çš„åå­—æ¥ä½œä¸º IP åœ°å€çš„ç­‰ä»·æ›¿ä»£ã€‚è®¾æƒ³ä¸€ä¸‹ï¼Œä½ æ˜¯æ„¿æ„è®°â€œ95.211.80.227â€è¿™æ ·æ¯ç‡¥çš„æ•°å­—ï¼Œè¿˜æ˜¯â€œnginx.orgâ€è¿™æ ·çš„è¯ç»„å‘¢ï¼Ÿ åŸŸåç”¨â€œ.â€åˆ†éš”æˆå¤šä¸ªå•è¯ï¼Œçº§åˆ«ä»å·¦åˆ°å³é€çº§å‡é«˜ï¼Œæœ€å³è¾¹çš„è¢«ç§°ä¸ºâ€œé¡¶çº§åŸŸåâ€ã€‚å¯¹äºé¡¶çº§åŸŸåï¼Œå¯èƒ½ä½ éšå£å°±èƒ½è¯´å‡ºå‡ ä¸ªï¼Œä¾‹å¦‚è¡¨ç¤ºå•†ä¸šå…¬å¸çš„â€œcomâ€ã€è¡¨ç¤ºæ•™è‚²æœºæ„çš„â€œeduâ€ï¼Œè¡¨ç¤ºå›½å®¶çš„â€œcnâ€â€œukâ€ç­‰ï¼Œä¹°ç«è½¦ç¥¨æ—¶çš„åŸŸåè¿˜è®°å¾—å—ï¼Ÿæ˜¯â€œwww.12306.cnâ€ã€‚ å¾ˆå¤šäººåœ¨å®¶ç¬¬ä¸€æ¬¡è®¾ç½®WiFiæ—¶ï¼Œéƒ½å«ä½ å«æ‰“å¼€198.128.1ä¹‹ç±»çš„ï¼Œä¹Ÿå¯ä»¥è®¿é—®webï¼Œwww.baidu.comä¹Ÿå¯ä»¥è®¿é—®webï¼Œwhy? è¿™å°±æ˜¯åŸŸåè§£æã€‚ HTTP åè®®ä¸­å¹¶æ²¡æœ‰æ˜ç¡®è¦æ±‚å¿…é¡»ä½¿ç”¨ DNSï¼Œä½†å®é™…ä¸Šä¸ºäº†æ–¹ä¾¿è®¿é—®äº’è”ç½‘ä¸Šçš„ Web æœåŠ¡å™¨ï¼Œé€šå¸¸éƒ½ä¼šä½¿ç”¨ DNS æ¥å®šä½æˆ–æ ‡è®°ä¸»æœºåï¼Œé—´æ¥åœ°æŠŠ DNS ä¸ HTTP ç»‘åœ¨äº†ä¸€èµ·ã€‚ åŸŸåè§£ææŠŠåŸŸååšä¸€ä¸ªè½¬æ¢ï¼Œâ€œæ˜ å°„â€åˆ°å®ƒçš„çœŸå® IPã€‚åŸŸåè§£æå®é™…å¾ˆå¤æ‚ï¼Œå› ä¸ºäº’è”ç½‘ä¸Šçš„ç”µè„‘å®åœ¨æ˜¯å¤ªå¤šäº†ã€‚ç›®å‰å…¨ä¸–ç•Œæœ‰ 13 ç»„æ ¹ DNS æœåŠ¡å™¨ï¼Œä¸‹é¢å†æœ‰è®¸å¤šçš„é¡¶çº§ DNSã€æƒå¨ DNS å’Œæ›´å°çš„æœ¬åœ° DNSï¼Œé€å±‚é€’å½’åœ°å®ç°åŸŸåæŸ¥è¯¢ã€‚ DNS çš„æ ¸å¿ƒç³»ç»Ÿæ˜¯ä¸€ä¸ªä¸‰å±‚çš„æ ‘çŠ¶ã€åˆ†å¸ƒå¼æœåŠ¡ï¼ŒåŸºæœ¬å¯¹åº”åŸŸåçš„ç»“æ„ï¼š æ ¹åŸŸåæœåŠ¡å™¨ï¼ˆRoot DNS Serverï¼‰ï¼šç®¡ç†é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼Œè¿”å›â€œcomâ€â€œnetâ€â€œcnâ€ç­‰é¡¶çº§åŸŸåæœåŠ¡å™¨çš„ IP åœ°å€ï¼› é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼ˆTop-level DNS Serverï¼‰ï¼šç®¡ç†å„è‡ªåŸŸåä¸‹çš„æƒå¨åŸŸåæœåŠ¡å™¨ï¼Œæ¯”å¦‚ com é¡¶çº§åŸŸåæœåŠ¡å™¨å¯ä»¥è¿”å› apple.com åŸŸåæœåŠ¡å™¨çš„ IP åœ°å€ï¼› æƒå¨åŸŸåæœåŠ¡å™¨ï¼ˆAuthoritative DNS Serverï¼‰ï¼šç®¡ç†è‡ªå·±åŸŸåä¸‹ä¸»æœºçš„ IP åœ°å€ï¼Œæ¯”å¦‚ apple.com æƒå¨åŸŸåæœåŠ¡å™¨å¯ä»¥è¿”å› www.apple.com çš„ IP åœ°å€ã€‚ ä¾‹å¦‚ï¼Œä½ è¦è®¿é—®â€œwww.apple.comâ€ï¼Œå°±è¦è¿›è¡Œä¸‹é¢çš„ä¸‰æ¬¡æŸ¥è¯¢ï¼š è®¿é—®æ ¹åŸŸåæœåŠ¡å™¨ï¼Œå®ƒä¼šå‘Šè¯‰ä½ â€œcomâ€é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åœ°å€ï¼› è®¿é—®â€œcomâ€é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼Œå®ƒå†å‘Šè¯‰ä½ â€œapple.comâ€åŸŸåæœåŠ¡å™¨çš„åœ°å€ï¼› æœ€åè®¿é—®â€œapple.comâ€åŸŸåæœåŠ¡å™¨ï¼Œå°±å¾—åˆ°äº†â€œwww.apple.comâ€çš„åœ°å€ã€‚ å…¨çƒé‚£ä¹ˆå¤šDNSï¼Œè¿™ä¹ˆåºå¤§çš„ä½“é‡ï¼Œè¿˜æ˜¯ç”¨â€œç¼“å­˜â€æ¥æé«˜æ•ˆç‡ï¼Œçœç•¥å¾ˆå¤šä¸å¿…è¦çš„å¯»å€ã€‚ ç¬¬ä¸€å±‚ï¼Œæµè§ˆå™¨çš„ç¼“å­˜ ç¬¬äºŒå±‚ï¼Œæ“ä½œç³»ç»Ÿç¼“å­˜ ç¬¬ä¸‰å±‚ï¼Œhostç¼“å­˜ æ“ä½œç³»ç»Ÿé‡Œè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„â€œä¸»æœºæ˜ å°„â€æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå¯ç¼–è¾‘çš„æ–‡æœ¬ï¼Œç§°ä¸ºhostï¼Œåœ¨ Linux é‡Œæ˜¯â€œ/etc/hostsâ€ï¼Œåœ¨ Windows é‡Œæ˜¯â€œC:\\WINDOWS\\system32\\drivers\\etc\\hostsâ€ï¼Œå¦‚æœæ“ä½œç³»ç»Ÿåœ¨ç¼“å­˜é‡Œæ‰¾ä¸åˆ° DNS è®°å½•ï¼Œå°±ä¼šæ‰¾è¿™ä¸ªæ–‡ä»¶ã€‚ è®¸å¤šå¤§å…¬å¸ã€ç½‘ç»œè¿è¡Œå•†éƒ½ä¼šå»ºç«‹è‡ªå·±çš„ DNS æœåŠ¡å™¨ï¼Œä½œä¸ºç”¨æˆ· DNS æŸ¥è¯¢çš„ä»£ç†ï¼Œä»£æ›¿ç”¨æˆ·è®¿é—®æ ¸å¿ƒ DNS ç³»ç»Ÿã€‚è¿™äº›â€œé‡ç”Ÿâ€æœåŠ¡å™¨è¢«ç§°ä¸ºâ€œéæƒå¨åŸŸåæœåŠ¡å™¨â€ï¼Œå¯ä»¥ç¼“å­˜ä¹‹å‰çš„æŸ¥è¯¢ç»“æœï¼Œå¦‚æœå·²ç»æœ‰äº†è®°å½•ï¼Œå°±æ— éœ€å†å‘æ ¹æœåŠ¡å™¨å‘èµ·æŸ¥è¯¢ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„ IP åœ°å€ã€‚ ç»“åˆç¼“å­˜çš„å¯»å€è¿‡ç¨‹å°±æ˜¯ï¼šæµè§ˆå™¨DNSç¼“å­˜-&gt;æ“ä½œç³»ç»Ÿç¼“å­˜-&gt;Hostsæ–‡ä»¶-&gt;éæƒå¨åŸŸåæœåŠ¡å™¨-&gt;æ ¹åŸŸåæœåŠ¡å™¨-&gt;é¡¶çº§åŸŸåæœåŠ¡å™¨-&gt;æƒå¨åŸŸåæœåŠ¡å™¨ åŸŸåè§£æçš„è¿™ç§æ˜ å°„å…³ç³»ï¼Œè®©ç°åœ¨çš„å¾ˆå¤šç§â€œéªšæ“ä½œâ€æµ®ç°å‡ºæ¥ï¼Œè´Ÿè½½å‡è¡¡ï¼ŒåŸŸåæ±¡æŸ“ï¼ŒåŸŸåå±è”½ç­‰ç­‰ã€‚ æ¯•ç«Ÿï¼Œä½ æ˜¯å¸…å“¥å˜ä¸ºä½ æ˜¯Aè¿™ç§å˜åŒ–ï¼Œæœ‰å¾ˆå¤§çš„å¯æ“ä½œç©ºé—´å‘~ URI/URLURIï¼ˆUniform Resource Identifierï¼‰ï¼Œä¸­æ–‡åç§°æ˜¯ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼Œä½¿ç”¨å®ƒå°±èƒ½å¤Ÿå”¯ä¸€åœ°æ ‡è®°äº’è”ç½‘ä¸Šèµ„æºã€‚ URI å¦ä¸€ä¸ªæ›´å¸¸ç”¨çš„è¡¨ç°å½¢å¼æ˜¯ URLï¼ˆUniform Resource Locatorï¼‰ï¼Œ ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¿—ç§°çš„â€œç½‘å€â€ï¼Œå®ƒå®é™…ä¸Šæ˜¯ URI çš„ä¸€ä¸ªå­é›†ï¼Œä¸è¿‡å› ä¸ºè¿™ä¸¤è€…å‡ ä¹æ˜¯ç›¸åŒçš„ï¼Œå·®å¼‚ä¸å¤§ï¼Œæ‰€ä»¥é€šå¸¸ä¸ä¼šåšä¸¥æ ¼çš„åŒºåˆ†ã€‚ æ¥çœ‹çœ‹å®é™…çš„ä¾‹å­ï¼š 1http://www.aspxfans.com:8080/news/index.asp?boardID=5&amp;ID=24618&amp;page=1#name URL = åè®®(http) + åŸŸå(www.aspxfans.com) + ç«¯å£(8080) + è·¯å¾„(news) + æ–‡ä»¶å(index.asp) + ä¼ å‚(boardID=5&amp;ID=24618&amp;page=1) å…¶ä¸­ç«¯å£ï¼Œè·¯å¾„ï¼Œæ–‡ä»¶åï¼Œä¼ å‚ä¸æ˜¯å¿…é¡»éƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š 1https://www.baidu.com HTTPSå®ƒçš„å…¨ç§°æ˜¯â€œHTTP over SSL/TLSâ€ï¼Œä¹Ÿå°±æ˜¯è¿è¡Œåœ¨ SSL/TLS åè®®ä¸Šçš„ HTTPã€‚ SSL/TLSï¼Œå®ƒæ˜¯ä¸€ä¸ªè´Ÿè´£åŠ å¯†é€šä¿¡çš„å®‰å…¨åè®®ï¼Œå»ºç«‹åœ¨ TCP/IP ä¹‹ä¸Šï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ä¸ªå¯é çš„ä¼ è¾“åè®®ï¼Œå¯ä»¥è¢«ç”¨ä½œ HTTP çš„ä¸‹å±‚ã€‚ SSL çš„å…¨ç§°æ˜¯â€œSecure Socket Layerâ€ï¼Œç”±ç½‘æ™¯å…¬å¸å‘æ˜ï¼Œå½“å‘å±•åˆ° 3.0 æ—¶è¢«æ ‡å‡†åŒ–ï¼Œæ”¹åä¸º TLSï¼Œå³â€œTransport Layer Securityâ€ï¼Œä½†ç”±äºå†å²çš„åŸå› è¿˜æ˜¯æœ‰å¾ˆå¤šäººç§°ä¹‹ä¸º SSL/TLSï¼Œæˆ–è€…ç›´æ¥ç®€ç§°ä¸º SSLã€‚ SSL ä½¿ç”¨äº†è®¸å¤šå¯†ç å­¦æœ€å…ˆè¿›çš„ç ”ç©¶æˆæœï¼Œç»¼åˆäº†å¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†ã€æ‘˜è¦ç®—æ³•ã€æ•°å­—ç­¾åã€æ•°å­—è¯ä¹¦ç­‰æŠ€æœ¯ï¼Œèƒ½å¤Ÿåœ¨ä¸å®‰å…¨çš„ç¯å¢ƒä¸­ä¸ºé€šä¿¡çš„åŒæ–¹åˆ›å»ºå‡ºä¸€ä¸ªç§˜å¯†çš„ã€å®‰å…¨çš„ä¼ è¾“é€šé“ï¼Œä¸º HTTP å¥—ä¸Šä¸€å‰¯åšå›ºçš„ç›”ç”²ã€‚ webæ”»å‡»å¦‚æœä½ æ˜¯ä¸€åå‰ç«¯å·¥ç¨‹å¸ˆï¼Œé¢è¯•å¯èƒ½ä¼šè¢«é—®åˆ°è¿™ç±»é—®é¢˜ã€‚ç¨å¾®è¯´ä¸€ä¸‹ç»å¸¸æåŠçš„å‡ ç§ã€‚ 1.SQLæ³¨å…¥æ¼æ´ï¼Œé€šè¿‡æ¯ç§æ•°æ®åº“çš„SQLè¯­æ³•å’Œç‰¹æ€§ï¼Œè¿›è¡Œæ”»å‡»ï¼Œä¾‹å¦‚ï¼šâ€™or 1=1â€“â€™ã€‚ 2.XSSè·¨ç«™è„šæœ¬æ¼æ´æ”»å‡»ï¼Œé€šå¸¸æ˜¯åœ¨ç½‘é¡µä¸­åµŒå…¥å®¢æˆ·ç«¯è„šæœ¬ï¼Œæ¯”å¦‚js,åœ¨ç•™è¨€æ¿ä¸Šå‘è¡¨å¸¦æœ‰jså†…å®¹çš„æ–‡æœ¬ã€‚ 3.CSRFè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œé€šå¸¸è¡¨ç°ä¸ºæ”»å‡»è€…ç›—ç”¨çš„ä½ èº«ä»½ï¼ˆæµè§ˆå™¨çš„ä¼šè¯ï¼Œç½‘ä¸Šç™»å½•é“¶è¡Œç­‰ï¼‰ï¼Œä»¥ä½ çš„åä¹‰è¿›è¡ŒæŸäº›éæ³•æ“ä½œã€‚ 4.URLè·³è½¬å’Œé’“é±¼ï¼Œä¸€èˆ¬éƒ½æ˜¯æ£€æµ‹URLæ˜¯å¦æ˜¯è¯ˆéª—çš„ï¼Œä½†æ˜¯å¯¹äºå¼€å‘äººå‘˜æ¥è¯´ï¼Œé€šè¿‡URLä¸åŒå½¢å¼çš„è·³è½¬å¯ä»¥é¿å¼€ï¼Œå…¶ä¸­å¾ˆå¤šé’“é±¼ä¹Ÿåˆ©ç”¨äº†ã€‚ 5.WebServerè¿œç¨‹éƒ¨ç½²ï¼ˆæ¯”å¦‚FTP,Tomcat,JBossï¼‰ï¼Œå¦‚æœè¿œç¨‹éƒ¨ç½²é…ç½®ä¸å½“ï¼Œæ”»å‡»è€…å°±å¯ä»¥é€šè¿‡è¿œç¨‹éƒ¨ç½²åŠŸèƒ½å…¥ä¾µæœåŠ¡å™¨ã€‚ 6.WebShellå°±æ˜¯ä»¥ASP,PHP,JSPæˆ–è€…CGIç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§å‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå¯ä»¥å°†å…¶ç§°ä¸ºä¸€ç§ç½‘é¡µåé—¨ï¼Œé»‘å®¢åœ¨å…¥ä¾µä¸€ä¸ªç½‘ç«™åï¼Œé€šå¸¸ä¼šå°†ASPæˆ–è€…PHPåé—¨æ–‡ä»¶ä¸ç½‘ç«™æœåŠ¡å™¨Webç›®å½•ä¸‹æ­£å¸¸æ–‡ä»¶æ··åœ¨ä¸€èµ·ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨ç™»å½•é¡µé¢ï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œä»¥è¾¾åˆ°æ§åˆ¶ç½‘ç«™æœåŠ¡å™¨çš„ç›®çš„ã€‚ Proxyä»£ç†ï¼ˆProxyï¼‰æ˜¯ HTTP åè®®ä¸­è¯·æ±‚æ–¹å’Œåº”ç­”æ–¹ä¸­é—´çš„ä¸€ä¸ªç¯èŠ‚ï¼Œä½œä¸ºâ€œä¸­è½¬ç«™â€ï¼Œæ—¢å¯ä»¥è½¬å‘å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¹Ÿå¯ä»¥è½¬å‘æœåŠ¡å™¨çš„åº”ç­”ã€‚ ä»£ç†æœ‰å¾ˆå¤šçš„ç§ç±»ï¼Œå¸¸è§çš„æœ‰ï¼š åŒ¿åä»£ç†ï¼šå®Œå…¨â€œéšåŒ¿â€äº†è¢«ä»£ç†çš„æœºå™¨ï¼Œå¤–ç•Œçœ‹åˆ°çš„åªæ˜¯ä»£ç†æœåŠ¡å™¨ï¼› é€æ˜ä»£ç†ï¼šé¡¾åæ€ä¹‰ï¼Œå®ƒåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯â€œé€æ˜å¼€æ”¾â€çš„ï¼Œå¤–ç•Œæ—¢çŸ¥é“ä»£ç†ï¼Œä¹ŸçŸ¥é“å®¢æˆ·ç«¯ï¼› æ­£å‘ä»£ç†ï¼šé è¿‘å®¢æˆ·ç«¯ï¼Œä»£è¡¨å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼› åå‘ä»£ç†ï¼šé è¿‘æœåŠ¡å™¨ç«¯ï¼Œä»£è¡¨æœåŠ¡å™¨å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼› CDNï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ç§ä»£ç†ï¼Œå®ƒä»£æ›¿æºç«™æœåŠ¡å™¨å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œé€šå¸¸æ‰®æ¼”ç€é€æ˜ä»£ç†å’Œåå‘ä»£ç†çš„è§’è‰²ã€‚ ä¸­ä»‹ï¼Œä¹Ÿæ˜¯ä¸€ç§ä»£ç†ï¼Œæ— è®ºä½ ä¹°æˆ¿ï¼Œæ—…æ¸¸ï¼Œè¢«ä»–ä»¬æŒæ¡æˆ¿æº/æ—…æ¸¸é¡¹ç›®åï¼Œä»–ä¸ºåˆ€ä¿ï¼Œä½ ä¸ºé±¼è‚‰â€¦. ç”±äºä»£ç†åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ’å…¥äº†ä¸€ä¸ªâ€œä¸­é—´å±‚â€ï¼Œæ‰€ä»¥å¯ä»¥åœ¨è¿™ä¸ªç¯èŠ‚åšå¾ˆå¤šæœ‰æ„æ€çš„äº‹æƒ…ï¼Œæ¯”å¦‚ï¼š è´Ÿè½½å‡è¡¡ï¼šæŠŠè®¿é—®è¯·æ±‚å‡åŒ€åˆ†æ•£åˆ°å¤šå°æœºå™¨ï¼Œå®ç°è®¿é—®é›†ç¾¤åŒ–ï¼› å†…å®¹ç¼“å­˜ï¼šæš‚å­˜ä¸Šä¸‹è¡Œçš„æ•°æ®ï¼Œå‡è½»åç«¯çš„å‹åŠ›ï¼› å®‰å…¨é˜²æŠ¤ï¼šéšåŒ¿ IP, ä½¿ç”¨ WAF ç­‰å·¥å…·æŠµå¾¡ç½‘ç»œæ”»å‡»ï¼Œä¿æŠ¤è¢«ä»£ç†çš„æœºå™¨ï¼› æ•°æ®å¤„ç†ï¼šæä¾›å‹ç¼©ã€åŠ å¯†ç­‰é¢å¤–çš„åŠŸèƒ½ã€‚ å…³äº HTTP çš„ä»£ç†è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„â€œä»£ç†åè®®â€ï¼ˆproxy protocolï¼‰ï¼Œå®ƒç”±çŸ¥åçš„ä»£ç†è½¯ä»¶ HAProxy åˆ¶è®¢ï¼Œä½†å¹¶ä¸æ˜¯ RFC æ ‡å‡†ã€‚ å®Œæ•´ç½‘ç»œç»“æ„TCP/IP ç½‘ç»œåˆ†å±‚æ¨¡å‹(å››å±‚)TCP/IP å½“åˆçš„è®¾è®¡è€…çœŸçš„æ˜¯éå¸¸èªæ˜ï¼ŒæŠŠå¤æ‚çš„ç½‘ç»œé€šä¿¡åˆ’åˆ†å‡ºå¤šä¸ªå±‚æ¬¡ï¼Œå†ç»™æ¯ä¸€ä¸ªå±‚æ¬¡åˆ†é…ä¸åŒçš„èŒè´£ï¼Œå±‚æ¬¡å†…åªä¸“å¿ƒåšè‡ªå·±çš„äº‹æƒ…å°±å¥½ï¼Œç”¨â€œåˆ†è€Œæ²»ä¹‹â€çš„æ€æƒ³æŠŠä¸€ä¸ªâ€œå¤§éº»çƒ¦â€æ‹†åˆ†æˆäº†æ•°ä¸ªâ€œå°éº»çƒ¦â€ï¼Œä»è€Œè§£å†³äº†ç½‘ç»œé€šä¿¡çš„éš¾é¢˜ã€‚ TCP/IP åè®®æ€»å…±æœ‰å››å±‚ï¼š ç¬¬ä¸€å±‚å«â€œé“¾æ¥å±‚â€ï¼ˆlink layerï¼‰ï¼Œè´Ÿè´£åœ¨ä»¥å¤ªç½‘ã€WiFi è¿™æ ·çš„åº•å±‚ç½‘ç»œä¸Šå‘é€åŸå§‹æ•°æ®åŒ…ï¼Œå·¥ä½œåœ¨ç½‘å¡è¿™ä¸ªå±‚æ¬¡ï¼Œä½¿ç”¨ MAC åœ°å€æ¥æ ‡è®°ç½‘ç»œä¸Šçš„è®¾å¤‡ï¼Œæ‰€ä»¥æœ‰æ—¶å€™ä¹Ÿå« MAC å±‚ã€‚ ç¬¬äºŒå±‚å«â€œç½‘é™…å±‚â€æˆ–è€…â€œç½‘ç»œäº’è¿å±‚â€ï¼ˆinternet layerï¼‰ï¼ŒIP åè®®å°±å¤„åœ¨è¿™ä¸€å±‚ã€‚å› ä¸º IP åè®®å®šä¹‰äº†â€œIP åœ°å€â€çš„æ¦‚å¿µï¼Œæ‰€ä»¥å°±å¯ä»¥åœ¨â€œé“¾æ¥å±‚â€çš„åŸºç¡€ä¸Šï¼Œç”¨ IP åœ°å€å–ä»£ MAC åœ°å€ï¼ŒæŠŠè®¸è®¸å¤šå¤šçš„å±€åŸŸç½‘ã€å¹¿åŸŸç½‘è¿æ¥æˆä¸€ä¸ªè™šæ‹Ÿçš„å·¨å¤§ç½‘ç»œï¼Œåœ¨è¿™ä¸ªç½‘ç»œé‡Œæ‰¾è®¾å¤‡æ—¶åªè¦æŠŠ IP åœ°å€å†â€œç¿»è¯‘â€æˆ MAC åœ°å€å°±å¯ä»¥äº†ã€‚ ç¬¬ä¸‰å±‚å«â€œä¼ è¾“å±‚â€ï¼ˆtransport layerï¼‰ï¼Œè¿™ä¸ªå±‚æ¬¡åè®®çš„èŒè´£æ˜¯ä¿è¯æ•°æ®åœ¨ IP åœ°å€æ ‡è®°çš„ä¸¤ç‚¹ä¹‹é—´â€œå¯é â€åœ°ä¼ è¾“ï¼Œæ˜¯ TCP åè®®å·¥ä½œçš„å±‚æ¬¡ï¼Œå¦å¤–è¿˜æœ‰å®ƒçš„ä¸€ä¸ªâ€œå°ä¼™ä¼´â€UDPã€‚ TCP æ˜¯ä¸€ä¸ªæœ‰çŠ¶æ€çš„åè®®ï¼Œéœ€è¦å…ˆä¸å¯¹æ–¹å»ºç«‹è¿æ¥ç„¶åæ‰èƒ½å‘é€æ•°æ®ï¼Œè€Œä¸”ä¿è¯æ•°æ®ä¸ä¸¢å¤±ä¸é‡å¤ã€‚è€Œ UDP åˆ™æ¯”è¾ƒç®€å•ï¼Œå®ƒæ— çŠ¶æ€ï¼Œä¸ç”¨äº‹å…ˆå»ºç«‹è¿æ¥å°±å¯ä»¥ä»»æ„å‘é€æ•°æ®ï¼Œä½†ä¸ä¿è¯æ•°æ®ä¸€å®šä¼šå‘åˆ°å¯¹æ–¹ã€‚ä¸¤ä¸ªåè®®çš„å¦ä¸€ä¸ªé‡è¦åŒºåˆ«åœ¨äºæ•°æ®çš„å½¢å¼ã€‚ TCP çš„æ•°æ®æ˜¯è¿ç»­çš„â€œå­—èŠ‚æµâ€ï¼Œæœ‰å…ˆåé¡ºåºï¼Œè€Œ UDP åˆ™æ˜¯åˆ†æ•£çš„å°æ•°æ®åŒ…ï¼Œæ˜¯é¡ºåºå‘ï¼Œä¹±åºæ”¶ã€‚ã€‚ ç¬¬å››å±‚å«â€œåº”ç”¨å±‚â€ï¼ˆapplication layerï¼‰ï¼Œç”±äºä¸‹é¢çš„ä¸‰å±‚æŠŠåŸºç¡€æ‰“å¾—éå¸¸å¥½ï¼Œæ‰€ä»¥åœ¨è¿™ä¸€å±‚å°±â€œç™¾èŠ±é½æ”¾â€äº†ï¼Œæœ‰å„ç§é¢å‘å…·ä½“åº”ç”¨çš„åè®®ã€‚ä¾‹å¦‚ Telnetã€SSHã€FTPã€SMTP ç­‰ç­‰ï¼Œå½“ç„¶è¿˜æœ‰æˆ‘ä»¬çš„ HTTPã€‚ MAC å±‚çš„ä¼ è¾“å•ä½æ˜¯å¸§ï¼ˆframeï¼‰ï¼ŒIP å±‚çš„ä¼ è¾“å•ä½æ˜¯åŒ…ï¼ˆpacketï¼‰ï¼ŒTCP å±‚çš„ä¼ è¾“å•ä½æ˜¯æ®µï¼ˆsegmentï¼‰ï¼ŒHTTP çš„ä¼ è¾“å•ä½åˆ™æ˜¯æ¶ˆæ¯æˆ–æŠ¥æ–‡ï¼ˆmessageï¼‰ã€‚ OSIä¸ƒå±‚ TCP/IP åè®®æ ˆçš„å·¥ä½œæ–¹å¼ä½ å¯ä»¥æŠŠ HTTP åˆ©ç”¨ TCP/IP åè®®æ ˆä¼ è¾“æ•°æ®æƒ³è±¡æˆä¸€ä¸ªå‘å¿«é€’çš„è¿‡ç¨‹ã€‚ å‡è®¾ä½ æƒ³æŠŠä¸€ä»¶æ¯›ç»’ç©å…·é€ç»™æœ‹å‹ï¼Œä½†ä½ è¦å…ˆæ‹¿ä¸ªå¡‘æ–™è¢‹å¥—ä¸€ä¸‹ï¼Œè¿™ä»¶ç©å…·å°±ç›¸å½“äº HTTP åè®®é‡Œè¦ä¼ è¾“çš„å†…å®¹: HTMLï¼Œç„¶å HTTP åè®®ä¸ºå®ƒåŠ ä¸€ä¸ª HTTP ä¸“ç”¨é™„åŠ æ•°æ®ã€‚ ä½ æŠŠç©å…·äº¤ç»™å¿«é€’å°å“¥ï¼Œä¸ºäº†ä¿æŠ¤è´§ç‰©ï¼Œä»–åˆåŠ äº†å±‚åŒ…è£…å†è´´äº†ä¸ªæ ‡ç­¾ï¼Œç›¸å½“äºåœ¨ TCP å±‚ç»™æ•°æ®å†æ¬¡æ‰“åŒ…ï¼ŒåŠ ä¸Šäº† TCP å¤´ã€‚ æ¥ç€å¿«é€’å°å“¥ä¸‹æ¥¼ï¼ŒæŠŠåŒ…è£¹æ”¾è¿›äº†ä¸‰è½®è½¦é‡Œï¼Œè¿åˆ°é›†æ•£ç‚¹ï¼Œç„¶åå†è£…è¿›æ›´å¤§çš„å¡è½¦é‡Œï¼Œç›¸å½“äºåœ¨ IP å±‚ã€MAC å±‚å¯¹ TCP æ•°æ®åŒ…åŠ ä¸Šäº† IP å¤´ã€MAC å¤´ã€‚ ä¹‹åç»è¿‡æ¼«é•¿çš„è¿è¾“ï¼ŒåŒ…è£¹åˆ°è¾¾ç›®çš„åœ°ï¼Œè¦å¸è´§å†æ”¾è¿›å¦ä¸€ä½å¿«é€’å‘˜çš„ä¸‰è½®è½¦ï¼Œå°±æ˜¯åœ¨ IP å±‚ã€MAC å±‚ä¼ è¾“åæ‹†åŒ…ã€‚ å¿«é€’å‘˜åˆ°äº†ä½ æœ‹å‹çš„å®¶é—¨å£ï¼Œæ’•æ‰æ ‡ç­¾ï¼Œå»é™¤äº† TCP å±‚çš„å¤´ï¼Œä½ æœ‹å‹å†æ‹†æ‰å¡‘æ–™è¢‹åŒ…è£…ï¼Œä¹Ÿå°±æ˜¯ HTTP å¤´ï¼Œæœ€åå°±æ‹¿åˆ°äº†ç©å…·ï¼Œä¹Ÿå°±æ˜¯çœŸæ­£çš„ HTML é¡µé¢ã€‚ è¿™ä¸ªæ¯”å–»é‡Œçœç•¥äº†å¾ˆå¤š TCP/IP åè®®é‡Œçš„ç»†èŠ‚ï¼Œæ¯”å¦‚å»ºè¿ã€è·¯ç”±ã€æ•°æ®åˆ‡åˆ†ä¸é‡ç»„ã€é”™è¯¯æ£€æŸ¥ç­‰ï¼Œä½†æ ¸å¿ƒçš„æ•°æ®ä¼ è¾“è¿‡ç¨‹æ˜¯å·®ä¸å¤šçš„ã€‚ HTMLæµåŠ¨è¿‡ç¨‹ï¼š HTML -&gt; HTTP -&gt; TCP -&gt; IP/MAC -&gt; TCP -&gt; HTTP -&gt; HTML å¿«é€’å‘˜å’Œç‰©æµç³»ç»Ÿè¿‡ç¨‹ï¼š åŒ…è£… -&gt; -&gt; .. -&gt;ä¼ è¾“ -&gt; .. -&gt;æ‹†åŒ…è£…ã€‚ HTTP åè®®çš„ä¼ è¾“è¿‡ç¨‹å°±æ˜¯è¿™æ ·é€šè¿‡åè®®æ ˆé€å±‚å‘ä¸‹ï¼Œæ¯ä¸€å±‚éƒ½æ·»åŠ æœ¬å±‚çš„ä¸“æœ‰æ•°æ®ï¼Œå±‚å±‚æ‰“åŒ…ï¼Œç„¶åé€šè¿‡ä¸‹å±‚å‘é€å‡ºå»ã€‚ æ¥æ”¶æ•°æ®åˆ™æ˜¯ç›¸åçš„æ“ä½œï¼Œä»ä¸‹å¾€ä¸Šç©¿è¿‡åè®®æ ˆï¼Œé€å±‚æ‹†åŒ…ï¼Œæ¯å±‚å»æ‰æœ¬å±‚çš„ä¸“æœ‰å¤´ï¼Œä¸Šå±‚å°±ä¼šæ‹¿åˆ°è‡ªå·±çš„æ•°æ®ã€‚ ä½†ä¸‹å±‚çš„ä¼ è¾“è¿‡ç¨‹å¯¹äºä¸Šå±‚æ˜¯å®Œå…¨â€œé€æ˜â€çš„ï¼Œä¸Šå±‚ä¹Ÿä¸éœ€è¦å…³å¿ƒä¸‹å±‚çš„å…·ä½“å®ç°ç»†èŠ‚ï¼Œæ‰€ä»¥å°± HTTP å±‚æ¬¡æ¥çœ‹ï¼Œå®ƒä¸ç®¡ä¸‹å±‚æ˜¯ä¸æ˜¯ TCP/IP åè®®ï¼Œçœ‹åˆ°çš„åªæ˜¯ä¸€ä¸ªå¯é çš„ä¼ è¾“é“¾è·¯ï¼Œåªè¦æŠŠæ•°æ®åŠ ä¸Šè‡ªå·±çš„å¤´ï¼Œå¯¹æ–¹å°±èƒ½åŸæ ·æ”¶åˆ°ã€‚","categories":[],"tags":[{"name":"http","slug":"http","permalink":"https://tsunamigg.github.io/tags/http/"}]},{"title":"3.æœ‰å¿…è¦åˆ†æ¸…çš„URIURL","slug":"http3","date":"2019-06-12T10:12:10.000Z","updated":"2020-06-01T14:36:41.871Z","comments":true,"path":"2019/06/12/http3/","link":"","permalink":"https://tsunamigg.github.io/2019/06/12/http3/","excerpt":"æ˜¯ä¸€ä¸ªå¾ˆè¿·æƒ‘çš„ç‚¹ï¼Œæ‰€ä»¥æŸ¥è¯åè®°å½•äºæ­¤","text":"æ˜¯ä¸€ä¸ªå¾ˆè¿·æƒ‘çš„ç‚¹ï¼Œæ‰€ä»¥æŸ¥è¯åè®°å½•äºæ­¤ URI/URLURIï¼ˆUniform Resource Identifierï¼‰ï¼Œä¸­æ–‡åç§°æ˜¯ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼Œä½¿ç”¨å®ƒå°±èƒ½å¤Ÿå”¯ä¸€åœ°æ ‡è®°äº’è”ç½‘ä¸Šèµ„æºã€‚ URI å¦ä¸€ä¸ªæ›´å¸¸ç”¨çš„è¡¨ç°å½¢å¼æ˜¯ URLï¼ˆUniform Resource Locatorï¼‰ï¼Œ ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¿—ç§°çš„â€œç½‘å€â€ï¼Œå®ƒå®é™…ä¸Šæ˜¯ URI çš„ä¸€ä¸ªå­é›†ï¼Œä¸è¿‡å› ä¸ºè¿™ä¸¤è€…å‡ ä¹æ˜¯ç›¸åŒçš„ï¼Œå·®å¼‚ä¸å¤§ï¼Œæ‰€ä»¥é€šå¸¸ä¸ä¼šåšä¸¥æ ¼çš„åŒºåˆ†ã€‚ ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒURI ä¸ä»…èƒ½å¤Ÿæ ‡è®°ä¸‡ç»´ç½‘çš„èµ„æºï¼Œä¹Ÿå¯ä»¥æ ‡è®°å…¶ä»–çš„ï¼Œå¦‚é‚®ä»¶ç³»ç»Ÿã€æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿç­‰ä»»æ„èµ„æºã€‚è€Œâ€œèµ„æºâ€æ—¢å¯ä»¥æ˜¯å­˜åœ¨ç£ç›˜ä¸Šçš„é™æ€æ–‡æœ¬ã€é¡µé¢æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”± Javaã€PHP æä¾›çš„åŠ¨æ€æœåŠ¡ã€‚ ä¾‹å¦‚ï¼šwindowsç³»ç»Ÿä¸­ï¼Œä½ å°†ä¸€ä¸ªå›¾ç‰‡æ‹–å…¥æµè§ˆå™¨æ‰“å¼€ï¼Œä¹Ÿä¼šå¾—åˆ°è¿™ä¸ªå›¾ç‰‡çš„URIã€‚ file:///C:/Users/%E7%94%98%E8%B6%85/Desktop/working/h5/img/bg.png ä¸€ä¸ªwebsocketåè®®çš„URI ws://newtest/zhouheiya.cn:1010/ URI = scheme + :// + user:passwd@ + host:port + path + query + #fragment URI = åè®® + :// + èº«ä»½ä¿¡æ¯ + ä¸»æœºåï¼šç«¯å£å· + èµ„æºè·¯å¾„ + æŸ¥è¯¢å‚æ•° + ç‰‡æ®µæ ‡è¯†ç¬¦ å…·æœ‰å®‰å…¨éšæ‚£çš„user:passwd@ ä¸»æœºåä¹‹å‰çš„èº«ä»½ä¿¡æ¯â€œuser:passwd@â€ï¼Œè¡¨ç¤ºç™»å½•ä¸»æœºæ—¶çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä½†ç°åœ¨å·²ç»ä¸æ¨èä½¿ç”¨è¿™ç§å½¢å¼äº†ï¼ˆRFC7230ï¼‰ï¼Œå› ä¸ºå®ƒæŠŠæ•æ„Ÿä¿¡æ¯ä»¥æ˜æ–‡å½¢å¼æš´éœ²å‡ºæ¥ï¼Œå­˜åœ¨ä¸¥é‡çš„å®‰å…¨éšæ‚£ã€‚ fragment æŸ¥è¯¢å‚æ•°åçš„ç‰‡æ®µæ ‡è¯†ç¬¦â€œ#fragmentâ€ï¼Œå®ƒæ˜¯ URI æ‰€å®šä½çš„èµ„æºå†…éƒ¨çš„ä¸€ä¸ªâ€œé”šç‚¹â€æˆ–è€…è¯´æ˜¯â€œæ ‡ç­¾â€ï¼Œæµè§ˆå™¨å¯ä»¥åœ¨è·å–èµ„æºåç›´æ¥è·³è½¬åˆ°å®ƒæŒ‡ç¤ºçš„ä½ç½®ã€‚ ä½†ç‰‡æ®µæ ‡è¯†ç¬¦ä»…èƒ½ç”±æµè§ˆå™¨è¿™æ ·çš„å®¢æˆ·ç«¯ä½¿ç”¨ï¼ŒæœåŠ¡å™¨æ˜¯çœ‹ä¸åˆ°çš„ã€‚åŸå› æ˜¯ï¼Œæµè§ˆå™¨æ°¸è¿œä¸ä¼šæŠŠå¸¦â€œ#fragmentâ€çš„ URI å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ä¹Ÿæ°¸è¿œä¸ä¼šç”¨è¿™ç§æ–¹å¼å»å¤„ç†èµ„æºçš„ç‰‡æ®µã€‚ ä¾‹å¦‚ï¼š æˆ‘ä»¬åœ¨æµè§ˆå™¨çš„åœ°å€æ è¾“å…¥ï¼šhttps://www.baidu.com/?wd=1#test æ‰“å¼€æµè§ˆå™¨çš„devtoolsæŸ¥çœ‹å‘å‡ºçš„ç¬¬ä¸€ä¸ªè¯·æ±‚çš„Refererï¼šhttps://www.baidu.com/?wd=1 ï¼Œ#testä¼šè¢«å®Œå…¨å¿½ç•¥æ‰ã€‚ æ˜¯ä¸æ˜¯è”æƒ³åˆ°äº†ä»€ä¹ˆï¼Ÿå¯¹vueç†Ÿæ‚‰çš„éƒ½çŸ¥é“vue-routeré»˜è®¤ä½¿ç”¨çš„æ˜¯hashè·¯ç”±ï¼šlocalhost:8080/#/xxx fragmentå®ç°çš„å•é¡µé¢è·¯ç”± JavaScript æä¾›äº† location.hash æ¥æ“ä½œå½“å‰ URI çš„ fragmentï¼ŒåŒæ—¶æä¾›äº† Hashchange äº‹ä»¶ç›‘å¬ fragment çš„å˜åŒ–ã€‚ ä¿®æ”¹ location.hash å€¼ï¼Œè§¦å‘ hashchange äº‹ä»¶ï¼ŒJS å¤„ç†å¯¹åº”çš„é€»è¾‘ï¼Œæ”¹å˜é¡µé¢ UI å®ç°é¡µé¢çš„è·³è½¬ï¼Œå¹¶åœ¨æµè§ˆå™¨ä¸­äº§ç”Ÿå†å²è®°å½•ã€‚ æ¯”å¦‚åœ°å€æ ï¼š https://blog.csdn.net/#/testHash location.hash = â€œ#/testHashâ€ é€šè¿‡caniuseçš„æŸ¥è¯¢ï¼Œhashchange event ç›®å‰çš„å…¼å®¹æ€§è¡¨ç°è¾ƒå¥½ï¼Œä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒã€‚ å®ç°å•é¡µé¢è·¯ç”±è¿˜ä¼šä½¿ç”¨ H5 ä¸º history æ–°å¢çš„ä¸¤ä¸ª APIï¼š History.pushState() , Histroy. replaceState ()ã€‚ å…·ä½“ä»£ç å®ç°å¯ä»¥å‚è€ƒ vue-router hash æ¨¡å¼ä¸‹çš„å®ç° https://github.com/vuejs/vue-router/blob/dev/src/history/hash.jsã€‚ Vueçš„é»˜è®¤è·¯ç”±æ–¹å¼æ˜¯hashï¼Œå¦‚ä½•ä¿®æ”¹ï¼Ÿ 1.å®ä¾‹åŒ–è§„åˆ™ä¸ºâ€œhistoryâ€æ¨¡å¼ const router = new VueRouter({mode: â€˜historyâ€™,routes // ï¼ˆç¼©å†™ï¼‰ç›¸å½“äº routes: routes}) 2.nginx ç›¸åº”çš„é…ç½® location / {try_files uriuriuri/ /index.html;} https://router.vuejs.org/zh/guide/essentials/history-mode.htmlä¸­ä»‹ç»äº†å¤šç§åç«¯é…ç½®çš„ä¾‹å­ï¼Œæ ¹æ®æ–‡æ¡£é…ç½®å°±å¥½äº† ç„¶è€Œï¼Œ fragment ä¼šè¢« Google æœç´¢å¼•æ“å¿½ç•¥æ‰ï¼Œå› æ­¤å¯¹äºç”¨ hash æ¨¡å¼å‰ç«¯è·¯ç”±çš„åº”ç”¨çš„ SEO æ¥è¯´æ˜¯å¾ˆä¸å‹å¥½çš„ã€‚ä¸è¿‡ Google ç»™äº†ä¸€ä¸ªæ–¹æ¡ˆï¼Œå°±æ˜¯åœ¨ # ç´§è·Ÿä¸€ä¸ª ! ï¼Œè¿™æ ·Google æœç´¢å¼•æ“å°±ä¼šå°†è¿™ä¸ª URI è¿›è¡Œè½¬æ¢ï¼Œå¦‚ https://domain/index.html#!L18è½¬æ¢åå°±æˆä¸ºäº† https://domain/index.html?_escaped_fragment_=L18ã€‚è¿™æ ·æœç´¢å¼•æ“å°±ä¼šæºå¸¦ä¸Š URIâ€™s fragment ç›´æ¥å»è®¿é—®è¿™ä¸ª URIï¼Œå¼€å‘è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ª trick ä¼˜åŒ–ç½‘ç«™çš„ SEOã€‚ fragmentå®ç°çš„HTMLé”šç‚¹ åœ¨ HTML ä¸­æ¯”è¾ƒå¸¸è§çš„ä¸€ä¸ªåº”ç”¨ â€”â€” é¡µé¢å†…å®šä½ã€‚ åœ¨é¡µé¢ä¸­é€šè¿‡è®¾ç½®æ ‡ç­¾çš„ id å±æ€§æ¥å®šä¹‰é”šç‚¹ï¼Œä»è€Œå®ç°é”šç‚¹å®šä½ã€‚å®é™…ä¸Šé”šç‚¹å®šä½çš„å®ç°æ­£æ˜¯ä¾èµ–äº†fragment çš„ç‰¹æ€§ 3ã€‚å¦‚è¿™ä¸ª URI https://domain/index.html#L18ï¼Œå‡è®¾è¿”å›çš„æ–‡ä»¶ç±»å‹æ˜¯ text/htmlï¼Œåˆ™æµè§ˆå™¨ä¼šè¯»å– URIâ€™s fragmentï¼Œç„¶ååœ¨é¡µé¢ä¸­å¯»æ‰¾ L18 è¿™ä¸ªé”šç‚¹ï¼Œå¹¶å°†é¡µé¢æ»šåŠ¨åˆ°è¯¥é”šç‚¹çš„ä½ç½®ã€‚ å› æ­¤æˆ‘ä»¬å½“ç‚¹å‡» &lt;a href=&quot;#top&quot;&gt;top&lt;/a&gt;æ—¶ï¼Œå®é™…ä¸Šå¤„ç†è¿‡ç¨‹æ˜¯ URI çš„ hash å‘ç”Ÿå˜åŒ–ï¼Œç„¶åæµè§ˆå™¨è¯»å–æ–°çš„ fragmentï¼Œå¹¶å¯»æ‰¾ DOM ä¸­æ˜¯å¦å­˜åœ¨å¯¹åº”çš„é”šç‚¹ï¼Œå°†è¯¥é”šç‚¹æ˜¾ç¤ºåˆ°é¡µé¢ä¸­ã€‚ åœ¨ MIME Type ä¸º HTML æˆ– XML æ—¶ï¼Œå¦‚https://domain/index.html#è¿™ä¸ª URI ä¸­æ˜¯ç©ºçš„ fragmentï¼Œåˆ™æµè§ˆå™¨é»˜è®¤æ˜¾ç¤ºé¡µé¢çš„æœ€é¡¶ç«¯ã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ª&lt;a href=&quot;#&quot;&gt;è¿”å›é¡¶éƒ¨&lt;/a&gt;æ¥ç®€æ´å®ç°å›åˆ°é¡¶éƒ¨çš„åŠŸèƒ½ã€‚ URI å¯¹åº”çš„èµ„æºç±»å‹ä¸åŒï¼Œæµè§ˆå™¨å¯¹è¯¥ URIâ€™s fragment çš„å¤„ç†æ–¹å¼å°±ä¸ä¸€æ ·ï¼Œå…·ä½“ä¸åŒç±»å‹çš„å¤„ç†æ–¹å¼å¯ä»¥å‚é˜…ï¼š[https://en.wikipedia.org/wiki/Fragment_identifier#Examples] ã€‚ URL = scheme + :// + host + port +path + filename + query + #fragment httpï¼š 1http:&#x2F;&#x2F;www.aspxfans.com:8080&#x2F;news&#x2F;index.asp?boardID&#x3D;5&amp;ID&#x3D;24618&amp;page&#x3D;1#name å…¶ä¸­ç«¯å£ï¼Œè·¯å¾„ï¼Œæ–‡ä»¶åï¼Œä¼ å‚ä¸æ˜¯å¿…é¡»éƒ¨åˆ†ï¼Œå¦‚ä¸‹ï¼š 1https://www.baidu.com æˆ‘ä»¬ä¸å¿…åˆ»æ„å»åŒºåˆ† URI / URL / URN ã€‚åœ¨ [RFC3986]ä¸Šå·²ç»æ˜ç¡®è¯´æ˜è¿™ä¸ªç‚¹ï¼š Future specifications and related documentation shoulduse the general term â€œURIâ€ rather than the more restrictive termsâ€œURLâ€ and â€œURNâ€. æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„ä¸åŒæˆ‘ä»¬åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥www.baidu.comï¼Œåœ¨devå·¥å…·ä¸­çœ‹åˆ°request headerä¸­ï¼Œæœ‰ä¸€ä¸ªview sourceï¼Œç‚¹å¼€åçœ‹åˆ°çš„å°±æ˜¯å‘ç»™æœåŠ¡ç«¯ã€‚ä»”ç»†å¯¹æ¯”ä¸€ä¸‹ï¼Œä¼šå‘ç°ï¼Œåè®®åå’Œä¸»æœºåéƒ½ä¸è§äº†ï¼Œåªå‰©ä¸‹äº†åé¢çš„éƒ¨åˆ†ã€‚ è¿™æ˜¯å› ä¸ºåè®®åå’Œä¸»æœºåå·²ç»åˆ†åˆ«å‡ºç°åœ¨äº†è¯·æ±‚è¡Œçš„ç‰ˆæœ¬å·å’Œè¯·æ±‚å¤´çš„ Host å­—æ®µé‡Œï¼Œæ²¡æœ‰å¿…è¦å†é‡å¤ã€‚ æˆ‘ä»¬å¯ä»¥æ–­å®šçš„æ˜¯ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çœ‹åˆ°çš„ URI æ˜¯ä¸ä¸€æ ·çš„ã€‚å®¢æˆ·ç«¯çœ‹åˆ°çš„å¿…é¡»æ˜¯å®Œæ•´çš„ URIï¼Œä½¿ç”¨ç‰¹å®šçš„åè®®å»è¿æ¥ç‰¹å®šçš„ä¸»æœºï¼Œè€ŒæœåŠ¡å™¨çœ‹åˆ°çš„åªæ˜¯æŠ¥æ–‡è¯·æ±‚è¡Œé‡Œè¢«åˆ é™¤äº†åè®®åå’Œä¸»æœºåçš„ URIã€‚ åœ¨webæœåŠ¡å™¨ä¸­ï¼Œä¾‹å¦‚é…ç½®nginxï¼Œå®ƒçš„ locationã€rewrite ç­‰æŒ‡ä»¤æ“ä½œçš„ URI å…¶å®æŒ‡çš„æ˜¯çœŸæ­£ URI é‡Œçš„ path å’Œåç»­çš„éƒ¨åˆ†ï¼Œçœç•¥æ‰äº†pathä¹‹å‰çš„åè®®åå’Œä¸»æœºåã€‚ URIçš„ç¼–ç åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å¦‚ä¸‹çš„åœºæ™¯ï¼š ä½ æ‰¾åŒäº‹è¦ä¸€ä»½èµ„æ–™ï¼ŒåŒäº‹ç»™ä½ äº†ä¸€ä¸ªç½‘å€ï¼šhttps://www.baidu.com/s?wd=%E4%BA%94%E6%9C%88%E5%A4%A9%E6%BC%94%E5%94%B1%E4%BC%9A&amp;rsv_spt=1ã€‚ ä½ å¯èƒ½ä¼šé©¬ä¸Šæ‡µä¸€ä¸‹ï¼Œwd=%E4%BA%94%E6%9C%88%E5%A4%A9%E6%BC%94%E5%94%B1%E4%BC%9Aã€‚ è¿™æ˜¯ä»€ä¹ˆé¬¼ä¸œè¥¿ï¼Ÿä½ é—®åŒäº‹ï¼ŒåŒäº‹ç»™ä½ æˆªå›¾è¡¨æ˜æµè§ˆå™¨é‡Œé¢çš„æ˜¯æ­£å¸¸çš„ä¸­æ–‡ã€‚ æµè§ˆå™¨æ©ç›–äº†URIâ€œä¸‘é™‹â€çš„ä¸€é¢ï¼Œè¿™ä¸ªä¸‘é™‹å…¶å®æ¶‰åŠç¼–ç ã€‚ URIå¼•å…¥çš„ç¼–ç æœºåˆ¶æ˜¯ï¼šASCII ç  + ASCII ç ä»¥å¤–çš„å­—ç¬¦é›†å’Œç‰¹æ®Šå­—ç¬¦åšè½¬ä¹‰ã€‚ URI è½¬ä¹‰çš„è§„åˆ™æœ‰ç‚¹â€œç®€å•ç²—æš´â€ï¼Œç›´æ¥æŠŠé ASCII ç æˆ–ç‰¹æ®Šå­—ç¬¦è½¬æ¢æˆåå…­è¿›åˆ¶å­—èŠ‚å€¼ï¼Œç„¶åå‰é¢å†åŠ ä¸Šä¸€ä¸ªâ€œ%â€ã€‚ä¾‹å¦‚ï¼Œç©ºæ ¼è¢«è½¬ä¹‰æˆâ€œ%20â€ï¼Œâ€œ?â€è¢«è½¬ä¹‰æˆâ€œ%3Fâ€ã€‚è€Œä¸­æ–‡ã€æ—¥æ–‡ç­‰åˆ™é€šå¸¸ä½¿ç”¨ UTF-8 ç¼–ç åå†è½¬ä¹‰ï¼Œä¾‹å¦‚â€œé“¶æ²³â€ä¼šè¢«è½¬ä¹‰æˆâ€œ%E9%93%B6%E6%B2%B3â€ã€‚ ç°åœ¨å¤šç”¨ï¼šencodeURIå…¶åŸç†æ˜¯æŠŠå­—ç¬¦ï¼ˆunicodeï¼‰ç¼–ç æˆutf-8ï¼Œutf-8æ˜¯ç”¨1-4ä¸ªå­—èŠ‚è¡¨ç¤ºçš„ï¼Œæ‰€ä»¥æ¯ä¸ªå­—èŠ‚è½¬æ¢æˆ16è¿›åˆ¶å¹¶åœ¨å‰é¢ç”¨ç™¾åˆ†å·ï¼ˆ%ï¼‰è¿æ¥ï¼Œæœ€åå¹¶æŠŠæ¯ä¸ªå­—èŠ‚è½¬æ¢çš„ç»“æœè¿æ¥èµ·æ¥ã€‚","categories":[],"tags":[{"name":"http URI/URL","slug":"http-URI-URL","permalink":"https://tsunamigg.github.io/tags/http-URI-URL/"}]},{"title":"2.httpæ˜¯ä»€ä¹ˆï¼Ÿ","slug":"http2","date":"2019-06-06T09:42:10.000Z","updated":"2020-06-01T14:36:38.877Z","comments":true,"path":"2019/06/06/http2/","link":"","permalink":"https://tsunamigg.github.io/2019/06/06/http2/","excerpt":"httpæ˜¯ä»€ä¹ˆï¼Ÿ å¦‚ä½•å‡†ç¡®çš„ä¸€å¥è¯æè¿°","text":"httpæ˜¯ä»€ä¹ˆï¼Ÿ å¦‚ä½•å‡†ç¡®çš„ä¸€å¥è¯æè¿° Httpæ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœä½ æ˜¯åœ¨é¢è¯•ï¼Œç¢°åˆ°è¿™ç§é—®é¢˜ï¼Œåƒä¸‡åˆ«ç”¨ä¸€å¥è¯å›ç­”ï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚ æŠŠå®ƒæ‹†è§£æˆæœ‰æ‰€å±å…³ç³»çš„ä¸‰ä¸ªè¯ï¼š åè®®ï¼Œä¼ è¾“åè®®ï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚ åè®®ä½ çš„äººç”Ÿåº”è¯¥æ˜¯å……æ»¡åè®®çš„ï¼Œä¸‰æ–¹åè®®ï¼Œç§Ÿæˆ¿åè®®ç­‰ç­‰â€¦. ä¸€èˆ¬åè®®ä¸­éƒ½ä¼šæœ‰ç”²æ–¹ä¹™æ–¹ä¸™æ–¹ç­‰ç­‰ã€‚ æˆ‘ä»¬ä¸ºäº†è¾¾æˆæŸç§ç›®çš„ï¼Œå¼ºåˆ¶æ€§çš„çº¦æŸå‚ä¸åè®®çš„å„æ–¹ï¼Œéµå®ˆåè®®çš„æ¡æ¬¾ï¼Œè¿çº¦äº†å°±ä¼šæœ‰ç›¸åº”çš„å¤„ç½šã€‚ å¹¿æ³›çš„æ¥çœ‹ï¼Œè®¡ç®—æœºä¸­çš„åè®®åˆ™æ˜¯æŒ‡çš„æ˜¯ï¼š äººä¸æœºæˆ–è€…æœºä¸æœºè¿›è¡Œäº¤äº’çš„è§„èŒƒã€‚ httpåè®®æ˜¯ä½¿ç”¨è®¡ç®—æœºèƒ½å¤Ÿç†è§£çš„è¯­è¨€ç¡®ç«‹äº†ä¸€ç§è®¡ç®—æœºä¹‹é—´äº¤æµé€šä¿¡çš„è§„èŒƒï¼Œä»¥åŠç›¸å…³çš„å„ç§æ§åˆ¶å’Œé”™è¯¯å¤„ç†æ–¹å¼ã€‚ ä¼ è¾“åè®®å¤§å¤šæ•°äººæƒ³åˆ°çš„å°±æ˜¯Aä¸Bä¹‹é—´çš„ä¼ è¾“ï¼Œå¹¶ä¸”åˆ†ä¸ºè¯·æ±‚æ–¹ä¸å“åº”æ–¹ã€‚ å¦‚æœä»â€œA&lt;===&gt;Bâ€ï¼Œå˜æˆäº†â€œA&lt;=&gt;X&lt;=&gt;Y&lt;=&gt;Z&lt;=&gt;Bâ€ ï¼Ÿï¼Ÿï¼Ÿ å¾ˆå¤šåœºæ™¯éƒ½æ˜¯éœ€è¦è¿™æ ·çš„ä¸­é—´äººã€‚ A åˆ° B çš„ä¼ è¾“è¿‡ç¨‹ä¸­å¯ä»¥å­˜åœ¨ä»»æ„å¤šä¸ªâ€œä¸­é—´äººâ€ï¼Œè€Œè¿™äº›ä¸­é—´äººä¹Ÿéƒ½éµä» HTTP åè®®ï¼Œåªè¦ä¸æ‰“æ‰°åŸºæœ¬çš„æ•°æ®ä¼ è¾“ï¼Œå°±å¯ä»¥æ·»åŠ ä»»æ„çš„é¢å¤–åŠŸèƒ½ï¼Œä¾‹å¦‚å®‰å…¨è®¤è¯ã€æ•°æ®å‹ç¼©ã€ç¼–ç è½¬æ¢ç­‰ç­‰ï¼Œä¼˜åŒ–æ•´ä¸ªä¼ è¾“è¿‡ç¨‹ã€‚ HTTP æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºä¸–ç•Œé‡Œä¸“é—¨ç”¨æ¥åœ¨ä¸¤ç‚¹ä¹‹é—´ä¼ è¾“æ•°æ®çš„çº¦å®šå’Œè§„èŒƒï¼Œå¹¶ä¸æ˜¯è®¡ç®—æœºAå’Œè®¡ç®—æœºBã€‚ è¶…æ–‡æœ¬ä¼ è¾“åè®®â€œæ–‡æœ¬â€ï¼Œåœ¨åè®®ä¸­ï¼Œæ˜¯å®Œæ•´çš„ã€æœ‰æ„ä¹‰çš„æ•°æ®ï¼Œå¯ä»¥è¢«æµè§ˆå™¨ã€æœåŠ¡å™¨è¿™æ ·çš„ä¸Šå±‚åº”ç”¨ç¨‹åºå¤„ç†ï¼Œè€Œä¸æ˜¯ TCP/UDP è¿™äº›åº•å±‚åè®®é‡Œè¢«åˆ‡åˆ†çš„æ‚ä¹±æ— ç« çš„äºŒè¿›åˆ¶åŒ…ï¼ˆdatagramï¼‰ã€‚ â€œè¶…æ–‡æœ¬â€ï¼Œå®ƒæ˜¯æ–‡å­—ã€å›¾ç‰‡ã€éŸ³é¢‘å’Œè§†é¢‘ç­‰çš„æ··åˆä½“ï¼Œæœ€å…³é”®çš„æ˜¯å«æœ‰â€œè¶…é“¾æ¥â€ï¼Œèƒ½å¤Ÿä»ä¸€ä¸ªâ€œè¶…æ–‡æœ¬â€è·³è·ƒåˆ°å¦ä¸€ä¸ªâ€œè¶…æ–‡æœ¬â€ï¼Œå½¢æˆå¤æ‚çš„éçº¿æ€§ã€ç½‘çŠ¶çš„ç»“æ„å…³ç³»ã€‚ æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„è¶…æ–‡æœ¬å°±åº”è¯¥æ˜¯ HTML äº†ï¼Œå®ƒæœ¬èº«åªæ˜¯çº¯æ–‡å­—æ–‡ä»¶ï¼Œä½†å†…éƒ¨ç”¨å¾ˆå¤šæ ‡ç­¾å®šä¹‰äº†å¯¹å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰çš„é“¾æ¥ï¼Œå†ç»è¿‡æµè§ˆå™¨çš„è§£é‡Šï¼Œå‘ˆç°åœ¨æˆ‘ä»¬é¢å‰çš„å°±æ˜¯ä¸€ä¸ªå«æœ‰å¤šç§è§†å¬ä¿¡æ¯çš„é¡µé¢ã€‚ éè¦ä¸€å¥è¯ï¼ŸHTTP æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºä¸–ç•Œé‡Œä¸“é—¨åœ¨ä¸¤ç‚¹ä¹‹é—´ä¼ è¾“æ–‡å­—ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰è¶…æ–‡æœ¬æ•°æ®çš„çº¦å®šå’Œè§„èŒƒã€ HTTP ä¸æ˜¯ä¸€ä¸ªå­¤ç«‹çš„åè®®ã€‚ä¿—è¯è¯´â€œä¸€ä¸ªå¥½æ±‰ä¸‰ä¸ªå¸®â€ï¼ŒHTTP ä¹Ÿæ˜¯å¦‚æ­¤ã€‚åœ¨äº’è”ç½‘ä¸–ç•Œé‡Œï¼ŒHTTP é€šå¸¸è·‘åœ¨ TCP/IP åè®®æ ˆä¹‹ä¸Šï¼Œä¾é  IP åè®®å®ç°å¯»å€å’Œè·¯ç”±ã€TCP åè®®å®ç°å¯é æ•°æ®ä¼ è¾“ã€DNS åè®®å®ç°åŸŸåæŸ¥æ‰¾ã€SSL/TLS åè®®å®ç°å®‰å…¨é€šä¿¡ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›åè®®ä¾èµ–äº HTTPï¼Œä¾‹å¦‚ WebSocketã€HTTPDNS ç­‰ã€‚è¿™äº›åè®®ç›¸äº’äº¤ç»‡ï¼Œæ„æˆäº†ä¸€ä¸ªåè®®ç½‘ï¼Œè€Œ HTTP åˆ™å¤„äºä¸­å¿ƒåœ°ä½ã€‚ çŸ¥è¯†map","categories":[],"tags":[{"name":"http","slug":"http","permalink":"https://tsunamigg.github.io/tags/http/"}]},{"title":"1.å¼€å§‹httpä¹‹è·¯","slug":"http1","date":"2019-06-01T14:12:42.000Z","updated":"2020-06-01T14:36:36.554Z","comments":true,"path":"2019/06/01/http1/","link":"","permalink":"https://tsunamigg.github.io/2019/06/01/http1/","excerpt":"httpå­¦ä¹ ç¬”è®°å¼€ç¯‡","text":"httpå­¦ä¹ ç¬”è®°å¼€ç¯‡ httpå‰ä¸–ä»Šç”Ÿ1989 å¹´ï¼Œä»»èŒäºæ¬§æ´²æ ¸å­ç ”ç©¶ä¸­å¿ƒï¼ˆCERNï¼‰çš„è’‚å§†Â·ä¼¯çº³æ–¯ - æï¼ˆTim Berners-Leeï¼‰å‘è¡¨äº†ä¸€ç¯‡è®ºæ–‡ï¼Œæå‡ºäº†åœ¨äº’è”ç½‘ä¸Šæ„å»ºè¶…é“¾æ¥æ–‡æ¡£ç³»ç»Ÿçš„æ„æƒ³ã€‚è¿™ç¯‡è®ºæ–‡ä¸­ä»–ç¡®ç«‹äº†ä¸‰é¡¹å…³é”®æŠ€æœ¯ã€‚ URIï¼šå³ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼Œä½œä¸ºäº’è”ç½‘ä¸Šèµ„æºçš„å”¯ä¸€èº«ä»½ï¼› HTMLï¼šå³è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼Œæè¿°è¶…æ–‡æœ¬æ–‡æ¡£ï¼› HTTPï¼šå³è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œç”¨æ¥ä¼ è¾“è¶…æ–‡æœ¬ã€‚ è¿™ä¸‰é¡¹æŠ€æœ¯åœ¨å¦‚ä»Šçš„æˆ‘ä»¬çœ‹æ¥å·²ç»æ˜¯ç¨€æ¾å¹³å¸¸ï¼Œä½†åœ¨å½“æ—¶å´æ˜¯äº†ä¸å¾—çš„å¤§å‘æ˜ã€‚åŸºäºå®ƒä»¬ï¼Œå°±å¯ä»¥æŠŠè¶…æ–‡æœ¬ç³»ç»Ÿå®Œç¾åœ°è¿è¡Œåœ¨äº’è”ç½‘ä¸Šï¼Œè®©å„åœ°çš„äººä»¬èƒ½å¤Ÿè‡ªç”±åœ°å…±äº«ä¿¡æ¯ï¼Œè’‚å§†æŠŠè¿™ä¸ªç³»ç»Ÿç§°ä¸ºâ€œä¸‡ç»´ç½‘â€ï¼ˆWorld Wide Webï¼‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç°åœ¨æ‰€ç†ŸçŸ¥çš„ Webã€‚ http/0.9è¿™ä¸€æ—¶æœŸçš„ HTTP è¢«å®šä¹‰ä¸º 0.9 ç‰ˆï¼Œç»“æ„æ¯”è¾ƒç®€å•ï¼Œä¸ºäº†ä¾¿äºæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å¤„ç†ï¼Œå®ƒä¹Ÿé‡‡ç”¨äº†çº¯æ–‡æœ¬æ ¼å¼ã€‚è’‚å§†Â·ä¼¯çº³æ–¯ - ææœ€åˆè®¾æƒ³çš„ç³»ç»Ÿé‡Œçš„æ–‡æ¡£éƒ½æ˜¯åªè¯»çš„ï¼Œæ‰€ä»¥åªå…è®¸ç”¨â€œGETâ€åŠ¨ä½œä»æœåŠ¡å™¨ä¸Šè·å– HTML æ–‡æ¡£ï¼Œå¹¶ä¸”åœ¨å“åº”è¯·æ±‚ä¹‹åç«‹å³å…³é—­è¿æ¥ï¼ŒåŠŸèƒ½éå¸¸æœ‰é™ã€‚ HTTP/0.9 è™½ç„¶å¾ˆç®€å•ï¼Œä½†å®ƒä½œä¸ºä¸€ä¸ªâ€œåŸå‹â€ï¼Œå……åˆ†éªŒè¯äº† Web æœåŠ¡çš„å¯è¡Œæ€§ï¼Œè€Œâ€œç®€å•â€ä¹Ÿæ­£æ˜¯å®ƒçš„ä¼˜ç‚¹ï¼Œè•´å«äº†è¿›åŒ–å’Œæ‰©å±•çš„å¯èƒ½æ€§ã€‚ http/1.0äº1996å¹´æ­£å¼å‘å¸ƒï¼Œå¯¹0.9è¿›è¡Œäº†åŠ å¼ºï¼ŒåŠ å¼ºæ–¹é¢å¦‚ä¸‹ï¼š å¢åŠ äº† HEADã€POST ç­‰æ–°æ–¹æ³•ï¼› å¢åŠ äº†å“åº”çŠ¶æ€ç ï¼Œæ ‡è®°å¯èƒ½çš„é”™è¯¯åŸå› ï¼› å¼•å…¥äº†åè®®ç‰ˆæœ¬å·æ¦‚å¿µï¼› å¼•å…¥äº† HTTP Headerï¼ˆå¤´éƒ¨ï¼‰çš„æ¦‚å¿µï¼Œè®© HTTP å¤„ç†è¯·æ±‚å’Œå“åº”æ›´åŠ çµæ´»ï¼› ä¼ è¾“çš„æ•°æ®ä¸å†ä»…é™äºæ–‡æœ¬ ç”±äºâ€œæµè§ˆå™¨å¤§æˆ˜â€ï¼Œè¿™æ¬¡çš„æ›´æ–°æ›´åƒæ˜¯ä¸€ä»½å¤‡å¿˜å½•ï¼Œè€Œä¸æ˜¯æ ‡å‡†ï¼Œå¹¶æ²¡æœ‰å¼•èµ·webä¸–ç•Œçš„æ¿€è¡ã€‚ http/1.1åœ¨â€œæµè§ˆå™¨å¤§æˆ˜â€ç»“æŸä¹‹åçš„ 1999 å¹´ï¼ŒHTTP/1.1 å‘å¸ƒäº† RFC æ–‡æ¡£ï¼Œç¼–å·ä¸º 2616ï¼Œæ­£å¼ç¡®ç«‹äº†å»¶ç»­åä½™å¹´çš„ä¼ å¥‡ã€‚ä¿®è®¢å¦‚ä¸‹ï¼š å¢åŠ äº† PUTã€DELETE ç­‰æ–°çš„æ–¹æ³•ï¼› å¢åŠ äº†ç¼“å­˜ç®¡ç†å’Œæ§åˆ¶ï¼› æ˜ç¡®äº†è¿æ¥ç®¡ç†ï¼Œå…è®¸æŒä¹…è¿æ¥ï¼› å…è®¸å“åº”æ•°æ®åˆ†å—ï¼ˆchunkedï¼‰ï¼Œåˆ©äºä¼ è¾“å¤§æ–‡ä»¶ï¼› å¼ºåˆ¶è¦æ±‚ Host å¤´ï¼Œè®©äº’è”ç½‘ä¸»æœºæ‰˜ç®¡æˆä¸ºå¯èƒ½ã€‚ 1.1æ˜¯ä¸€ä¸ªæ­£å¼çš„æ ‡å‡†ï¼Œæ˜¯è¡€ç¼˜æ­£ç»Ÿçš„ä¸‹ä¸€ä»£ï¼Œäº’è”ç½‘åœ¨å®ƒçš„â€œä¿é©¾æŠ¤èˆªâ€ä¸‹è¿ˆå¼€äº†å¤§æ­¥ï¼Œç”±æ­¤èµ°ä¸Šäº†â€œåº·åº„å¤§é“â€ï¼Œå¼€å¯äº†åç»­çš„â€œWeb 1.0â€â€œWeb 2.0â€æ—¶ä»£ã€‚ç°åœ¨è®¸å¤šçš„çŸ¥åç½‘ç«™éƒ½æ˜¯åœ¨è¿™ä¸ªæ—¶é—´ç‚¹å·¦å³åˆ›ç«‹çš„ï¼Œä¾‹å¦‚ Googleã€æ–°æµªã€æœç‹ã€ç½‘æ˜“ã€è…¾è®¯ç­‰ ä¸è¿‡ç”±äº HTTP/1.1 å¤ªè¿‡åºå¤§å’Œå¤æ‚ï¼Œæ‰€ä»¥åœ¨ 2014 å¹´åˆåšäº†ä¸€æ¬¡ä¿®è®¢ï¼ŒåŸæ¥çš„ä¸€ä¸ªå¤§æ–‡æ¡£è¢«æ‹†åˆ†æˆäº†å…­ä»½è¾ƒå°çš„æ–‡æ¡£ï¼Œç¼–å·ä¸º 7230-7235ï¼Œä¼˜åŒ–äº†ä¸€äº›ç»†èŠ‚ï¼Œä½†æ­¤å¤–æ²¡æœ‰ä»»ä½•å®è´¨æ€§çš„æ”¹åŠ¨ http/2ç»è¿‡è¿‘10å¹´çš„çˆ†ç‚¸å¼å¢é•¿åï¼Œ1.1å·²ç»æ— æ³•æ»¡è¶³ç°ä»£éœ€æ±‚(ä¸»è¦æ˜¯æ…¢)ã€‚äºæ˜¯Googleæ­ç«¿è€Œèµ·ï¼Œç”¨è‡ªå®¶å…¨çƒå æœ‰ç‡60%çš„Chromeï¼Œé¡ºåŠ¿æŠŠ SPDY æ¨ä¸Šäº†æ ‡å‡†çš„å®åº§ï¼Œäº’è”ç½‘æ ‡å‡†åŒ–ç»„ç»‡ä»¥ SPDY ä¸ºåŸºç¡€å¼€å§‹åˆ¶å®šæ–°ç‰ˆæœ¬çš„ HTTP åè®®ï¼Œæœ€ç»ˆåœ¨ 2015 å¹´å‘å¸ƒäº† HTTP/2ï¼ŒRFC ç¼–å· 7540ã€‚ HTTP/2 çš„åˆ¶å®šå……åˆ†è€ƒè™‘äº†ç°ä»Šäº’è”ç½‘çš„ç°çŠ¶ï¼šå®½å¸¦ã€ç§»åŠ¨ã€ä¸å®‰å…¨ï¼Œåœ¨é«˜åº¦å…¼å®¹ HTTP/1.1 çš„åŒæ—¶åœ¨æ€§èƒ½æ”¹å–„æ–¹é¢åšäº†å¾ˆå¤§åŠªåŠ›ï¼Œä¸»è¦çš„ç‰¹ç‚¹æœ‰ï¼š äºŒè¿›åˆ¶åè®®ï¼Œä¸å†æ˜¯çº¯æ–‡æœ¬ï¼› å¯å‘èµ·å¤šä¸ªè¯·æ±‚ï¼ŒåºŸå¼ƒäº† 1.1 é‡Œçš„ç®¡é“ï¼› ä½¿ç”¨ä¸“ç”¨ç®—æ³•å‹ç¼©å¤´éƒ¨ï¼Œå‡å°‘æ•°æ®ä¼ è¾“é‡ï¼› å…è®¸æœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ï¼› å¢å¼ºäº†å®‰å…¨æ€§ï¼Œâ€œäº‹å®ä¸Šâ€è¦æ±‚åŠ å¯†é€šä¿¡ è™½ç„¶2è¯ç”Ÿäº†å·²4å¹´ï¼Œä½†ç°ä»Šæ™®åŠç‡è¿˜å¾ˆä½ï¼ŒåŸºæœ¬éƒ½è¿˜æ˜¯20å¹´ä¹‹å‰çš„1.1ï¼Œå¯è§1.1ä¹‹ç»å…¸ä¸å¼ºå¤§ï¼ http/3åœ¨ HTTP/2 è¿˜å¤„äºè‰æ¡ˆä¹‹æ—¶ï¼ŒGoogle åˆå‘æ˜äº†ä¸€ä¸ªæ–°çš„åè®®ï¼Œå«åš QUICï¼Œè€Œä¸”è¿˜æ˜¯ç›¸åŒçš„â€œå¥—è·¯â€ï¼Œç»§ç»­åœ¨ Chrome å’Œè‡ªå®¶æœåŠ¡å™¨é‡Œè¯•éªŒç€â€œç©â€ï¼Œä¾æ‰˜å®ƒçš„åºå¤§ç”¨æˆ·é‡å’Œæ•°æ®é‡ï¼ŒæŒç»­åœ°æ¨åŠ¨ QUIC åè®®æˆä¸ºäº’è”ç½‘ä¸Šçš„â€œæ—¢æˆäº‹å®â€ã€‚ åœ¨ 2018 å¹´ï¼Œäº’è”ç½‘æ ‡å‡†åŒ–ç»„ç»‡ IETF æè®®å°†â€œHTTP over QUICâ€æ›´åä¸ºâ€œHTTP/3â€å¹¶è·å¾—æ‰¹å‡†ï¼ŒHTTP/3 æ­£å¼è¿›å…¥äº†æ ‡å‡†åŒ–åˆ¶è®¢é˜¶æ®µï¼Œä¹Ÿè®¸ä¸¤ä¸‰å¹´åå°±ä¼šæ­£å¼å‘å¸ƒï¼Œåˆ°æ—¶å€™æˆ‘ä»¬å¾ˆå¯èƒ½ä¼šè·³è¿‡ HTTP/2 ç›´æ¥è¿›å…¥ HTTP/3ã€‚ Httpæ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœä½ æ˜¯åœ¨é¢è¯•ï¼Œç¢°åˆ°è¿™ç§é—®é¢˜ï¼Œåƒä¸‡åˆ«ç”¨ä¸€å¥è¯å›ç­”ï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚ æŠŠå®ƒæ‹†è§£æˆæœ‰æ‰€å±å…³ç³»çš„ä¸‰ä¸ªè¯ï¼š åè®®ï¼Œä¼ è¾“åè®®ï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚ åè®®ä½ çš„äººç”Ÿåº”è¯¥æ˜¯å……æ»¡åè®®çš„ï¼Œä¸‰æ–¹åè®®ï¼Œç§Ÿæˆ¿åè®®ç­‰ç­‰â€¦. ä¸€èˆ¬åè®®ä¸­éƒ½ä¼šæœ‰ç”²æ–¹ä¹™æ–¹ä¸™æ–¹ç­‰ç­‰ã€‚ æˆ‘ä»¬ä¸ºäº†è¾¾æˆæŸç§ç›®çš„ï¼Œå¼ºåˆ¶æ€§çš„çº¦æŸå‚ä¸åè®®çš„å„æ–¹ï¼Œéµå®ˆåè®®çš„æ¡æ¬¾ï¼Œè¿çº¦äº†å°±ä¼šæœ‰ç›¸åº”çš„å¤„ç½šã€‚ å¹¿æ³›çš„æ¥çœ‹ï¼Œè®¡ç®—æœºä¸­çš„åè®®åˆ™æ˜¯æŒ‡çš„æ˜¯ï¼š äººä¸æœºæˆ–è€…æœºä¸æœºè¿›è¡Œäº¤äº’çš„è§„èŒƒã€‚ httpåè®®æ˜¯ä½¿ç”¨è®¡ç®—æœºèƒ½å¤Ÿç†è§£çš„è¯­è¨€ç¡®ç«‹äº†ä¸€ç§è®¡ç®—æœºä¹‹é—´äº¤æµé€šä¿¡çš„è§„èŒƒï¼Œä»¥åŠç›¸å…³çš„å„ç§æ§åˆ¶å’Œé”™è¯¯å¤„ç†æ–¹å¼ã€‚ ä¼ è¾“åè®®å¤§å¤šæ•°äººæƒ³åˆ°çš„å°±æ˜¯Aä¸Bä¹‹é—´çš„ä¼ è¾“ï¼Œå¹¶ä¸”åˆ†ä¸ºè¯·æ±‚æ–¹ä¸å“åº”æ–¹ã€‚ å¦‚æœä»â€œA&lt;===&gt;Bâ€ï¼Œå˜æˆäº†â€œA&lt;=&gt;X&lt;=&gt;Y&lt;=&gt;Z&lt;=&gt;Bâ€ ï¼Ÿï¼Ÿï¼Ÿ å¾ˆå¤šåœºæ™¯éƒ½æ˜¯éœ€è¦è¿™æ ·çš„ä¸­é—´äººã€‚ A åˆ° B çš„ä¼ è¾“è¿‡ç¨‹ä¸­å¯ä»¥å­˜åœ¨ä»»æ„å¤šä¸ªâ€œä¸­é—´äººâ€ï¼Œè€Œè¿™äº›ä¸­é—´äººä¹Ÿéƒ½éµä» HTTP åè®®ï¼Œåªè¦ä¸æ‰“æ‰°åŸºæœ¬çš„æ•°æ®ä¼ è¾“ï¼Œå°±å¯ä»¥æ·»åŠ ä»»æ„çš„é¢å¤–åŠŸèƒ½ï¼Œä¾‹å¦‚å®‰å…¨è®¤è¯ã€æ•°æ®å‹ç¼©ã€ç¼–ç è½¬æ¢ç­‰ç­‰ï¼Œä¼˜åŒ–æ•´ä¸ªä¼ è¾“è¿‡ç¨‹ã€‚ HTTP æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºä¸–ç•Œé‡Œä¸“é—¨ç”¨æ¥åœ¨ä¸¤ç‚¹ä¹‹é—´ä¼ è¾“æ•°æ®çš„çº¦å®šå’Œè§„èŒƒï¼Œå¹¶ä¸æ˜¯è®¡ç®—æœºAå’Œè®¡ç®—æœºBã€‚ è¶…æ–‡æœ¬ä¼ è¾“åè®®â€œæ–‡æœ¬â€ï¼Œåœ¨åè®®ä¸­ï¼Œæ˜¯å®Œæ•´çš„ã€æœ‰æ„ä¹‰çš„æ•°æ®ï¼Œå¯ä»¥è¢«æµè§ˆå™¨ã€æœåŠ¡å™¨è¿™æ ·çš„ä¸Šå±‚åº”ç”¨ç¨‹åºå¤„ç†ï¼Œè€Œä¸æ˜¯ TCP/UDP è¿™äº›åº•å±‚åè®®é‡Œè¢«åˆ‡åˆ†çš„æ‚ä¹±æ— ç« çš„äºŒè¿›åˆ¶åŒ…ï¼ˆdatagramï¼‰ã€‚ â€œè¶…æ–‡æœ¬â€ï¼Œå®ƒæ˜¯æ–‡å­—ã€å›¾ç‰‡ã€éŸ³é¢‘å’Œè§†é¢‘ç­‰çš„æ··åˆä½“ï¼Œæœ€å…³é”®çš„æ˜¯å«æœ‰â€œè¶…é“¾æ¥â€ï¼Œèƒ½å¤Ÿä»ä¸€ä¸ªâ€œè¶…æ–‡æœ¬â€è·³è·ƒåˆ°å¦ä¸€ä¸ªâ€œè¶…æ–‡æœ¬â€ï¼Œå½¢æˆå¤æ‚çš„éçº¿æ€§ã€ç½‘çŠ¶çš„ç»“æ„å…³ç³»ã€‚ æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„è¶…æ–‡æœ¬å°±åº”è¯¥æ˜¯ HTML äº†ï¼Œå®ƒæœ¬èº«åªæ˜¯çº¯æ–‡å­—æ–‡ä»¶ï¼Œä½†å†…éƒ¨ç”¨å¾ˆå¤šæ ‡ç­¾å®šä¹‰äº†å¯¹å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰çš„é“¾æ¥ï¼Œå†ç»è¿‡æµè§ˆå™¨çš„è§£é‡Šï¼Œå‘ˆç°åœ¨æˆ‘ä»¬é¢å‰çš„å°±æ˜¯ä¸€ä¸ªå«æœ‰å¤šç§è§†å¬ä¿¡æ¯çš„é¡µé¢ã€‚ éè¦ä¸€å¥è¯ï¼ŸHTTP æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºä¸–ç•Œé‡Œä¸“é—¨åœ¨ä¸¤ç‚¹ä¹‹é—´ä¼ è¾“æ–‡å­—ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰è¶…æ–‡æœ¬æ•°æ®çš„çº¦å®šå’Œè§„èŒƒã€ HTTP ä¸æ˜¯ä¸€ä¸ªå­¤ç«‹çš„åè®®ã€‚ä¿—è¯è¯´â€œä¸€ä¸ªå¥½æ±‰ä¸‰ä¸ªå¸®â€ï¼ŒHTTP ä¹Ÿæ˜¯å¦‚æ­¤ã€‚åœ¨äº’è”ç½‘ä¸–ç•Œé‡Œï¼ŒHTTP é€šå¸¸è·‘åœ¨ TCP/IP åè®®æ ˆä¹‹ä¸Šï¼Œä¾é  IP åè®®å®ç°å¯»å€å’Œè·¯ç”±ã€TCP åè®®å®ç°å¯é æ•°æ®ä¼ è¾“ã€DNS åè®®å®ç°åŸŸåæŸ¥æ‰¾ã€SSL/TLS åè®®å®ç°å®‰å…¨é€šä¿¡ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›åè®®ä¾èµ–äº HTTPï¼Œä¾‹å¦‚ WebSocketã€HTTPDNS ç­‰ã€‚è¿™äº›åè®®ç›¸äº’äº¤ç»‡ï¼Œæ„æˆäº†ä¸€ä¸ªåè®®ç½‘ï¼Œè€Œ HTTP åˆ™å¤„äºä¸­å¿ƒåœ°ä½ã€‚ çŸ¥è¯†map","categories":[],"tags":[{"name":"http","slug":"http","permalink":"https://tsunamigg.github.io/tags/http/"}]},{"title":"ESmodule","slug":"ESmodule","date":"2019-05-28T12:07:12.000Z","updated":"2020-05-28T14:21:05.901Z","comments":true,"path":"2019/05/28/ESmodule/","link":"","permalink":"https://tsunamigg.github.io/2019/05/28/ESmodule/","excerpt":"ESmoduleçš„æ ‡å‡†åŒ–å®Œæˆä¸€å®šä¼šæ€èµ·æ³¢æ¾œ~","text":"ESmoduleçš„æ ‡å‡†åŒ–å®Œæˆä¸€å®šä¼šæ€èµ·æ³¢æ¾œ~ å›¾è¯´ ES Modulesï¼ˆè½¬è½½è¯‘æ–‡ï¼‰åŸæ–‡ï¼šES modules: A cartoon deep-dive, Lin Clark ES modulesï¼ˆESMï¼‰ æ˜¯ JavaScript å®˜æ–¹çš„æ ‡å‡†åŒ–æ¨¡å—ç³»ç»Ÿã€‚ç„¶è€Œï¼Œå®ƒåœ¨æ ‡å‡†åŒ–çš„é“è·¯ä¸Šå·²ç»èŠ±è´¹äº†è¿‘ 10 å¹´çš„æ—¶é—´ã€‚ å¯å–œçš„æ˜¯ï¼Œæ ‡å‡†åŒ–ä¹‹è·¯é©¬ä¸Šå°±è¦å®Œæˆäº†ã€‚ç­‰åˆ° 2018 å¹´ 5 æœˆ Firefox 60 å‘å¸ƒä¹‹åï¼Œæ‰€æœ‰çš„ä¸»æµæµè§ˆå™¨å°±éƒ½æ”¯æŒ ESM äº†ã€‚åŒæ—¶ï¼ŒNode æ¨¡å—å·¥ä½œå°ç»„ä¹Ÿæ­£åœ¨ä¸º Node.js æ·»åŠ  ESM æ”¯æŒã€‚ä¸º WebAssembly æä¾› ESM é›†æˆçš„å·¥ä½œä¹Ÿæ­£åœ¨å¦‚ç«å¦‚è¼çš„è¿›è¡Œã€‚ è®¸å¤š JS å¼€å‘è€…éƒ½çŸ¥é“ï¼Œå¯¹ ESM çš„è®¨è®ºä»å¼€å§‹è‡³ä»Šä¸€ç›´éƒ½æ²¡åœè¿‡ã€‚ä½†æ˜¯å¾ˆå°‘æœ‰äººçœŸæ­£ç†è§£ ESM çš„å·¥ä½œåŸç†ã€‚ ä»Šå¤©ï¼Œè®©æˆ‘ä»¬æ¥æ¢³ç†æ¢³ç† ESM åˆ°åº•è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠå®ƒè·Ÿå…¶ä»–æ¨¡å—ç³»ç»Ÿä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ ä¸ºä½•è¦æ¨¡å—åŒ–è¯´åˆ° JS ç¼–ç¨‹ï¼Œå…¶å®è¯´çš„å°±æ˜¯å¦‚ä½•ç®¡ç†å˜é‡ã€‚ç¼–ç¨‹çš„è¿‡ç¨‹éƒ½æ˜¯å…³äºå¦‚ä½•ç»™å˜é‡èµ‹å€¼ï¼Œè¦ä¹ˆç›´æ¥èµ‹å€¼ç»™å˜é‡ï¼Œè¦ä¹ˆæ˜¯æŠŠä¸¤ä¸ªå˜é‡ç»“åˆèµ·æ¥ç„¶åå†æŠŠç»“æœèµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡ å› ä¸ºå¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯å…³äºæ”¹å˜å˜é‡çš„ï¼Œæ‰€ä»¥å¦‚ä½•ç»„ç»‡è¿™äº›å˜é‡å°±ç›´æ¥å½±å“äº†ç¼–ç è´¨é‡ï¼Œä»¥åŠç»´æŠ¤å®ƒä»¬çš„æˆæœ¬ã€‚ å¦‚æœä»£ç ä¸­ä»…æœ‰å°‘é‡çš„å˜é‡ï¼Œé‚£ä¹ˆç»„ç»‡èµ·æ¥å…¶å®æ˜¯å¾ˆç®€å•çš„ã€‚JS æœ¬èº«å°±æä¾›äº†ä¸€ç§æ–¹å¼å¸®ä½ ç»„ç»‡å˜é‡ï¼Œç§°ä¸ºå‡½æ•°ä½œç”¨åŸŸã€‚å› ä¸ºå‡½æ•°ä½œç”¨åŸŸçš„ç¼˜æ•…ï¼Œä¸€ä¸ªå‡½æ•°æ— æ³•è®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä¸­å®šä¹‰çš„å˜é‡ã€‚ è¿™ç§æ–¹å¼æ˜¯å¾ˆæœ‰æ•ˆçš„ã€‚å®ƒä½¿å¾—æˆ‘ä»¬åœ¨å†™ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œåªéœ€è¦è€ƒè™‘å½“å‰å‡½æ•°ï¼Œè€Œä¸å¿…æ‹…å¿ƒå…¶å®ƒå‡½æ•°å¯èƒ½ä¼šæ”¹å˜å½“å‰å‡½æ•°çš„å˜é‡ã€‚ä¸è¿‡ï¼Œå®ƒä¹Ÿæœ‰ä¸å¥½çš„åœ°æ–¹ã€‚å®ƒä¼šè®©æˆ‘ä»¬å¾ˆéš¾åœ¨ä¸åŒå‡½æ•°ä¹‹é—´å…±äº«å˜é‡ã€‚ å¦‚æœæˆ‘ä»¬æƒ³è·Ÿå½“å‰å‡½æ•°ä»¥å¤–çš„å‡½æ•°å…±äº«å˜é‡è¦æ€ä¹ˆåŠå‘¢ï¼Ÿä¸€ç§é€šç”¨çš„åšæ³•æ˜¯æŠŠè¦å…±äº«çš„å˜é‡æå‡åˆ°ä¸Šä¸€å±‚ä½œç”¨åŸŸï¼Œæ¯”å¦‚å…¨å±€ä½œç”¨åŸŸã€‚ åœ¨ jQuery æ—¶ä»£è¿™ç§æå‡åšæ³•ç›¸å½“æ™®éã€‚åœ¨æˆ‘ä»¬åŠ è½½ä»»ä½• jQuery æ’ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿ jQuery å·²ç»å­˜åœ¨äºå…¨å±€ä½œç”¨åŸŸã€‚ è¿™ç§åšæ³•ä¹Ÿç¡®å®è¡Œä¹‹æœ‰æ•ˆï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†ä»¤äººçƒ¦æ¼çš„å½±å“ã€‚é¦–å…ˆï¼Œæ‰€æœ‰çš„ &lt;script&gt; å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºæ’åˆ—ï¼Œå¼€å‘è€…å¿…é¡»éå¸¸è°¨æ…åœ°ç¡®ä¿æ²¡æœ‰ä»»ä½•ä¸€ä¸ªè„šæœ¬æ’åˆ—é”™è¯¯ã€‚ å¦‚æœæ’åˆ—é”™äº†ï¼Œé‚£ä¹ˆåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œåº”ç”¨å°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚å½“å‡½æ•°åœ¨å…¨å±€ä½œç”¨åŸŸå¯»æ‰¾ jQuery å˜é‡æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šæŠ›å‡ºå¼‚å¸¸é”™è¯¯ï¼Œå¹¶ä¸”åœæ­¢ç»§ç»­è¿è¡Œã€‚ è¿™åŒæ—¶ä¹Ÿä½¿å¾—ä»£ç çš„åæœŸç»´æŠ¤å˜å¾—å›°éš¾ã€‚å®ƒä¼šä½¿å¾—ç§»é™¤æ—§ä»£ç æˆ–è€…è„šæœ¬æ ‡ç­¾å˜å¾—å……æ»¡ä¸ç¡®å®šæ€§ã€‚ä½ æ ¹æœ¬ä¸çŸ¥é“ç§»é™¤å®ƒä¼šå¸¦æ¥ä»€ä¹ˆå½±å“ã€‚ä»£ç ä¹‹é—´çš„ä¾èµ–æ˜¯ä¸é€æ˜çš„ã€‚ä»»ä½•å‡½æ•°éƒ½å¯èƒ½ä¾èµ–å…¨å±€ä½œç”¨åŸŸä¸­çš„ä»»ä½•å˜é‡ï¼Œä»¥è‡³äºä½ ä¹Ÿä¸çŸ¥é“å“ªä¸ªå‡½æ•°ä¾èµ–å“ªä¸ªè„šæœ¬ã€‚ å…¶æ¬¡ï¼Œç”±äºå˜é‡å­˜åœ¨äºå…¨å±€ä½œç”¨åŸŸï¼Œæ‰€ä»¥ä»»ä½•ä»£ç éƒ½å¯ä»¥æ”¹å˜å®ƒã€‚æ¶æ„çš„ä»£ç å¯èƒ½ä¼šæ•…æ„æ”¹å˜å…¨å±€å˜é‡ï¼Œä»è€Œè®©ä½ çš„ä»£ç åšå‡ºå±é™©è¡Œä¸ºã€‚åˆæˆ–è€…ï¼Œä»£ç å¯èƒ½ä¸æ˜¯æ¶æ„çš„ï¼Œä½†æ˜¯å´æ— æ„åœ°æ”¹å˜äº†ä½ æœŸæœ›çš„å˜é‡ã€‚ã€ æ¨¡å—åŒ–çš„ä½œç”¨æ¨¡å—åŒ–ä¸ºä½ æä¾›äº†ä¸€ç§æ›´å¥½çš„æ–¹å¼æ¥ç»„ç»‡å˜é‡å’Œå‡½æ•°ã€‚ä½ å¯ä»¥æŠŠç›¸å…³çš„å˜é‡å’Œå‡½æ•°æ”¾åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªæ¨¡å—ã€‚ è¿™ç§ç»„ç»‡æ–¹å¼ä¼šæŠŠå‡½æ•°å’Œå˜é‡æ”¾åœ¨æ¨¡å—ä½œç”¨åŸŸä¸­ã€‚æ¨¡å—ä¸­çš„å‡½æ•°å¯ä»¥é€šè¿‡æ¨¡å—ä½œç”¨åŸŸæ¥å…±äº«å˜é‡ã€‚ ä¸è¿‡ï¼Œä¸å‡½æ•°ä½œç”¨åŸŸä¸åŒçš„æ˜¯ï¼Œæ¨¡å—ä½œç”¨åŸŸè¿˜æä¾›äº†ä¸€ç§æš´éœ²å˜é‡ç»™å…¶ä»–æ¨¡å—ä½¿ç”¨çš„æ–¹å¼ã€‚æ¨¡å—å¯ä»¥æ˜ç¡®åœ°æŒ‡å®šå“ªäº›å˜é‡ã€ç±»æˆ–å‡½æ•°å¯¹å¤–æš´éœ²ã€‚ å¯¹å¤–æš´éœ²çš„è¿‡ç¨‹ç§°ä¸ºå¯¼å‡ºã€‚ä¸€æ—¦å¯¼å‡ºï¼Œå…¶ä»–æ¨¡å—å°±å¯ä»¥æ˜ç¡®åœ°å£°ç§°å®ƒä»¬ä¾èµ–è¿™äº›å¯¼å‡ºçš„å˜é‡ã€ç±»æˆ–è€…å‡½æ•°ã€‚ å› ä¸ºè¿™æ˜¯ä¸€ç§æ˜ç¡®çš„å…³ç³»ï¼Œæ‰€ä»¥ä½ å¯ä»¥å¾ˆç®€å•åœ°è¾¨åˆ«å“ªäº›ä»£ç èƒ½ç§»é™¤ï¼Œå“ªäº›ä¸èƒ½ç§»é™¤ã€‚ æ‹¥æœ‰äº†åœ¨æ¨¡å—ä¹‹é—´å¯¼å‡ºå’Œå¯¼å…¥å˜é‡çš„èƒ½åŠ›ä¹‹åï¼Œä½ å°±å¯ä»¥æŠŠä»£ç åˆ†å‰²æˆæ›´å°çš„ã€å¯ä»¥ç‹¬ç«‹è¿è¡Œåœ°ä»£ç å—äº†ã€‚ç„¶åï¼Œä½ å°±å¯ä»¥åƒæ­ä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼ŒåŸºäºè¿™äº›ä»£ç å—ï¼Œåˆ›å»ºæ‰€æœ‰ä¸åŒç±»å‹çš„åº”ç”¨ã€‚ ç”±äºæ¨¡å—åŒ–æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œæ‰€ä»¥å†å²ä¸Šæ›¾ç»å¤šæ¬¡å°è¯•ä¸º JS æ·»åŠ æ¨¡å—åŒ–çš„åŠŸèƒ½ã€‚ä¸è¿‡æˆªæ­¢åˆ°ç›®å‰ï¼ŒçœŸæ­£å¾—åˆ°å¹¿æ³›ä½¿ç”¨çš„åªæœ‰ä¸¤ä¸ªæ¨¡å—ç³»ç»Ÿã€‚ä¸€ä¸ªæ˜¯ Node.js ä½¿ç”¨çš„ CommonJS ï¼ˆCJSï¼‰ï¼›å¦ä¸€ä¸ªæ˜¯ JS è§„èŒƒçš„æ–°æ¨¡å—ç³»ç»Ÿ EcmaScript modulesï¼ˆESMï¼‰ï¼ŒNode.js ä¹Ÿæ­£åœ¨æ·»åŠ å¯¹ ESM çš„æ”¯æŒã€‚ ä¸‹é¢å°±è®©æˆ‘ä»¬æ¥æ·±å…¥ç†è§£ä¸‹è¿™ä¸ªæ–°çš„æ¨¡å—ç³»ç»Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ ESM åŸç†å½“ä½ åœ¨ä½¿ç”¨æ¨¡å—è¿›è¡Œå¼€å‘æ—¶ï¼Œå…¶å®æ˜¯åœ¨æ„å»ºä¸€å¼ ä¾èµ–å…³ç³»å›¾ã€‚ä¸åŒæ¨¡å—ä¹‹é—´çš„è¿çº¿å°±ä»£è¡¨äº†ä»£ç ä¸­çš„å¯¼å…¥è¯­å¥ã€‚ æ­£æ˜¯è¿™äº›å¯¼å…¥è¯­å¥å‘Šè¯‰æµè§ˆå™¨æˆ–è€… Node è¯¥å»åŠ è½½å“ªäº›ä»£ç ã€‚æˆ‘ä»¬è¦åšçš„æ˜¯ä¸ºä¾èµ–å…³ç³»å›¾æŒ‡å®šä¸€ä¸ªå…¥å£æ–‡ä»¶ã€‚ä»è¿™ä¸ªå…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæµè§ˆå™¨æˆ–è€… Node å°±ä¼šé¡ºç€å¯¼å…¥è¯­å¥æ‰¾å‡ºæ‰€ä¾èµ–çš„å…¶ä»–ä»£ç æ–‡ä»¶ã€‚ ä½†æ˜¯å‘¢ï¼Œæµè§ˆå™¨å¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨è¿™äº›ä»£ç æ–‡ä»¶ã€‚å®ƒéœ€è¦è§£ææ‰€æœ‰çš„æ–‡ä»¶ï¼Œå¹¶æŠŠå®ƒä»¬å˜æˆä¸€ç§ç§°ä¸ºæ¨¡å—è®°å½•ï¼ˆModule Recordï¼‰çš„æ•°æ®ç»“æ„ã€‚åªæœ‰è¿™æ ·ï¼Œå®ƒæ‰çŸ¥é“ä»£ç æ–‡ä»¶ä¸­åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚ è§£æä¹‹åï¼Œè¿˜éœ€è¦æŠŠæ¨¡å—è®°å½•å˜æˆä¸€ä¸ªæ¨¡å—å®ä¾‹ã€‚æ¨¡å—å®ä¾‹ä¼šæŠŠä»£ç å’ŒçŠ¶æ€ç»“åˆèµ·æ¥ã€‚ æ‰€è°“ä»£ç ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ç»„æŒ‡ä»¤é›†åˆã€‚å®ƒå°±åƒæ˜¯åˆ¶ä½œæŸæ ·ä¸œè¥¿çš„é…æ–¹ï¼ŒæŒ‡å¯¼ä½ è¯¥å¦‚ä½•åˆ¶ä½œã€‚ä½†æ˜¯å®ƒæœ¬èº«å¹¶ä¸èƒ½è®©ä½ å®Œæˆåˆ¶ä½œã€‚ä½ è¿˜éœ€è¦ä¸€äº›åŸæ–™ï¼Œè¿™æ ·æ‰å¯ä»¥æŒ‰ç…§è¿™äº›æŒ‡ä»¤å®Œæˆåˆ¶ä½œã€‚ æ‰€è°“çŠ¶æ€ï¼Œå®ƒå°±æ˜¯åŸæ–™ã€‚å…·ä½“ç‚¹ï¼ŒçŠ¶æ€æ˜¯å˜é‡åœ¨ä»»ä½•æ—¶å€™çš„çœŸå®å€¼ã€‚å½“ç„¶ï¼Œå˜é‡å®é™…ä¸Šå°±æ˜¯å†…å­˜åœ°å€çš„åˆ«åï¼Œå†…å­˜æ‰æ˜¯æ­£åœ¨å­˜å‚¨å€¼çš„åœ°æ–¹ã€‚ æ‰€ä»¥ï¼Œå¯ä»¥çœ‹å‡ºï¼Œæ¨¡å—å®ä¾‹ä¸­ä»£ç å’ŒçŠ¶æ€çš„ç»“åˆï¼Œå°±æ˜¯æŒ‡ä»¤é›†å’Œå˜é‡å€¼çš„ç»“åˆã€‚ å¯¹äºæ¨¡å—è€Œè¨€ï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯æ¨¡å—å®ä¾‹ã€‚æ¨¡å—åŠ è½½ä¼šä»å…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæœ€ç»ˆç”Ÿæˆå®Œæ•´çš„æ¨¡å—å®ä¾‹å…³ç³»å›¾ã€‚ å¯¹äº ESM ï¼Œè¿™ä¸ªè¿‡ç¨‹åŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š æ„å»ºï¼šæŸ¥æ‰¾ï¼Œä¸‹è½½ï¼Œç„¶åæŠŠæ‰€æœ‰æ–‡ä»¶è§£ææˆæ¨¡å—è®°å½•ã€‚ å®ä¾‹åŒ–ï¼šä¸ºæ‰€æœ‰æ¨¡å—åˆ†é…å†…å­˜ç©ºé—´ï¼ˆæ­¤åˆ»è¿˜æ²¡æœ‰å¡«å……å€¼ï¼‰ï¼Œç„¶åä¾ç…§å¯¼å‡ºã€å¯¼å…¥è¯­å¥æŠŠæ¨¡å—æŒ‡å‘å¯¹åº”çš„å†…å­˜åœ°å€ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºé“¾æ¥ï¼ˆLinkingï¼‰ã€‚ è¿è¡Œï¼šè¿è¡Œä»£ç ï¼Œä»è€ŒæŠŠå†…å­˜ç©ºé—´å¡«å……ä¸ºçœŸå®å€¼ã€‚ å¤§å®¶éƒ½è¯´ ESM æ˜¯å¼‚æ­¥çš„ã€‚å› ä¸ºå®ƒæŠŠæ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºäº†ä¸‰ä¸ªä¸åŒçš„é˜¶æ®µï¼šåŠ è½½ã€å®ä¾‹åŒ–å’Œè¿è¡Œï¼Œå¹¶ä¸”è¿™ä¸‰ä¸ªé˜¶æ®µæ˜¯å¯ä»¥ç‹¬ç«‹è¿›è¡Œçš„ã€‚ è¿™æ„å‘³ç€ï¼ŒESM è§„èŒƒç¡®å®å¼•å…¥äº†ä¸€ç§å¼‚æ­¥æ–¹å¼ï¼Œä¸”è¿™ç§å¼‚æ­¥æ–¹å¼åœ¨ CJS ä¸­æ˜¯æ²¡æœ‰çš„ã€‚åé¢æˆ‘ä»¬ä¼šè¯¦ç»†è¯´åˆ°ä¸ºä»€ä¹ˆï¼Œç„¶è€Œåœ¨ CJS ä¸­ï¼Œä¸€ä¸ªæ¨¡å—åŠå…¶ä¾èµ–çš„åŠ è½½ã€å®ä¾‹åŒ–å’Œè¿è¡Œæ˜¯ä¸€èµ·é¡ºåºæ‰§è¡Œçš„ï¼Œä¸­é—´æ²¡æœ‰ä»»ä½•é—´æ–­ã€‚ ä¸è¿‡ï¼Œè¿™ä¸‰ä¸ªé˜¶æ®µæœ¬èº«æ˜¯æ²¡å¿…è¦å¼‚æ­¥åŒ–ã€‚å®ƒä»¬å¯ä»¥åŒæ­¥æ‰§è¡Œï¼Œè¿™å–å†³äºå®ƒæ˜¯ç”±è°æ¥åŠ è½½çš„ã€‚å› ä¸º ESM æ ‡å‡†å¹¶æ²¡æœ‰æ˜ç¡®è§„èŒƒæ‰€æœ‰ç›¸å…³å†…å®¹ã€‚å®é™…ä¸Šï¼Œè¿™äº›å·¥ä½œåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå¹¶ä¸”åˆ†åˆ«æ˜¯ç”±ä¸åŒçš„æ ‡å‡†æ‰€è§„èŒƒçš„ã€‚ å…¶ä¸­ï¼ŒESM æ ‡å‡† è§„èŒƒäº†å¦‚ä½•æŠŠæ–‡ä»¶è§£æä¸ºæ¨¡å—è®°å½•ï¼Œå¦‚ä½•å®ä¾‹åŒ–å’Œå¦‚ä½•è¿è¡Œæ¨¡å—ã€‚ä½†æ˜¯å®ƒæ²¡æœ‰è§„èŒƒå¦‚ä½•è·å–æ–‡ä»¶ã€‚ æ–‡ä»¶æ˜¯ç”±åŠ è½½å™¨æ¥æå–çš„ï¼Œè€ŒåŠ è½½å™¨ç”±å¦ä¸€ä¸ªä¸åŒçš„æ ‡å‡†æ‰€è§„èŒƒã€‚å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œè¿™ä¸ªæ ‡å‡†å°±æ˜¯ HTMLã€‚ä½†æ˜¯ä½ è¿˜å¯ä»¥æ ¹æ®æ‰€ä½¿ç”¨çš„å¹³å°ä½¿ç”¨ä¸åŒçš„åŠ è½½å™¨ã€‚ åŠ è½½å™¨ä¹ŸåŒæ—¶æ§åˆ¶ç€å¦‚ä½•åŠ è½½æ¨¡å—ã€‚å®ƒä¼šè°ƒç”¨ ESM çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ ParseModuleã€Module.Instantiate å’Œ Module.Evaluate ã€‚å®ƒå°±åƒæ˜¯æ§åˆ¶ç€ JS å¼•æ“çš„æœ¨å¶ã€‚ ä¸‹é¢æˆ‘ä»¬å°†æ›´åŠ è¯¦ç»†åœ°è¯´æ˜æ¯ä¸€æ­¥ã€‚ æ„å»ºå¯¹äºæ¯ä¸ªæ¨¡å—ï¼Œåœ¨æ„å»ºé˜¶æ®µä¼šåšä¸‰ä¸ªå¤„ç†ï¼š ç¡®å®šè¦ä»å“ªé‡Œä¸‹è½½åŒ…å«è¯¥æ¨¡å—çš„æ–‡ä»¶ï¼Œä¹Ÿç§°ä¸ºæ¨¡å—å®šä½ï¼ˆModule Resolutionï¼‰ æå–æ–‡ä»¶ï¼Œé€šè¿‡ä» URL ä¸‹è½½æˆ–è€…ä»æ–‡ä»¶ç³»ç»ŸåŠ è½½ è§£ææ–‡ä»¶ä¸ºæ¨¡å—è®°å½• 1.ä¸‹è½½æ¨¡å—åŠ è½½å™¨è´Ÿè´£å®šä½æ–‡ä»¶å¹¶ä¸”æå–ã€‚é¦–å…ˆï¼Œå®ƒéœ€è¦æ‰¾åˆ°å…¥å£æ–‡ä»¶ã€‚åœ¨ HTML ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ &lt;script&gt; æ ‡ç­¾æ¥å‘Šè¯‰åŠ è½½å™¨ã€‚ ä½†æ˜¯ï¼ŒåŠ è½½å™¨è¦å¦‚ä½•å®šä½ main.js ç›´æ¥ä¾èµ–çš„æ¨¡å—å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å¯¼å…¥è¯­å¥å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å¯¼å…¥è¯­å¥ä¸­æœ‰ä¸€éƒ¨åˆ†ç§°ä¸ºæ¨¡å—å®šä½ç¬¦ï¼ˆModule Specifierï¼‰ï¼Œå®ƒä¼šå‘Šè¯‰åŠ è½½å™¨å»å“ªå®šä½æ¨¡å—ã€‚ å¯¹äºæ¨¡å—å®šä½ç¬¦ï¼Œæœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼šå®ƒä»¬åœ¨æµè§ˆå™¨å’Œ Node ä¸­ä¼šæœ‰ä¸åŒçš„å¤„ç†ã€‚æ¯ä¸ªå¹³å°éƒ½æœ‰è‡ªå·±çš„ä¸€å¥—æ–¹å¼æ¥è§£ææ¨¡å—å®šä½ç¬¦ã€‚è¿™äº›æ–¹å¼ç§°ä¸ºæ¨¡å—å®šä½ç®—æ³•ï¼Œä¸åŒçš„å¹³å°ä¼šä½¿ç”¨ä¸åŒçš„æ¨¡å—å®šä½ç®—æ³•ã€‚å½“å‰ï¼Œä¸€äº›åœ¨ Node ä¸­èƒ½å·¥ä½œæ¨¡å—å®šä½ç¬¦å¹¶ä¸èƒ½åœ¨æµè§ˆå™¨ä¸­å·¥ä½œï¼Œä½†æ˜¯å·²ç»æœ‰ä¸€é¡¹å·¥ä½œæ­£åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ åœ¨è¿™ä¸ªé—®é¢˜è¢«è§£å†³ä¹‹å‰ï¼Œæµè§ˆå™¨åªæ¥å— URL ä½œä¸ºæ¨¡å—å®šä½ç¬¦ã€‚å®ƒä»¬ä¼šä» URL åŠ è½½æ¨¡å—æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ˜¯åœ¨æ•´ä¸ªå…³ç³»å›¾ä¸ŠåŒæ—¶å‘ç”Ÿçš„ã€‚å› ä¸ºåœ¨è§£æå®Œè¿™ä¸ªæ¨¡å—ä¹‹å‰ï¼Œä½ æ ¹æœ¬ä¸çŸ¥é“å®ƒä¾èµ–å“ªäº›æ¨¡å—ã€‚è€Œä¸”åœ¨å®ƒä¸‹è½½å®Œæˆä¹‹å‰ï¼Œä½ ä¹Ÿæ— æ³•è§£æå®ƒã€‚ è¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬å¿…é¡»ä¸€å±‚å±‚éå†ä¾èµ–æ ‘ï¼Œå…ˆè§£ææ–‡ä»¶ï¼Œç„¶åæ‰¾å‡ºä¾èµ–ï¼Œæœ€ååˆå®šä½å¹¶åŠ è½½è¿™äº›ä¾èµ–ï¼Œå¦‚æ­¤å¾€å¤ã€‚ å¦‚æœä¸»çº¿ç¨‹æ­£åœ¨ç­‰å¾…è¿™äº›æ¨¡å—æ–‡ä»¶ä¸‹è½½å®Œæˆï¼Œè®¸å¤šå…¶ä»–ä»»åŠ¡å°†ä¼šå †ç§¯åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œé€ æˆé˜»å¡ã€‚è¿™æ˜¯å› ä¸ºåœ¨æµè§ˆå™¨ä¸­ï¼Œä¸‹è½½ä¼šè€—è´¹å¤§é‡çš„æ—¶é—´ã€‚ è€Œé˜»å¡ä¸»çº¿ç¨‹ä¼šä½¿å¾—åº”ç”¨å˜å¾—å¡é¡¿ï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚è¿™æ˜¯ ESM æ ‡å‡†æŠŠç®—æ³•åˆ†æˆå¤šä¸ªé˜¶æ®µçš„åŸå› ä¹‹ä¸€ã€‚å°†æ„å»ºåˆ’åˆ†ä¸ºä¸€ä¸ªç‹¬ç«‹é˜¶æ®µåï¼Œæµè§ˆå™¨å¯ä»¥åœ¨è¿›å…¥åŒæ­¥çš„å®ä¾‹åŒ–è¿‡ç¨‹ä¹‹å‰ä¸‹è½½æ–‡ä»¶ç„¶åç†è§£æ¨¡å—å…³ç³»å›¾ã€‚ ESM å’Œ CJS ä¹‹é—´æœ€ä¸»è¦çš„åŒºåˆ«ä¹‹ä¸€å°±æ˜¯ï¼ŒESM æŠŠç®—æ³•åŒ–ä¸ºä¸ºå¤šä¸ªé˜¶æ®µã€‚ CJS ä½¿ç”¨ä¸åŒçš„ç®—æ³•æ˜¯å› ä¸ºå®ƒä»æ–‡ä»¶ç³»ç»ŸåŠ è½½æ–‡ä»¶ï¼Œè¿™è€—è´¹çš„æ—¶é—´è¿œè¿œå°äºä»ç½‘ç»œä¸Šä¸‹è½½ã€‚å› æ­¤ Node åœ¨åŠ è½½æ–‡ä»¶çš„æ—¶å€™å¯ä»¥é˜»å¡ä¸»çº¿ç¨‹ï¼Œè€Œä¸é€ æˆå¤ªå¤§å½±å“ã€‚è€Œä¸”æ—¢ç„¶æ–‡ä»¶å·²ç»åŠ è½½å®Œæˆäº†ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥ç›´æ¥è¿›è¡Œå®ä¾‹åŒ–å’Œè¿è¡Œã€‚æ‰€ä»¥åœ¨ CJS ä¸­å®ä¾‹åŒ–å’Œè¿è¡Œå¹¶ä¸æ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„é˜¶æ®µã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œä½ å¯ä»¥åœ¨è¿”å›æ¨¡å—å®ä¾‹ä¹‹å‰ï¼Œé¡ºç€æ•´é¢—ä¾èµ–æ ‘å»é€ä¸€åŠ è½½ã€å®ä¾‹åŒ–å’Œè¿è¡Œæ¯ä¸€ä¸ªä¾èµ–ã€‚ CJS çš„æ–¹å¼å¯¹ ESM ä¹Ÿæœ‰ä¸€äº›å¯å‘ï¼Œè¿™ä¸ªåé¢ä¼šè§£é‡Šã€‚å…¶ä¸­ä¸€ä¸ªå°±æ˜¯ï¼Œåœ¨ Node çš„ CJS ä¸­ï¼Œä½ å¯ä»¥åœ¨æ¨¡å—å®šä½ç¬¦ä¸­ä½¿ç”¨å˜é‡ã€‚å› ä¸ºå·²ç»æ‰§è¡Œäº† require ä¹‹å‰çš„ä»£ç ï¼Œæ‰€ä»¥æ¨¡å—å®šä½ç¬¦ä¸­çš„å˜é‡æ­¤åˆ»æ˜¯æœ‰å€¼çš„ï¼Œè¿™æ ·å°±å¯ä»¥è¿›è¡Œæ¨¡å—å®šä½çš„å¤„ç†äº†ã€‚ ä½†æ˜¯å¯¹äº ESMï¼Œåœ¨è¿è¡Œä»»ä½•ä»£ç ä¹‹å‰ï¼Œä½ é¦–å…ˆéœ€è¦å»ºç«‹æ•´ä¸ªæ¨¡å—ä¾èµ–çš„å…³ç³»å›¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå»ºç«‹å…³ç³»å›¾æ—¶å˜é‡æ˜¯è¿˜æ²¡æœ‰å€¼çš„ï¼Œå› ä¸ºä»£ç éƒ½è¿˜æ²¡è¿è¡Œã€‚ ä¸è¿‡å‘¢ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ç¡®å®éœ€è¦åœ¨æ¨¡å—å®šä½ç¬¦ä¸­ä½¿ç”¨å˜é‡ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®å½“å‰çš„çŠ¶å†µåŠ è½½ä¸åŒçš„ä¾èµ–ã€‚ ä¸ºäº†åœ¨ ESM ä¸­å®ç°è¿™ç§æ–¹å¼ï¼Œäººä»¬å·²ç»æå‡ºäº†ä¸€ä¸ªåŠ¨æ€å¯¼å…¥ææ¡ˆã€‚è¯¥ææ¡ˆå…è®¸ä½ å¯ä»¥ä½¿ç”¨ç±»ä¼¼ import(\\${path}/foo.js)çš„å¯¼å…¥è¯­å¥ã€‚ è¿™ç§æ–¹å¼å®é™…ä¸Šæ˜¯æŠŠä½¿ç”¨ import() åŠ è½½çš„æ–‡ä»¶å½“æˆäº†ä¸€ä¸ªå…¥å£æ–‡ä»¶ã€‚åŠ¨æ€å¯¼å…¥çš„æ¨¡å—ä¼šå¼€å¯ä¸€ä¸ªå…¨æ–°çš„ç‹¬ç«‹ä¾èµ–å…³ç³»æ ‘ã€‚ ä¸è¿‡æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤æ£µä¾èµ–å…³ç³»æ ‘å…±æœ‰çš„æ¨¡å—ä¼šå…±äº«åŒä¸€ä¸ªæ¨¡å—å®ä¾‹ã€‚è¿™æ˜¯å› ä¸ºåŠ è½½å™¨ä¼šç¼“å­˜æ¨¡å—å®ä¾‹ã€‚åœ¨ç‰¹å®šçš„å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œæ¯ä¸ªæ¨¡å—åªä¼šæœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„æ¨¡å—å®ä¾‹ã€‚ è¿™ç§æ–¹å¼æœ‰åŠ©äºæé«˜ JS å¼•æ“çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ¨¡å—æ–‡ä»¶åªä¼šè¢«ä¸‹è½½ä¸€æ¬¡ï¼Œå³ä½¿æœ‰å¤šä¸ªæ¨¡å—ä¾èµ–å®ƒã€‚è¿™ä¹Ÿæ˜¯ç¼“å­˜æ¨¡å—çš„åŸå› ä¹‹ä¸€ï¼Œåé¢è¯´åˆ°è¿è¡Œçš„æ—¶å€™ä¼šä»‹ç»å¦ä¸€ä¸ªåŸå› ã€‚ åŠ è½½å™¨ä½¿ç”¨æ¨¡å—æ˜ å°„ï¼ˆModule Mapï¼‰æ¥ç®¡ç†ç¼“å­˜ã€‚æ¯ä¸ªå…¨å±€ä½œç”¨åŸŸéƒ½åœ¨ä¸€ä¸ªå•ç‹¬çš„æ¨¡å—æ˜ å°„ä¸­è·Ÿè¸ªå…¶æ¨¡å—ã€‚ å½“åŠ è½½å™¨è¦ä»ä¸€ä¸ª URL åŠ è½½æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šæŠŠ URL è®°å½•åˆ°æ¨¡å—æ˜ å°„ä¸­ï¼Œå¹¶æŠŠå®ƒæ ‡è®°ä¸ºæ­£åœ¨ä¸‹è½½çš„æ–‡ä»¶ã€‚ç„¶åå®ƒä¼šå‘å‡ºè¿™ä¸ªæ–‡ä»¶è¯·æ±‚å¹¶ç»§ç»­å¼€å§‹è·å–ä¸‹ä¸€ä¸ªæ–‡ä»¶ã€‚ å½“å…¶ä»–æ¨¡å—ä¹Ÿä¾èµ–è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼ŸåŠ è½½å™¨ä¼šæŸ¥æ‰¾æ¨¡å—æ˜ å°„ä¸­çš„æ¯ä¸€ä¸ª URL ã€‚å¦‚æœå‘ç° URL çš„çŠ¶æ€ä¸ºæ­£åœ¨ä¸‹è½½ï¼Œåˆ™ä¼šè·³è¿‡è¯¥ URL ï¼Œç„¶åå¼€å§‹ä¸‹ä¸€ä¸ªä¾èµ–çš„å¤„ç†ã€‚ ä¸è¿‡ï¼Œæ¨¡å—æ˜ å°„çš„ä½œç”¨å¹¶ä¸ä»…ä»…æ˜¯è®°å½•å“ªäº›æ–‡ä»¶å·²ç»ä¸‹è½½ã€‚ä¸‹é¢æˆ‘ä»¬å°†ä¼šçœ‹åˆ°ï¼Œæ¨¡å—æ˜ å°„ä¹Ÿå¯ä»¥ä½œä¸ºæ¨¡å—çš„ç¼“å­˜ã€‚ 2.è§£ææ¨¡å—è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†æ¨¡å—æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒè§£æä¸ºæ¨¡å—è®°å½•ã€‚è¿™æœ‰åŠ©äºæµè§ˆå™¨ç†è§£æ¨¡å—çš„ä¸åŒéƒ¨åˆ†ã€‚ ä¸€æ—¦æ¨¡å—è®°å½•åˆ›å»ºå®Œæˆï¼Œå®ƒå°±ä¼šè¢«è®°å½•åœ¨æ¨¡å—æ˜ å°„ä¸­ã€‚æ‰€ä»¥ï¼Œåç»­ä»»ä½•æ—¶å€™å†æ¬¡è¯·æ±‚è¿™ä¸ªæ¨¡å—æ—¶ï¼ŒåŠ è½½å™¨å°±å¯ä»¥ç›´æ¥ä»æ¨¡å—æ˜ å°„ä¸­è·å–è¯¥æ¨¡å—ã€‚ è§£æè¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªçœ‹ä¼¼å¾®ä¸è¶³é“çš„ç»†èŠ‚ï¼Œä½†æ˜¯å®é™…é€ æˆçš„å½±å“å´å¾ˆå¤§ã€‚é‚£å°±æ˜¯æ‰€æœ‰çš„æ¨¡å—éƒ½æŒ‰ç…§ä¸¥æ ¼æ¨¡å¼æ¥è§£æçš„ã€‚ä¹Ÿè¿˜æœ‰å…¶ä»–çš„å°ç»†èŠ‚ï¼Œæ¯”å¦‚ï¼Œå…³é”®å­— await åœ¨æ¨¡å—çš„æœ€é¡¶å±‚æ˜¯ä¿ç•™å­—ï¼Œ this çš„å€¼ä¸º undefindedã€‚ è¿™ç§ä¸åŒçš„è§£ææ–¹å¼ç§°ä¸ºè§£æç›®æ ‡ï¼ˆParse Goalï¼‰ã€‚å¦‚æœæŒ‰ç…§ä¸åŒçš„è§£æç›®æ ‡æ¥è§£æç›¸åŒçš„æ–‡ä»¶ï¼Œä¼šå¾—åˆ°ä¸åŒçš„ç»“æœã€‚å› æ­¤ï¼Œåœ¨è§£ææ–‡ä»¶ä¹‹å‰ï¼Œå¿…é¡»æ¸…æ¥šåœ°çŸ¥é“æ‰€è§£æçš„æ–‡ä»¶ç±»å‹æ˜¯ä»€ä¹ˆï¼Œä¸ç®¡å®ƒæ˜¯ä¸æ˜¯ä¸€ä¸ªæ¨¡å—æ–‡ä»¶ã€‚ åœ¨æµè§ˆå™¨ä¸­ï¼ŒçŸ¥é“æ–‡ä»¶ç±»å‹æ˜¯å¾ˆç®€å•çš„ã€‚åªéœ€è¦åœ¨ &lt;script&gt; è„šæœ¬ä¸­æ·»åŠ  type=&quot;module&quot; å±æ€§å³å¯ã€‚è¿™å‘Šè¯‰æµè§ˆå™¨è¿™ä¸ªæ–‡ä»¶éœ€è¦è¢«è§£æä¸ºä¸€ä¸ªæ¨¡å—ã€‚è€Œä¸”ï¼Œå› ä¸ºåªæœ‰æ¨¡å—æ‰èƒ½è¢«å¯¼å…¥ï¼Œæ‰€ä»¥æµè§ˆå™¨ä»¥æ­¤æ¨æµ‹æ‰€æœ‰çš„å¯¼å…¥ä¹Ÿéƒ½æ˜¯æ¨¡å—æ–‡ä»¶ã€‚ ä¸è¿‡åœ¨ Node ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸ä½¿ç”¨ HTML æ ‡ç­¾ï¼Œæ‰€ä»¥ä¹Ÿæ²¡åŠæ³•é€šè¿‡ type å±æ€§æ¥è¾¨åˆ«ã€‚ç¤¾åŒºæå‡ºä¸€ç§è§£å†³åŠæ³•æ˜¯ä½¿ç”¨ .mjs æ‹“å±•åã€‚ä½¿ç”¨è¯¥æ‹“å±•åä¼šå‘Šè¯‰ Node è¯´â€œè¿™æ˜¯ä¸ªæ¨¡å—æ–‡ä»¶â€ã€‚ä½ ä¼šçœ‹åˆ°å¤§å®¶æ­£åœ¨è®¨è®ºæŠŠè¿™ä¸ªä½œä¸ºè§£æç›®æ ‡ã€‚ä¸è¿‡è®¨è®ºä»åœ¨ç»§ç»­ï¼Œæ‰€ä»¥ç›®å‰ä»ä¸æ˜ç¡® Node ç¤¾åŒºæœ€ç»ˆä¼šé‡‡ç”¨å“ªç§æ–¹å¼ã€‚ æ— è®ºæœ€ç»ˆä½¿ç”¨å“ªç§æ–¹å¼ï¼ŒåŠ è½½å™¨éƒ½ä¼šå†³å®šæ˜¯å¦æŠŠä¸€ä¸ªæ–‡ä»¶ä½œä¸ºæ¨¡å—æ¥è§£æã€‚å¦‚æœæ˜¯æ¨¡å—ï¼Œè€Œä¸”åŒ…å«å¯¼å…¥è¯­å¥ï¼Œé‚£å®ƒä¼šé‡æ–°å¼€å§‹å¤„ç†ç›´è‡³æ‰€æœ‰çš„æ–‡ä»¶éƒ½å·²æå–å’Œè§£æã€‚ åˆ°è¿™é‡Œï¼Œæ„å»ºé˜¶æ®µå·®ä¸å¤šå°±å®Œæˆäº†ã€‚åœ¨åŠ è½½è¿‡ç¨‹å¤„ç†å®Œæˆåï¼Œä½ å·²ç»ä»æœ€å¼€å§‹åªæœ‰ä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œåˆ°ç°åœ¨å¾—åˆ°äº†ä¸€å †æ¨¡å—è®°å½•ã€‚ ä¸‹ä¸€æ­¥ä¼šå®ä¾‹åŒ–è¿™äº›æ¨¡å—å¹¶ä¸”æŠŠæ‰€æœ‰çš„å®ä¾‹é“¾æ¥èµ·æ¥ã€‚ å®ä¾‹åŒ–æ­£å¦‚å‰æ–‡æ‰€è¿°ï¼Œä¸€ä¸ªæ¨¡å—å®ä¾‹ç»“åˆäº†ä»£ç å’ŒçŠ¶æ€ã€‚çŠ¶æ€å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥å®ä¾‹åŒ–çš„è¿‡ç¨‹å°±æ˜¯æŠŠæ‰€æœ‰å€¼å†™å…¥å†…å­˜çš„è¿‡ç¨‹ã€‚ é¦–å…ˆï¼ŒJS å¼•æ“ä¼šåˆ›å»ºä¸€ä¸ªæ¨¡å—ç¯å¢ƒè®°å½•ï¼ˆModule Environment Recordï¼‰ã€‚å®ƒç®¡ç†ç€æ¨¡å—è®°å½•çš„æ‰€æœ‰å˜é‡ã€‚ç„¶åï¼Œå¼•æ“ä¼šæ‰¾å‡ºå¤šæœ‰å¯¼å‡ºåœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚æ¨¡å—ç¯å¢ƒè®°å½•ä¼šè·Ÿè¸ªæ¯ä¸ªå¯¼å‡ºå¯¹åº”äºå“ªä¸ªå†…å­˜åœ°å€ã€‚ è¿™äº›å†…å­˜åœ°å€æ­¤æ—¶è¿˜æ²¡æœ‰å€¼ï¼Œåªæœ‰ç­‰åˆ°è¿è¡Œåå®ƒä»¬æ‰ä¼šè¢«å¡«å……ä¸Šå®é™…å€¼ã€‚æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œæ‰€æœ‰å¯¼å‡ºçš„å‡½æ•°å£°æ˜éƒ½åœ¨è¿™ä¸ªé˜¶æ®µåˆå§‹åŒ–ï¼Œè¿™ä¼šä½¿å¾—åé¢çš„è¿è¡Œé˜¶æ®µå˜å¾—æ›´åŠ ç®€å•ã€‚ ä¸ºäº†å®ä¾‹åŒ–æ¨¡å—å…³ç³»å›¾ï¼Œå¼•æ“ä¼šé‡‡ç”¨æ·±åº¦ä¼˜å…ˆçš„ååºéå†æ–¹å¼ã€‚å³ï¼Œå®ƒä¼šé¡ºç€å…³ç³»å›¾åˆ°è¾¾æœ€åº•ç«¯æ²¡æœ‰ä»»ä½•ä¾èµ–çš„æ¨¡å—ï¼Œç„¶åè®¾ç½®å®ƒä»¬çš„å¯¼å‡ºã€‚ æœ€ç»ˆï¼Œå¼•æ“ä¼šæŠŠæ¨¡å—ä¸‹çš„æ‰€æœ‰ä¾èµ–å¯¼å‡ºé“¾æ¥åˆ°å½“å‰æ¨¡å—ã€‚ç„¶åå›åˆ°ä¸Šä¸€å±‚æŠŠæ¨¡å—çš„å¯¼å…¥é“¾æ¥èµ·æ¥ã€‚ è¿™ä¸ªè¿‡ç¨‹è·Ÿ CJS æ˜¯ä¸åŒçš„ã€‚åœ¨ CJS ä¸­ï¼Œæ•´ä¸ªå¯¼å‡ºå¯¹è±¡åœ¨å¯¼å‡ºæ—¶éƒ½æ˜¯å€¼æ‹·è´ã€‚å³ï¼Œæ‰€æœ‰çš„å¯¼å‡ºå€¼éƒ½æ˜¯æ‹·è´å€¼ï¼Œè€Œä¸æ˜¯å¼•ç”¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœå¯¼å‡ºæ¨¡å—å†…å¯¼å‡ºçš„å€¼æ”¹å˜äº†ï¼Œå¯¼å…¥æ¨¡å—ä¸­å¯¼å…¥çš„å€¼ä¹Ÿä¸ä¼šæ”¹å˜ã€‚ ç›¸åï¼ŒESM åˆ™ä½¿ç”¨ç§°ä¸ºå®æ—¶ç»‘å®šï¼ˆLive Bindingï¼‰çš„æ–¹å¼ã€‚å¯¼å‡ºå’Œå¯¼å…¥çš„æ¨¡å—éƒ½æŒ‡å‘ç›¸åŒçš„å†…å­˜åœ°å€ï¼ˆå³å€¼å¼•ç”¨ï¼‰ã€‚æ‰€ä»¥ï¼Œå½“å¯¼å‡ºæ¨¡å—å†…å¯¼å‡ºçš„å€¼æ”¹å˜åï¼Œå¯¼å…¥æ¨¡å—ä¸­çš„å€¼ä¹Ÿå®æ—¶æ”¹å˜äº†ã€‚ æ¨¡å—å¯¼å‡ºçš„å€¼åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥èƒ½å‘ç”Ÿæ”¹å˜ï¼Œä½†æ˜¯å¯¼å…¥æ¨¡å—å´ä¸èƒ½æ”¹å˜å®ƒæ‰€å¯¼å…¥çš„å€¼ï¼Œå› ä¸ºå®ƒæ˜¯åªè¯»çš„ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—å¯¼å…¥äº†ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå®ƒåªèƒ½æ”¹å˜è¯¥å¯¹è±¡çš„å±æ€§ï¼Œè€Œä¸èƒ½æ”¹å˜å¯¹è±¡æœ¬èº«ã€‚ ESM é‡‡ç”¨è¿™ç§å®æ—¶ç»‘å®šçš„åŸå› æ˜¯ï¼Œå¼•æ“å¯ä»¥åœ¨ä¸è¿è¡Œä»»ä½•æ¨¡å—ä»£ç çš„æƒ…å†µä¸‹å®Œæˆé“¾æ¥ã€‚åé¢ä¼šè§£é‡Šåˆ°ï¼Œè¿™å¯¹è§£å†³è¿è¡Œé˜¶æ®µçš„å¾ªç¯ä¾èµ–é—®é¢˜ä¹Ÿæ˜¯æœ‰å¸®åŠ©çš„ã€‚ å®ä¾‹åŒ–é˜¶æ®µå®Œæˆåï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ‰€æœ‰æ¨¡å—å®ä¾‹ï¼Œä»¥åŠå·²å®Œæˆé“¾æ¥çš„å¯¼å…¥ã€å¯¼å‡ºå€¼ã€‚ ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹è¿è¡Œä»£ç å¹¶ä¸”å¾€å†…å­˜ç©ºé—´å†…å¡«å……å€¼äº†ã€‚ è¿è¡Œæœ€åä¸€æ­¥æ˜¯å¾€å·²ç”³è¯·å¥½çš„å†…å­˜ç©ºé—´ä¸­å¡«å…¥çœŸå®å€¼ã€‚JS å¼•æ“é€šè¿‡è¿è¡Œé¡¶å±‚ä»£ç ï¼ˆå‡½æ•°å¤–çš„ä»£ç ï¼‰æ¥å®Œæˆå¡«å……ã€‚ é™¤äº†å¡«å……å€¼ä»¥å¤–ï¼Œè¿è¡Œä»£ç ä¹Ÿä¼šå¼•å‘ä¸€äº›å‰¯ä½œç”¨ï¼ˆSide Effectï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ¨¡å—å¯èƒ½ä¼šå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚ å› ä¸ºè¿™äº›æ½œåœ¨å‰¯ä½œç”¨çš„å­˜åœ¨ï¼Œæ‰€ä»¥æ¨¡å—ä»£ç åªèƒ½è¿è¡Œä¸€æ¬¡ã€‚å‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œå®ä¾‹åŒ–é˜¶æ®µä¸­å‘ç”Ÿçš„é“¾æ¥å¯ä»¥å¤šæ¬¡è¿›è¡Œï¼Œå¹¶ä¸”æ¯æ¬¡çš„ç»“æœéƒ½ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¿è¡Œé˜¶æ®µè¿›è¡Œå¤šæ¬¡çš„è¯ï¼Œåˆ™å¯èƒ½ä¼šæ¯æ¬¡éƒ½å¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚ è¿™æ­£æ˜¯ä¸ºä»€ä¹ˆä¼šä½¿ç”¨æ¨¡å—æ˜ å°„çš„åŸå› ä¹‹ä¸€ã€‚æ¨¡å—æ˜ å°„ä¼šä»¥ URL ä¸ºç´¢å¼•æ¥ç¼“å­˜æ¨¡å—ï¼Œä»¥ç¡®ä¿æ¯ä¸ªæ¨¡å—åªæœ‰ä¸€ä¸ªæ¨¡å—è®°å½•ã€‚è¿™ä¿è¯äº†æ¯ä¸ªæ¨¡å—åªä¼šè¿è¡Œä¸€æ¬¡ã€‚è·Ÿå®ä¾‹åŒ–ä¸€æ ·ï¼Œè¿è¡Œé˜¶æ®µä¹Ÿé‡‡ç”¨æ·±åº¦ä¼˜å…ˆçš„ååºéå†æ–¹å¼ã€‚ é‚£å¯¹äºå‰é¢è°ˆåˆ°çš„å¾ªç¯ä¾èµ–ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ å¾ªç¯ä¾èµ–ä¼šä½¿å¾—ä¾èµ–å…³ç³»å›¾ä¸­å‡ºç°ä¸€ä¸ªä¾èµ–ç¯ï¼Œå³ä½ ä¾èµ–æˆ‘ï¼Œæˆ‘ä¹Ÿä¾èµ–ä½ ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™ä¸ªç¯ä¼šéå¸¸å¤§ã€‚ä¸è¿‡ï¼Œä¸ºäº†è§£é‡Šå¥½è¿™ä¸ªé—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸¾ä¾‹ä¸€ä¸ªç®€å•çš„å¾ªç¯ä¾èµ–ã€‚ counter æ¨¡å—ä¼šè¯•å›¾å»è®¿é—®å¯¼å‡ºå¯¹è±¡çš„ message ã€‚ä¸è¿‡ï¼Œç”±äº main æ¨¡å—ä¸­è¿˜æ²¡è¿è¡Œåˆ° message å¤„ï¼Œæ‰€ä»¥æ­¤æ—¶å¾—åˆ°çš„ message ä¸º undefinedã€‚JS å¼•æ“ä¼šä¸ºæœ¬åœ°å˜é‡åˆ†é…ç©ºé—´å¹¶æŠŠå€¼è®¾ä¸º undefined ã€‚ è¿è¡Œé˜¶æ®µç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ° counter æ¨¡å—é¡¶å±‚ä»£ç çš„æœ«å°¾å¤„ã€‚æˆ‘ä»¬æƒ³çŸ¥é“ï¼Œå½“ counter æ¨¡å—è¿è¡Œç»“æŸåï¼Œmessage æ˜¯å¦ä¼šå¾—åˆ°çœŸå®å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªè¶…æ—¶å®šæ—¶å™¨ã€‚ä¹‹åè¿è¡Œé˜¶æ®µä¾¿è¿”å›åˆ° main.js ä¸­ã€‚ è¿™æ—¶ï¼Œmessage å°†ä¼šè¢«åˆå§‹åŒ–å¹¶æ·»åŠ åˆ°å†…å­˜ä¸­ã€‚ä½†æ˜¯è¿™ä¸ª message ä¸ counter æ¨¡å—ä¸­çš„ message ä¹‹é—´å¹¶æ²¡æœ‰ä»»ä½•å…³è”å…³ç³»ï¼Œæ‰€ä»¥ counter æ¨¡å—ä¸­çš„ message ä»ç„¶ä¸º undefinedã€‚ å¦‚æœå¯¼å‡ºå€¼é‡‡ç”¨çš„æ˜¯å®æ—¶ç»‘å®šæ–¹å¼ï¼Œé‚£ä¹ˆ counter æ¨¡å—æœ€ç»ˆä¼šå¾—åˆ°çœŸå®çš„ message å€¼ã€‚å½“è¶…æ—¶å®šæ—¶å™¨å¼€å§‹è®¡æ—¶æ—¶ï¼Œmain.js çš„è¿è¡Œå°±å·²ç»å®Œæˆå¹¶è®¾ç½®äº† message å€¼ã€‚ æ”¯æŒå¾ªç¯ä¾èµ–æ˜¯ ESM è®¾è®¡ä¹‹åˆå°±è€ƒè™‘åˆ°çš„ä¸€å¤§åŸå› ã€‚ä¹Ÿæ­£æ˜¯è¿™ç§åˆ†æ®µè®¾è®¡ä½¿å…¶æˆä¸ºå¯èƒ½ã€‚ ESM çš„å½“å‰çŠ¶æ€ç­‰åˆ° 2018 å¹´ 5 æœˆ Firefox 60 å‘å¸ƒåï¼Œæ‰€æœ‰çš„ä¸»æµæµè§ˆå™¨å°±éƒ½é»˜è®¤æ”¯æŒ ESM äº†ã€‚Node ä¹Ÿæ­£åœ¨æ·»åŠ  ESM æ”¯æŒï¼Œä¸ºæ­¤è¿˜æˆç«‹äº†å·¥ä½œå°ç»„æ¥ä¸“é—¨ç ”ç©¶ CJS å’Œ ESM ä¹‹é—´çš„å…¼å®¹æ€§é—®é¢˜ã€‚ æ‰€ä»¥ï¼Œåœ¨æœªæ¥ä½ å¯ä»¥ç›´æ¥åœ¨ &lt;script&gt; æ ‡ç­¾ä¸­ä½¿ç”¨ type=&quot;module&quot;ï¼Œå¹¶ä¸”åœ¨ä»£ç ä¸­ä½¿ç”¨ import å’Œ export ã€‚åŒæ—¶ï¼Œæ›´å¤šçš„æ¨¡å—åŠŸèƒ½ä¹Ÿæ­£åœ¨ç ”ç©¶ä¸­ã€‚æ¯”å¦‚åŠ¨æ€å¯¼å…¥ææ¡ˆå·²ç»å¤„äº Stage 3 çŠ¶æ€ï¼›import.metaä¹Ÿè¢«æå‡ºä»¥ä¾¿ Node.js å¯¹ ESM çš„æ”¯æŒï¼›æ¨¡å—å®šä½ææ¡ˆ ä¹Ÿè‡´åŠ›äºè§£å†³æµè§ˆå™¨å’Œ Node.js ä¹‹é—´çš„å·®å¼‚ã€‚ ç›¸ä¿¡åœ¨ä¸ä¹…çš„æœªæ¥ï¼Œè·Ÿæ¨¡å—ä¸€èµ·ç©è€å°†ä¼šå˜æˆä¸€ä»¶æ›´åŠ æ„‰å¿«çš„äº‹ï¼","categories":[],"tags":[{"name":"ESmodule","slug":"ESmodule","permalink":"https://tsunamigg.github.io/tags/ESmodule/"}]},{"title":"Event loop","slug":"Event loop","date":"2019-05-19T11:25:19.000Z","updated":"2020-05-23T14:52:52.835Z","comments":true,"path":"2019/05/19/Event loop/","link":"","permalink":"https://tsunamigg.github.io/2019/05/19/Event%20loop/","excerpt":"Event loopçš„ç²—æµ…è®¤è¯†","text":"Event loopçš„ç²—æµ…è®¤è¯† äº‹ä»¶è½®è¯¢jsæ˜¯å•çº¿ç¨‹çš„ã€‚å…¶äº‹ä»¶è½®è¯¢ç”±ï¼šåŒæ­¥ä»»åŠ¡ï¼Œå¼‚æ­¥ä»»åŠ¡ï¼Œmacrotaskï¼ˆå®ä»»åŠ¡ï¼‰ï¼Œmicrotask ï¼ˆå¾®ä»»åŠ¡ï¼‰ç»„æˆã€‚å…¶æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š åŒæ­¥ä»»åŠ¡ï¼š ä¸»çº¿ç¨‹ä¸Šçš„ä»»åŠ¡ï¼Œå‰ä¸€ä¸ªå®Œæˆååä¸€ä¸ªæ‰§è¡Œã€‚ å¼‚æ­¥ä»»åŠ¡ï¼šä¸è¿›å…¥ä¸»çº¿ç¨‹ï¼Œè¿›å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼ˆtask queue)ä¸­æ‰§è¡Œï¼Œç­‰äºmacrotaskã€‚ macrotaskï¼šä»»åŠ¡é˜Ÿåˆ—çš„ä¸»ä½“ï¼ŒåŒä¸€ä¸ªé˜Ÿåˆ—å†…çš„â€œå…ˆè¿›å…ˆå‡ºâ€æ‰§è¡Œã€‚ä¸åŒçš„é˜Ÿåˆ—ä¹‹é—´â€œå…ˆè¿›åå‡ºâ€æ‰§è¡Œã€‚ microtask ï¼šæ€»åœ¨ä»»åŠ¡é˜Ÿåˆ—æœ«å°¾æ‰§è¡Œï¼Œæœ‰æ–°çš„microtask ç»§ç»­åŠ åœ¨æœ«å°¾æ‰§è¡Œã€‚ æ‰§è¡Œè¿‡ç¨‹ï¼š1.åŒæ­¥ä»»åŠ¡æ‰§è¡Œ 2. ä»»åŠ¡æŒ‰é˜Ÿåˆ—ä¾æ¬¡æ‰§è¡Œ 3.å¾®ä»»åŠ¡æŒ‰é˜Ÿåˆ—ä¾æ¬¡æ‰§è¡Œ 4.é‡å¤1-3 å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡å¯¹äºå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡çš„æ¦‚å¿µçš„ç†è§£ï¼Œä¸€å¼€å§‹ç¡®å®æ˜¯ä¸å¤ªæ¸…æ¥šçš„ã€‚ å…ˆæ¥è¯´è¯´å®ä»»åŠ¡ï¼Œæˆ‘ä»¬ä¸å¦¨è¿™æ ·æ¥çœ‹ï¼Œæ—¢ç„¶å®ƒæ˜¯ä»»åŠ¡é˜Ÿåˆ—çš„ä¸»ä½“ï¼Œé‚£ä¹ˆå®ƒä¸€å®šç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªä»»åŠ¡æ„æˆã€‚æŠ›å¼€JS,[å®]è¿™ä¸ªå­—æœ¬èº«å°±ä¸æ˜¯å•ä¸€çš„ï¼Œåœ¨CSä¸­çš„[å®]å°±æ˜¯æ‰¹é‡å¤„ç†çš„æ„æ€ã€‚ å¯¹äºç¨å¾®äº†è§£è¿‡ä¸€ç‚¹ç‚¹cçš„äººæ¥è¯´ï¼Œåº”è¯¥éƒ½ä¸é™Œç”Ÿï¼Œè¾Ÿå¦‚ï¼šç¼–è¯‘é¢„å¤„ç†å‘½ä»¤ï¼Œå®å®šä¹‰ç­‰ç­‰ã€‚ 1234// ç¼–è¯‘é¢„å¤„ç†å‘½ä»¤#include&lt;stdio.h&gt;// å®å®šä¹‰#define PI 3.14 æˆ‘å°†[ç¼–è¯‘é¢„å¤„ç†å‘½ä»¤]ï¼ˆåœ¨ç¼–è¯‘ä¹‹å‰è¿›è¡Œçš„å¤„ç†ï¼‰å°±çœ‹åšæ˜¯[å®ä»»åŠ¡]ï¼Œå°±æ˜¯ä½ å†™äº†ä¸€ç³»åˆ—çš„å‰ç½®æ“ä½œï¼Œåœ¨åé¢çš„ä»£ç æ‰§è¡Œä¹‹å‰ï¼Œè¿™äº›å®ä»»åŠ¡å…¨éƒ¨éœ€è¦æ‰§è¡Œå®Œæ¯•~ ç¨å¾®ç”Ÿæ´»åŒ–ä¸€ç‚¹ç‚¹ï¼Œæ¯”å¦‚é‚£ä¸ªä¸­å›½äº’è”ç½‘èµ·æ­¥çš„æ—¶å€™ï¼Œæˆ‘çš„åŒå­¦ä¹‹é—´ï¼Œå–œæ¬¢ç”¨QQç­‰çº§ä½œä¸ºè°ˆèµ„ã€‚æ‰€ä»¥æˆ‘è®©æˆ‘çš„ç”µè„‘å¼€æœºåè‡ªåŠ¨ç™»å½•QQï¼›æˆ–è€…ç°ä»Š5Gæ¥ä¸´ä¹‹å‰ï¼Œç”·ç”Ÿå¤šåŠç©è¿‡çš„MOBAç±»æ¸¸æˆï¼Œå°±æ‹¿LOLä¸­çš„çå­æ‘¸çœ¼Ré—ªè¿™ç§æ“ä½œï¼Œä½ å®Œå…¨å¯ä»¥é€‰ä¸€ä¸ªæ‹¥æœ‰å®å‘½ä»¤çš„é¼ æ ‡ï¼Œè®¾ç½®æµ‹è¯•åä¸€é”®å®Œæˆè¿™ç§â€œç”¨åŒæ‰‹æˆå°±ä½ çš„æ¢¦æƒ³â€ç­‰ç§€çš„é£èµ·çš„æ“ä½œï¼›è¿˜æœ‰è¯¸å¦‚ä¹”ç¢§èä¹‹ç±»çš„äººå£«ï¼Œå¼€å¯ç›´æ’­æ¨æµä¹‹å‰ï¼Œå¯¹è‡ªå·±ç›´æ’­æ•ˆæœçš„ä¼˜åŒ–ã€‚è¿™äº›éƒ½æ˜¯æ‰€è°“å®ä»»åŠ¡ã€‚ è‡³äºå¾®ä»»åŠ¡ï¼Œç›¸ä¿¡èªæ˜å¯çˆ±çš„ä½ ä¸€å®šèƒ½å¤Ÿä¸¾ä¸€åä¸€ï¼Œæ‰¾åˆ°è‡ªå·±å¯¹å…¶å……åˆ†çš„ç†è§£~:smile: å¸¸è§çš„å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ï¼š å®ä»»åŠ¡ï¼š setTimeout setInterval setImmediate requestAnimationFrame I/O UI rendering å¾®ä»»åŠ¡ï¼š process.nextTick Promises Object.observe MutationObserver æ‰§è¡Œå›¾ä¾‹ å¸Œæœ›æ‰§è¡Œå¸§åŠ¨ç”»èƒ½è®©ä½ å¯¹æ•´ä¸ªè¿‡ç¨‹çš„ç†è§£æ¸…æ™°è®¸å¤š å°ç»ƒä¹ 11234567891011121314151617181920console.log('script start');setTimeout(function() &#123; console.log('setTimeout');&#125;, 0);Promise.resolve().then(function() &#123; console.log('promise1');&#125;).then(function() &#123; console.log('promise2');&#125;);console.log('script end');// æµè§ˆå™¨è¾“å‡ºé¡ºåºï¼š//script start//script end//promise1//promise2//setTimeout å°ç»ƒä¹ 21234567891011121314151617181920212223242526272829async function async1()&#123; console.log('async1 start') await async2() console.log('async1 end')&#125;async function async2()&#123; console.log('async2')&#125;console.log('script start')setTimeout(function()&#123; console.log('setTimeout') &#125;,0) async1();new Promise(function(resolve)&#123; console.log('promise1') resolve();&#125;).then(function()&#123; console.log('promise2')&#125;)console.log('script end')// æµè§ˆå™¨è¾“å‡ºé¡ºåºï¼š// script start//async1 start//async2//promise1//script end//async1 end//promise2//setTimeout awaitä¼šå°†ä¹‹åçš„ä»£ç æŠ›å…¥ä¸‹ä¸€ä¸ªæ‰§è¡Œé˜Ÿåˆ—ï¼Œä»£ç ä¸Šçš„è¡¨ç°å°±æ˜¯æ‰§è¡Œå®Œawaitçš„ä¼šè·³å‡ºå‡½æ•°ä½“æ‰§è¡Œå…¶ä»–çš„åŒæ­¥ä»»åŠ¡ã€‚ setTimeoutçš„å›è°ƒå‡½æ•°ä¼šè¿›å…¥ä¸‹ä¸€ä¸ªåŒæ­¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚ å¦‚æœè¾“å‡ºé¡ºåºä¸ä¸€è‡´ï¼Œæ˜¯å› ä¸ºå„å¤§æµè§ˆå™¨å¯¹å¼‚æ­¥çš„å¤„ç†æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ²¡ä»€ä¹ˆå¥‡æ€ªçš„ã€‚ å¦å¤–ï¼Œnodeç¯å¢ƒè¾“å‡ºé¡ºåºä¹Ÿæœ‰å¾ˆå¤§å·®å¼‚ã€‚","categories":[],"tags":[{"name":"javascript event loop","slug":"javascript-event-loop","permalink":"https://tsunamigg.github.io/tags/javascript-event-loop/"}]},{"title":"css tips","slug":"CSS-tips","date":"2019-04-11T05:14:16.000Z","updated":"2020-05-28T14:21:55.087Z","comments":true,"path":"2019/04/11/CSS-tips/","link":"","permalink":"https://tsunamigg.github.io/2019/04/11/CSS-tips/","excerpt":"å¦‚ä½•è¿›è¡Œå‘½åæ˜¯ä¸€ä»¶çœ‹ä¸Šå»å¾®ä¸è¶³é“ä½†å…¶å®å¯¹ä»£ç æ•´æ´åº¦ç ´åå¾ˆå¤§çš„äº‹æƒ…ï¼Œã€Šä»£ç æ•´æ´ä¹‹é“ã€‹å»ºè®®çš„ç¬¬ä¸€ç¯‡å°±æ˜¯å¦‚ä½•è¿›è¡Œå¥½çš„å‘½å","text":"å¦‚ä½•è¿›è¡Œå‘½åæ˜¯ä¸€ä»¶çœ‹ä¸Šå»å¾®ä¸è¶³é“ä½†å…¶å®å¯¹ä»£ç æ•´æ´åº¦ç ´åå¾ˆå¤§çš„äº‹æƒ…ï¼Œã€Šä»£ç æ•´æ´ä¹‹é“ã€‹å»ºè®®çš„ç¬¬ä¸€ç¯‡å°±æ˜¯å¦‚ä½•è¿›è¡Œå¥½çš„å‘½å cssæ‚é¡¹(å‘½åï¼Œä¹¦å†™é¡ºåºï¼Œè°ƒè¯•) BEMBEMæ˜¯æ¨¡å—ï¼ˆBlockï¼‰ã€å…ƒç´ ï¼ˆElementï¼‰ã€ä¿®é¥°ç¬¦ï¼ˆModifierï¼‰çš„ç®€å†™ã€‚ BEM æ˜¯ä¸€ç§ç»„ä»¶æ¶æ„çš„å‘½åæ–¹æ³•ï¼Œå®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯å°†Htmlå…ƒç´ åˆ’åˆ†æˆç‹¬ç«‹çš„ç»„ä»¶ï¼Œç„¶åç”¨ç®€å•çš„è§„åˆ™é“¾æ¥èµ·æ¥ï¼Œå¼€å‘æ—¶ä¸ç”¨æ‹…å¿ƒä¸ä¼šå–åå­—äº†ï¼ŒåŒæ—¶åæœŸç»´æŠ¤å’Œå¤šäººåä½œä¸Šå¥½å¤„å¤§å¤§çš„ã€‚ å…¶å‘½åè§„åˆ™å¦‚ä¸‹ï¼š 123Block - æ¨¡å—ï¼Œåå­—çš„å•è¯ä¹‹é—´ç”¨ &#96;-&#96; ç¬¦å·è¿æ¥Element - å…ƒç´ ï¼Œæ¨¡å—ä¸­çš„å­å…ƒç´ ï¼Œç”¨ &#96;__&#96; ç¬¦å·è¿æ¥Modifier - ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤ºçˆ¶å…ƒç´ æˆ–å­å…ƒç´ çš„å…¶ä»–å½¢æ€ï¼Œç”¨ &#96;--&#96; ç¬¦å·è¿æ¥ ä¼˜åŠ¿ åœ¨æ²¡ç”¨ BEM ä¹‹å‰ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè¿™æ ·ç»„ç»‡ CSS ç±»åï¼š 12345678&lt;!-- Commonå‘½åçš„ Search Bar æ¨¡å— --&gt; &lt;div class=\"search-bar\"&gt; &lt;input class=\"input\"&gt; &lt;!-- / input è¾“å…¥æ¡† --&gt; &lt;button class=\"btn\"&gt; &lt;!-- / button æœç´¢æŒ‰é’® --&gt; &lt;/div&gt; &lt;!-- E Search Bar æ¨¡å— --&gt; ç”¨ BEM å‘½åé‡å†™ä¹‹åï¼š 12345678&lt;!-- BEMå‘½åçš„ Search Bar æ¨¡å— --&gt; &lt;div class=\"search-bar\"&gt; &lt;input class=\"search-form__input\"/&gt; &lt;!-- / input è¾“å…¥æ¡†å­å…ƒç´  --&gt; &lt;button class=\"search-form__button\"&gt;&lt;/button&gt; &lt;!-- / button æœç´¢æŒ‰é’®å­å…ƒç´  --&gt; &lt;/div&gt; &lt;!-- E Search Bar æ¨¡å— --&gt; æœ‰å¯¹æ¯”é«˜ä¸‹ç«‹åˆ¤~ é€šå¸¸é¢è¯•é—®çš„è¯­ä¹‰åŒ–(ä½œç”¨ä¸å®è·µ)ï¼Œè¿™æ ·å°±è¾¾åˆ°äº†ï¼Œæœ€ç»ˆç›®çš„æ˜¯å‡å°‘ä»£ç é˜…è¯»æˆæœ¬ã€‚ ç¼ºé™· ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹ï¼Œå½“HTMLå…ƒç´ å±‚çº§ç¹å¤šæ—¶ï¼Œä¼šä½¿å¾—å‘½åè¶Šæ¥è¶Šé•¿ï¼Œé‚£æ ·çš„è¯ï¼Œæ–‡ä»¶ä¼šå˜å¾—è‡ƒè‚¿ä¸å ªï¼Œåè€Œè¿èƒŒäº†æˆ‘ä»¬çš„åˆå¿ƒã€‚ä¹±ä¸ƒå…«ç³Ÿçš„HTMLè°ä¼šæ„¿æ„çœ‹ï¼Ÿ å§“æ°å‘½åæ³•ä¸ºäº†è¿›ä¸€æ­¥ç®€åŒ– CSS çš„å‘½åï¼Œé‡‡ç”¨å‡¹å‡¸å®éªŒå®¤å›¢é˜Ÿæ¨å¹¿çš„å§“æ°å‘½åæ³•ã€‚ æ„Ÿè°¢å‡¹å‡¸å¤§å¤§ä»¬~ æˆ‘ä»¬å¹¶ä¸éœ€è¦æŠŠæ¯ä¸ªå…ƒç´ çš„å…¨éƒ¨åç§°å¸¦ä¸Šæ¥è¡¨æ˜ä¸»æ¬¡å…³ç³»ã€‚å°±åƒè¿™ä»½æ—è°±ä¸€æ ·ï¼Œä»–çš„å­©å­åªéœ€è¦ä¿ç•™ã€Œè´¾ã€å§“å°±å¯ä»¥äº†ï¼Œåå­—æ˜¯å¯ä»¥éšä¾¿å–çš„ã€‚ å…³è”ä¸Š BEM å‘½åæ–¹æ³•ï¼Œå§“æ°å‘½åæ³•ä¸­çš„ Block å°±æ˜¯ã€Œå§“ã€ï¼ŒElement å°±æ˜¯ã€Œåå­—ã€ï¼Œè€Œ Modifier å°±è¡¨ç¤ºè¿™ä¸ªäººçš„æŸç§çŠ¶æ€ï¼Œä¾‹å¦‚ï¼šã€ŒèŒƒ - - å†°å†° - - å¾ˆç¾ã€ã€‚è¿™æ ·å°±è¾¾åˆ°äº†å–å…¶ç²¾åï¼Œå»å…¶ç³Ÿç²•çš„ä½œç”¨ã€‚ 1234567891011&lt;!-- am = app_market --&gt; &lt;div class=\"am_answer\"&gt; &lt;div class=\"am_secheader\"&gt;&lt;/div&gt; &lt;div class=\"am_answer_list\"&gt; &lt;div class=\"am_answer_item\"&gt; &lt;div class=\"am_answer_itop\"&gt;&lt;/div&gt; &lt;div class=\"am_answer_imid\"&gt;&lt;/div&gt; &lt;a href=\"javascript:;\" class=\"am_answer_ibtn\"&gt;å»å›´è§‚&lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; å°† app_market å¯ä»¥çœ‹æˆæ˜¯ã€Œå¤å§“ã€ï¼Œå°†ä¸¤ä¸ªå•è¯çš„é¦–å­—æ¯ç»“åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªæ–°çš„ã€Œå•å§“ã€ï¼Œå¦‚ am ï¼›å°†itemä¸­çš„å­é¡¹ç±»åç›´æ¥ç®€å†™ä¸ºã€Œixxã€ï¼Œå¦‚ï¼šitopã€‚è¿½æ±‚ä¾¿åˆ©çš„å‰¯ä½œç”¨ä¹‹ä¸€æ˜¯ç‰ºç‰²äº†ä¸€ç‚¹ä»£ç çš„å¯è¯»æ€§ã€‚ä½†å¤šåŠé¡¹ç›®ä¸Šçš„æ–‡æ¡£å¯ä»¥æ³¨æ˜å‘½åæ–¹æ³•å’Œå…¶ä»–ä¹¦å†™è§„èŒƒï¼Œå¦‚æœå›¢é˜Ÿæœ‰çº¦æŸï¼Œé‚£ä¸€å®šæ˜¯æä½³çš„å®è·µã€‚ å°ç»“ ClassName çš„å‘½ååº”è¯¥å°½é‡ç²¾çŸ­ã€æ˜ç¡®ï¼Œä»¥è‹±æ–‡å•è¯å‘½åï¼Œä¸”å…¨éƒ¨å­—æ¯ä¸ºå°å†™ï¼Œé¿å…æ„ä¹‰ä¸æ˜çš„ç¼©å†™ å•è¯ä¹‹é—´ç»Ÿä¸€ä½¿ç”¨ä¸‹åˆ’çº¿ _ æˆ– - è¿æ¥ å®šä¹‰æ ·å¼æ¨¡å—ï¼Œæé«˜ä»£ç çš„å¯å¤ç”¨æ€§ CSSæ¨èä¹¦å†™ æ¨èä¹¦å†™é¡ºåº ä½ç½®å±æ€§(position, top, right, z-index, display, floatç­‰) å¤§å°(width, height, padding, margin) æ–‡å­—ç³»åˆ—(font, line-height, letter-spacing, color- text-alignç­‰) èƒŒæ™¯(background, borderç­‰) å…¶ä»–(animation, transitionç­‰) why this ? ä¸»è¦ä»æµè§ˆå™¨çš„æ¸²æŸ“æœºåˆ¶æ–¹é¢æ¥è€ƒè™‘ï¼Œå‡å°‘é‡ç»˜ä¸é‡æ’,æé«˜æ€§èƒ½ã€‚ è‰¯å¥½çš„ä¹ æƒ¯ä¼šä½¿å¾—ä½ ç¼–å†™cssä»£ç æ—¶ä¹Ÿæ›´åŠ æ¸…æ™° æ‹¿åˆ°æ–‡ä»¶åæµè§ˆå™¨çš„æ¸²æŸ“æµç¨‹ä¸ºï¼š ï¼ˆ1ï¼‰æµè§ˆå™¨è§£æhtmlæ„å»ºdomæ ‘ï¼Œè§£æcssæ„å»ºcssomæ ‘å³css rule treeï¼šå°†htmlå’Œcsséƒ½è§£ææˆæ ‘å½¢çš„æ•°æ®ç»“æ„ï¼› domæ ‘çš„æ„å»ºè¿‡ç¨‹æ˜¯ä¸€ä¸ªæ·±åº¦éå†è¿‡ç¨‹ï¼šå½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹éƒ½æ„å»ºå¥½åæ‰ä¼šå»æ„å»ºå½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ã€‚ ï¼ˆ2ï¼‰æ„å»ºrenderæ ‘ï¼šDOMæ ‘å’Œcssomæ ‘åˆå¹¶ä¹‹åå½¢æˆrenderæ ‘ã€‚ä¸ºäº†æ„å»ºæ¸²æŸ“æ ‘ï¼Œæµè§ˆå™¨å¤§ä½“å®Œæˆäº†ä¸‹åˆ—å·¥ä½œï¼šä»DOMæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹éå†æ¯ä¸ªå¯è§èŠ‚ç‚¹ã€‚å¯¹äºæ¯ä¸ªå¯è§èŠ‚ç‚¹ï¼Œä¸ºå…¶æ‰¾åˆ°é€‚é…çš„CSSOMè§„åˆ™å¹¶åº”ç”¨å®ƒä»¬ã€‚å‘å°„å¯è§èŠ‚ç‚¹ï¼Œè¿åŒå…¶å†…å®¹å’Œè®¡ç®—çš„æ ·å¼ã€‚æ¸²æŸ“æ ‘ä¸­åŒ…å«äº†å±å¹•ä¸Šæ‰€æœ‰å¯è§å†…å®¹åŠå…¶æ ·å¼ä¿¡æ¯ã€‚ ï¼ˆ3ï¼‰å¸ƒå±€renderæ ‘ï¼šæœ‰äº†renderæ ‘ï¼Œæµè§ˆå™¨å·²ç»çŸ¥é“ç½‘é¡µä¸­æœ‰å“ªäº›èŠ‚ç‚¹ï¼Œå„ä¸ªèŠ‚ç‚¹çš„csså®šä¹‰ä»¥åŠå®ƒä»¬çš„ä»å±å…³ç³»ï¼Œæ¥ç€å°±å¼€å§‹å¸ƒå±€ï¼Œè®¡ç®—å‡ºæ¯ä¸ªèŠ‚ç‚¹åœ¨å±å¹•ä¸­çš„ä½ç½®å’Œå¤§å°ã€‚(htmlé‡‡ç”¨äº†ä¸€ç§æµå¼å¸ƒå±€çš„å¸ƒå±€æ¨¡å‹ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³é¡ºåºå¸ƒå±€ï¼Œå¸ƒå±€çš„èµ·ç‚¹æ˜¯ä»renderæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹çš„ï¼Œå¯¹åº”domæ ‘çš„documentèŠ‚ç‚¹ï¼Œå…¶åˆå§‹ä½ç½®ä¸º(0,0)ï¼Œè¯¦ç»†çš„å¸ƒå±€è¿‡ç¨‹ä¸ºï¼šæ¯ä¸ªrendererçš„å®½åº¦ç”±çˆ¶èŠ‚ç‚¹çš„rendererç¡®å®šã€‚çˆ¶èŠ‚ç‚¹éå†å­èŠ‚ç‚¹ï¼Œç¡®å®šå­èŠ‚ç‚¹çš„ä½ç½®(x,y)ï¼Œè°ƒç”¨å­èŠ‚ç‚¹çš„layoutæ–¹æ³•ç¡®å®šå…¶é«˜åº¦ï¼Œçˆ¶èŠ‚ç‚¹æ ¹æ®å­èŠ‚ç‚¹çš„height, margin, paddingç¡®å®šè‡ªèº«çš„é«˜åº¦)ã€‚ ï¼ˆ4ï¼‰æ¸²æŸ“renderæ ‘ï¼šæµè§ˆå™¨å·²ç»çŸ¥é“å•¦å“ªäº›èŠ‚ç‚¹è¦æ˜¾ç¤ºï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„csså±æ€§æ˜¯ä»€ä¹ˆï¼Œæ¯ä¸ªèŠ‚ç‚¹åœ¨å±å¹•ä¸­çš„ä½ç½®æ˜¯å“ªé‡Œã€‚å°±è¿›å…¥å•¦æœ€åä¸€æ­¥ï¼ŒæŒ‰ç…§è®¡ç®—å‡ºæ¥çš„è§„åˆ™ï¼Œé€šè¿‡æ˜¾å¡æŠŠå†…å®¹ç”»åœ¨å±å¹•ä¸Šã€‚ DOM çš„å˜åŒ–å½±å“äº†å…ƒç´ çš„å‡ ä½•å±æ€§ï¼ˆå®½å’Œé«˜ï¼‰- æ¯”å¦‚æ”¹å˜è¾¹æ¡†å®½åº¦æˆ–ç»™æ®µè½å¢åŠ æ–‡å­—ï¼Œå¯¼è‡´è¡Œæ•°å¢åŠ  â€“ æµè§ˆå™¨éœ€è¦é‡æ–°è®¡ç®—å…ƒç´ çš„å‡ ä½•å±æ€§ï¼ŒåŒæ ·å…¶ä»–å…ƒç´ çš„å‡ ä½•å±æ€§å’Œä½ç½®ä¹Ÿä¼šå› æ­¤å—åˆ°å½±å“ã€‚æµè§ˆå™¨ä¼šä½¿æ¸²æŸ“æ ‘ä¸­å—åˆ°å½±å“çš„éƒ¨åˆ†å¤±æ•ˆï¼Œå¹¶é‡æ–°æ„å»ºæ¸²æŸ“æ ‘ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º â€œé‡æ’ï¼ˆreflowï¼‰â€ã€‚å®Œæˆé‡æ’åï¼Œæµè§ˆå™¨ä¼šé‡æ–°ç»˜åˆ¶å—å½±å“çš„éƒ¨åˆ†åˆ°å±å¹•ä¸­ï¼Œè¯¥è¿‡ç¨‹ç§°ä¸º â€œé‡ç»˜ï¼ˆrepaintï¼‰â€ å¥½äº†å¥½äº†ï¼Œç…§æœ¬å®£ç§‘çš„ä¸œè¥¿ç»ˆäºæ²¡äº†ï¼Œå½“ç„¶æ¸²æŸ“è¿‡ç¨‹æ²¡è¿™ä¹ˆç®€å•ï¼Œè¿™é‡Œä¹Ÿæ˜¯å€Ÿé‰´ä¸€ä¸‹å•¦ã€‚ 1234width: 100px; height: 100px; background-color: red; position: absolute; å½“æµè§ˆå™¨è§£æåˆ°positionçš„æ—¶å€™çªç„¶å‘ç°è¯¥å…ƒç´ æ˜¯ç»å¯¹å®šä½å…ƒç´ éœ€è¦è„±ç¦»æ–‡æ¡£æµï¼Œè€Œä¹‹å‰å´æ˜¯æŒ‰ç…§æ™®é€šå…ƒç´ è¿›è¡Œè§£æçš„ï¼Œæ‰€ä»¥ä¸å¾—ä¸é‡æ–°æ¸²æŸ“ï¼Œè§£é™¤è¯¥å…ƒç´ åœ¨æ–‡æ¡£ä¸­æ‰€å ä½ç½®ï¼Œç„¶è€Œç”±äºè¯¥å…ƒç´ çš„å ä½å‘ç”Ÿå˜åŒ–ï¼Œå…¶ä»–å…ƒç´ ä¹Ÿå¯èƒ½ä¼šå—åˆ°å›æµçš„å½±å“è€Œé‡æ–°æ’ä½ï¼Œæœ€ç»ˆå¯¼è‡´ï¼ˆ3ï¼‰æ­¥éª¤èŠ±è´¹æ—¶é—´å¤ªä¹…è€Œå½±å“ ã€‚ CSSä¾¿æ·è°ƒè¯•æ³• æ§åˆ¶å°è¾“å…¥ç¥ç§˜ä»£ç  12345678// 1javascript: var _q = !_q;document.querySelectorAll('*').forEach(q =&gt; q.style.outline = _q ? '1px solid red' : '')// 2$$('*').forEach(a=&gt;&#123;a.style.outline='1px solid red'&#125;)// 3xxxxxxxxx æ’ä»¶ï¼š Keylines ( ä¸€é”®+å½©è‰²çº¿æ¡ ) ä¼˜é›…çš„xss æ‰“å¼€ä¹¦ç­¾ç®¡ç†é¡µ å³ä¸Šè§’ä¸‰ä¸ªç‚¹ã€Œæ·»åŠ æ–°ä¹¦ç­¾ã€ åç§°éšæ„ï¼Œç²˜è´´ä»¥ä¸‹ä»£ç åˆ°ç½‘å€ä¸­ 1234567891011121314151617javascript: (function() &#123; var elements = document.body.getElementsByTagName('*'); var items = []; for (var i = 0; i &lt; elements.length; i++) &#123; if (elements[i].innerHTML.indexOf('html * &#123; outline: 1px solid red &#125;') != -1) &#123; items.push(elements[i]); &#125; &#125; if (items.length &gt; 0) &#123; for (var i = 0; i &lt; items.length; i++) &#123; items[i].innerHTML = ''; &#125; &#125; else &#123; document.body.innerHTML += '&lt;style&gt;html * &#123; outline: 1px solid red &#125;&lt;/style&gt;'; &#125;&#125;)(); ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»æ„ç½‘ç«™ä¸Šç‚¹å‡»åˆšæ‰åˆ›å»ºçš„ä¹¦ç­¾ï¼Œå†…éƒ¨ä¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨è°ƒè¯•çš„ styleã€‚å­˜åœ¨çš„è¯å°±åˆ é™¤ï¼Œä¸å­˜åœ¨çš„è¯å°±æ·»åŠ ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æˆ‘ä»¬å°±èƒ½å¾ˆæ–¹ä¾¿çš„é€šè¿‡è¿™ä¸ªæŠ€å·§æŸ¥çœ‹ä»»æ„ç½‘é¡µçš„å¸ƒå±€äº†ã€‚ æ•ˆæœå¦‚ä¸‹ï¼š referenceï¼š æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹ä¸æ€§èƒ½ä¼˜åŒ–ï¼š https://juejin.im/post/59d489156fb9a00a571d6509 ï¼Œ CSSä¹¦å†™é¡ºåº ï¼šhttps://www.cnblogs.com/xuepei/p/8961809.html ï¼Œ autoå®éªŒå®¤ https://aotu.io/","categories":[],"tags":[{"name":"css","slug":"css","permalink":"https://tsunamigg.github.io/tags/css/"}]},{"title":"é—­åŒ…è¯¦è§£","slug":"closure","date":"2019-02-12T02:10:01.000Z","updated":"2020-05-28T14:28:00.239Z","comments":true,"path":"2019/02/12/closure/","link":"","permalink":"https://tsunamigg.github.io/2019/02/12/closure/","excerpt":"ç»“åˆã€Šä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)ã€‹ä¸€ä¹¦ï¼Œè¯¦è§£é—­åŒ…ï¼Œç†æ¸…å…³äºé—­åŒ…çš„ä¸‰ä¸ªé—®é¢˜ï¼Œå½»åº•è®¤è¯†é—­åŒ…ã€‚","text":"ç»“åˆã€Šä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)ã€‹ä¸€ä¹¦ï¼Œè¯¦è§£é—­åŒ…ï¼Œç†æ¸…å…³äºé—­åŒ…çš„ä¸‰ä¸ªé—®é¢˜ï¼Œå½»åº•è®¤è¯†é—­åŒ…ã€‚ é—­åŒ…è¯¦è§£1. ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ é—­åŒ…çš„å®šä¹‰ï¼šå½“å‡½æ•°å¯ä»¥è®°ä½å¹¶è®¿é—®æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸæ—¶ï¼Œå°±äº§ç”Ÿäº†é—­åŒ…ï¼Œå³ä½¿å‡½æ•°æ˜¯åœ¨å½“å‰è¯æ³•ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œã€‚ 12345678910function foo() &#123; var a = 3; function bar() &#123; console.log(a); &#125; return bar;&#125;var baz = foo();baz();-----&gt; '3' è¿™æ˜¯ä¸€æ®µéå¸¸ç»å…¸çš„é—­åŒ…ä»£ç ï¼Œæ ¹æ®ç½‘ä¸Šçš„è¯´æ³•ï¼Œé—­åŒ…çš„äº§ç”Ÿæœ‰ä¸‰ä¸ªæ¡ä»¶ï¼š1. Aå‡½æ•°å†…è¿”å›Bå‡½æ•°ã€‚2.Bå‡½æ•°è°ƒç”¨äº†Aå‡½æ•°çš„å˜é‡ã€‚3.B()ã€‚ å¾ˆç¥å¥‡æœ‰æ²¡æœ‰ï¼Ÿ æˆ‘ä»¬åœ¨å¤–éƒ¨ç¯å¢ƒè®¿é—®äº†å†…éƒ¨ç¯å¢ƒçš„å˜é‡ã€‚å¹¶ä¸”æ­£å¸¸æ‰§è¡Œäº†fooçš„ä½œç”¨åŸŸä¼šè¢«é”€æ¯æ‰ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶ä¹Ÿä¼šä½¿çš„é‡Šæ”¾æ‰å†…å­˜ç©ºé—´ã€‚æ˜¾ç„¶é—­åŒ…é˜»æ­¢äº†è¿™ä»¶äº‹æƒ…çš„å‘ç”Ÿã€‚ 2.é—­åŒ…äº§ç”Ÿçš„æ¡ä»¶ï¼Ÿç”±äºbarå£°æ˜çš„ä½ç½®ï¼Œä½¿å…¶æ‹¥æœ‰æ¶µç›–äº†fooçš„å†…éƒ¨ä½œç”¨åŸŸï¼Œå½“barè¢«è°ƒç”¨åï¼Œä¼šä¿æŒå¯¹fooä½œç”¨åŸŸçš„å¼•ç”¨ï¼Œè®¿é—®aå˜é‡ã€‚ä¿æŒå¯¹å¤–éƒ¨ä½œç”¨åŸŸçš„å¼•ç”¨ï¼Œå°±ä¼šäº§ç”Ÿé—­åŒ…ï¼Œè€Œä¸æ˜¯éè¦è¿”å›å‡½æ•°ã€‚ 123456function waiting(msg) &#123; setTimeout(function () &#123; console.log(msg) &#125;, 1000)&#125;waiting('js') æ— è®ºæ˜¯ä»€ä¹ˆå…¶ä»–çš„éªšæ“ä½œï¼Œåªè¦ä½ å°†å†…éƒ¨å‡½æ•°ä¼ é€’åˆ°æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸä¹‹å¤–ï¼Œä»–éƒ½ä¼šä¿æŒå¯¹å†…éƒ¨ä½œç”¨åŸŸçš„å¼•ç”¨ï¼Œæ— è®ºåœ¨å“ªé‡Œæ‰§è¡Œå†…éƒ¨å‡½æ•°ï¼Œéƒ½ä¼šåˆ›å»ºé—­åŒ…ã€‚è¿™ä¸ªä¾‹å­ä¸­setTimeoutä¿æŒå¯¹waitingçš„å¼•ç”¨ï¼Œåœ¨æ‰§è¡Œæ—¶ä¹Ÿä¼šåˆ›å»ºé—­åŒ…ã€‚ 3. é—­åŒ…çš„ç”¨é€”ï¼Ÿæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿé‡ç”¨ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”å…¶è¢«ä¿æŠ¤èµ·æ¥ä¸è¢«æ±¡æŸ“ç¯¡æ”¹ï¼Œå°±å¯ä»¥ä½¿ç”¨é—­åŒ…ã€‚è¿™ç§å˜é‡ä¸€èˆ¬è¢«ç§°ä¸ºç§æœ‰å˜é‡æˆ–è€…å±€éƒ¨å˜é‡ã€‚ 123456//ä¸€ä¸ªå¾ˆç»å…¸çš„é¢˜for(var i = 1; i &lt;= 5; i++) &#123; setTimeout(function () &#123; console.log(i) &#125;, i* 1000)&#125; å—¯ï¼Œæˆ‘ç›¸ä¿¡å¤§å¤šæ•°æœé›†èµ„æ–™å­¦ä¹ çš„äººï¼Œéƒ½ä¼šæ¸…æ¥šç­”æ¡ˆã€‚ è‡³äºä¸ºä»€ä¹ˆï¼Œå€¼å¾—å†å¤ä¹ ä¸€ä¸‹ã€‚ æ¯æ¬¡å¾ªç¯ï¼Œæˆ‘ä»¬éƒ½ä¼šæŒ‘å‡ºä¸€ä»½iç”¨æ¥è¾“å‡ºï¼Œä½†å› ä¸ºsetTimeoutä¼šåœ¨å¾ªç¯å®Œæˆåæ‰§è¡Œï¼Œæ¯æ¬¡çš„iéƒ½åœ¨åŒä¸€å…¨å±€ä½œç”¨åŸŸä¸‹ï¼Œäºæ˜¯åæ¥å±…ä¸Šï¼Œè¦†ç›–äº†å‰é¢çš„iï¼Œå†ç”±setTimeoutæ‰§è¡Œæ—¶ï¼Œå°±å…¨æ˜¯6äº†ã€‚ æ€ä¹ˆä½¿å¾—æ¯æ¬¡å¾ªç¯è¾“å‡ºæ­£ç¡®å‘¢ï¼Ÿ æˆ‘ä»¬åªéœ€è¦å°†æ¯æ¬¡çš„iå˜æˆä¸€ä¸ªç§æœ‰å˜é‡ï¼Œæœ‰ç‹¬ç«‹çš„ä½œç”¨åŸŸï¼Œè®©å…¶ä¸åœ¨ç¯¡æ”¹å°±OKäº†ã€‚ ä½¿ç”¨IIFE è¿™é‡Œå¼•å…¥æ¥è‡ªMDNçš„é‡Šä¹‰ã€‚ IIFEï¼ˆ ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼‰æ˜¯ä¸€ä¸ªåœ¨å®šä¹‰æ—¶å°±ä¼šç«‹å³æ‰§è¡Œçš„ JavaScript å‡½æ•°ã€‚ 123(function () &#123; statements&#125;)(); è¿™æ˜¯ä¸€ä¸ªè¢«ç§°ä¸º è‡ªæ‰§è¡ŒåŒ¿åå‡½æ•° çš„è®¾è®¡æ¨¡å¼ï¼Œä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†ã€‚ç¬¬ä¸€éƒ¨åˆ†æ˜¯åŒ…å›´åœ¨ åœ†æ‹¬å·è¿ç®—ç¬¦ () é‡Œçš„ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œè¿™ä¸ªåŒ¿åå‡½æ•°æ‹¥æœ‰ç‹¬ç«‹çš„è¯æ³•ä½œç”¨åŸŸã€‚è¿™ä¸ä»…é¿å…äº†å¤–ç•Œè®¿é—®æ­¤ IIFE ä¸­çš„å˜é‡ï¼Œè€Œä¸”åˆä¸ä¼šæ±¡æŸ“å…¨å±€ä½œç”¨åŸŸã€‚ ç¬¬äºŒéƒ¨åˆ†å†ä¸€æ¬¡ä½¿ç”¨ () åˆ›å»ºäº†ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼ŒJavaScript å¼•æ“åˆ°æ­¤å°†ç›´æ¥æ‰§è¡Œå‡½æ•°ã€‚ 12345678// IIFEæ–¹æ³•for(var i = 1; i &lt;= 5; i++) &#123; (function (j) &#123; setTimeout(function () &#123; console.log(j) &#125;, j* 1000) &#125;)(i);&#125; è¿™é‡Œåˆ©ç”¨IIFEæ‹¥æœ‰ç‹¬ç«‹çš„æ­¤æ³•ä½œç”¨åŸŸçš„ç‰¹æ€§ï¼Œå°†å˜é‡ç§æœ‰åŒ–ï¼Œè¿™æ ·åœ¨setTimeoutæ‰§è¡Œæ—¶å°±ä¼šå¾—åˆ°æ­£ç¡®è¾“å‡ºã€‚æ²¡é”™ï¼Œå¥½åƒå°±æ˜¯åˆ©ç”¨é—­åŒ…å°†æ¯æ¬¡çš„å˜é‡ç¼“å­˜èµ·æ¥ï¼Œæ”¾åœ¨ç‹¬ç«‹çš„å†…å­˜ä¸­ã€‚ ä½¿ç”¨ES6çš„let 123456// letæ–¹æ³•for(let i = 1; i &lt;= 5; i++) &#123; setTimeout(function () &#123; console.log(i) &#125;, i* 1000)&#125; letä¼šåŠ«æŒå—ä½œç”¨åŸŸï¼Œâ€œåŠ«æŒâ€å°±æ˜¯æŠŠå½“å‰å—ä½œç”¨åŸŸæŠ¢è¿‡æ¥å˜ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ï¼Œå¦‚æœè¿˜ä¸æ˜ç™½ï¼Œè¯·çœ‹ä¸‹é¢ä»£ç ã€‚ 123456for(var i = 1; i &lt;= 5; i++) &#123; let j = i; setTimeout(function () &#123; console.log(j) &#125;, j* 1000)&#125; let é‡è§{}å‘ç”Ÿäº†å¥‡å¦™çš„é‚‚é€…ï¼Œäºæ˜¯ä»–ä»¬â€œç§å¥”â€äº†~ åœ¨æ¯æ¬¡å¾ªç¯ä¸­éƒ½è¢«å£°æ˜äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥æ¯æ¬¡å¾ªç¯ä¸­çš„{}å†…çš„å˜é‡éƒ½ä¸å¹²æ‰°ã€‚setTimeoutå¾ˆé«˜å…´çš„æ‰§è¡Œäº†ã€‚ æ‘‡æ™ƒä¸€ä¸‹ä½ çš„å°è„‘ç“œï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å°†è¿™äº›é€šè¿‡é—­åŒ…äº§ç”Ÿçš„ç§æœ‰å˜é‡èµ‹å€¼ç»™ä¸€ä¸ªå‡½æ•°ï¼Œä½ ä¼šè”æƒ³åˆ°ä»€ä¹ˆï¼Ÿ 1234567891011121314151617var foo = ï¼ˆfunction myModule() &#123; var myPublic = 'webå·¥ç¨‹å¸ˆçš„è‡ªæˆ‘ä¿®å…»'ï¼› var mywx = ['tangtang1996918']; function joinMyPublic() &#123; console.log('join webå·¥ç¨‹å¸ˆçš„è‡ªæˆ‘ä¿®å…»') &#125; function pushMywx() &#123; console.log(mywx.push('your')) &#125; return &#123; joinMyPublic: joinMyPublic, pushMywx: pushMywx &#125;&#125;ï¼‰ï¼ˆï¼‰ï¼›foo.joinMyPublic();foo.pushMywx(); æ˜¯ä¸æ˜¯åœ¨é¡¹ç›®ä¸­å¾ˆå¸¸è§ï¼Ÿ æˆ‘é ï¼Œè¿™å°±æ˜¯æ¨¡å—æœºåˆ¶å•Šï¼Œå…„å¼Ÿï¼ï¼ï¼æŠŠä¸€äº›ç»å¦™çš„æ–¹æ³•éƒ½åŠ«æŒè¿‡æ¥æ”¾åœ¨è‡ªå·±çš„å°ç©ºé—´é‡Œé¢ï¼Œæƒ³æ‹¿æ¥ç”¨å°±æ‹¿æ¥ç”¨ï¼Œå²‚ä¸ç¾å“‰ï¼Ÿï¼Ÿï¼Ÿå½“ç„¶ï¼Œç°ä»£çš„æ¨¡å—æœºåˆ¶è‚¯å®šæ²¡è¿™ä¹ˆç®€å•ï¼Œå˜»å˜»ã€‚ 4. å¼ºå¤§çš„é—­åŒ…è®¤è¯†äº†é—­åŒ…ï¼Œå¥½å¥½æƒ³æƒ³è¿‡å»ä¸€å¤©ä¸­ä½ æ‰€å†™çš„ä»£ç ï¼Œé‡Œé¢æœ‰é—­åŒ…å—ï¼Ÿè¿™æ˜¯ä¸€ç§æ—¥å¸¸ä¸”å¼ºå¤§çš„æ¨¡å¼ã€‚ åŒ…ç®¡ç†å™¨æˆ–è€…ç®¡ç†æ¨¡å—æœºåˆ¶éƒ½ä¼šå°†æ¨¡å—å®šä¹‰å’Œæ¨¡å—å¼•å…¥è¿›è¡Œå°è£…ã€‚å°è£…åˆ°ç°åœ¨ï¼Œå·²ç»å˜æˆäº†importå’Œexportæˆ–è€…å…¶ä»–çš„è¯­æ³•ç³–ã€‚","categories":[],"tags":[{"name":"javascript-native","slug":"javascript-native","permalink":"https://tsunamigg.github.io/tags/javascript-native/"}]}],"categories":[],"tags":[{"name":"browser","slug":"browser","permalink":"https://tsunamigg.github.io/tags/browser/"},{"name":"diary","slug":"diary","permalink":"https://tsunamigg.github.io/tags/diary/"},{"name":"Vue-2.6X-source-learn notes","slug":"Vue-2-6X-source-learn-notes","permalink":"https://tsunamigg.github.io/tags/Vue-2-6X-source-learn-notes/"},{"name":"fabric canvas notes","slug":"fabric-canvas-notes","permalink":"https://tsunamigg.github.io/tags/fabric-canvas-notes/"},{"name":"javascript-native","slug":"javascript-native","permalink":"https://tsunamigg.github.io/tags/javascript-native/"},{"name":"http","slug":"http","permalink":"https://tsunamigg.github.io/tags/http/"},{"name":"http URI/URL","slug":"http-URI-URL","permalink":"https://tsunamigg.github.io/tags/http-URI-URL/"},{"name":"ESmodule","slug":"ESmodule","permalink":"https://tsunamigg.github.io/tags/ESmodule/"},{"name":"javascript event loop","slug":"javascript-event-loop","permalink":"https://tsunamigg.github.io/tags/javascript-event-loop/"},{"name":"css","slug":"css","permalink":"https://tsunamigg.github.io/tags/css/"}]}